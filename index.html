
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fortnite Cartas - Ultimate Tournament</title>
    
    <!-- CDNs -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <!-- Import Map para Gemini API -->
    <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "react": "https://esm.sh/react@^19.2.3"
  }
}
</script>

    <style>
        body {
            background-color: #020202;
            color: white;
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }
        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0a0a0a; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }

        /* Animaciones de Batalla */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px) rotate(-2deg); }
            75% { transform: translateX(8px) rotate(2deg); }
        }
        .animate-shake { animation: shake 0.2s ease-in-out 2; }

        @keyframes jump-up {
            0% { transform: translateY(0); }
            50% { transform: translateY(-40px) scale(1.1); }
            100% { transform: translateY(0); }
        }
        .animate-attack-player { animation: jump-up 0.4s cubic-bezier(.36,.07,.19,.97); }

        @keyframes jump-down {
            0% { transform: translateY(0); }
            50% { transform: translateY(40px) scale(1.1); }
            100% { transform: translateY(0); }
        }
        .animate-attack-enemy { animation: jump-down 0.4s cubic-bezier(.36,.07,.19,.97); }

        @keyframes float-dmg {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-60px) scale(1.5); }
        }
        .damage-popup {
            position: absolute;
            pointer-events: none;
            font-weight: 900;
            z-index: 100;
            animation: float-dmg 0.8s forwards;
            text-shadow: 2px 2px 0 black;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useRef } = React;
        import { GoogleGenAI } from "@google/genai";

        // --- CONSTANTES Y CONFIGURACI√ìN ---
        const firebaseConfig = {
            apiKey: "AIzaSyAgYrcmcSzz2umxAUp5UqCL3pgNKKR08lU",
            authDomain: "juego-de-cartas-f7284.firebaseapp.com",
            databaseURL: "https://juego-de-cartas-f7284-default-rtdb.firebaseio.com",
            projectId: "juego-de-cartas-f7284"
        };

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const RARITY_STYLES = {
            common: 'border-slate-400 shadow-[0_0_5px_rgba(148,163,184,0.3)]',
            rare: 'border-green-500 shadow-[0_0_5px_rgba(34,197,94,0.3)]',
            epic: 'border-purple-500 shadow-[0_0_8px_rgba(168,85,247,0.4)]',
            legendary: 'border-orange-500 shadow-[0_0_10px_rgba(249,115,22,0.5)]',
            idolos: 'border-pink-500 shadow-[0_0_12px_rgba(236,72,153,0.6)]',
            animated: 'border-amber-400 shadow-[0_0_15px_rgba(251,191,36,0.7)]',
            actricesporno: 'border-red-600 shadow-[0_0_20px_rgba(220,38,38,0.8)]',
            tournament: 'border-cyan-400 shadow-[0_0_15px_rgba(6,182,212,0.7)]',
        };

        const CARDS = [
            { id: 0, name: "Ram√≠rez", rarity: "common", baseAtk: 60, baseDef: 50, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", shopPrice: 50, price: 50 },
            { id: 1, name: "Fortaleza", rarity: "rare", baseAtk: 60, baseDef: 70, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", shopPrice: 100, price: 100 },
            { id: 2, name: "Escudera", rarity: "common", baseAtk: 55, baseDef: 65, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", shopPrice: 50, price: 50 },
            { id: 3, name: "Azulita", rarity: "rare", baseAtk: 70, baseDef: 55, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", shopPrice: 80, price: 80 },
            { id: 4, name: "Tormenta", rarity: "epic", baseAtk: 80, baseDef: 45, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", shopPrice: 120, price: 120 },
            { id: 5, name: "Furia", rarity: "legendary", baseAtk: 90, baseDef: 40, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", shopPrice: 200, price: 200 },
            { id: 6, name: "Asesina", rarity: "legendary", baseAtk: 95, baseDef: 30, level: 1, img: "https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", shopPrice: 250, price: 250 },
            { id: 7, name: "Francine Smith", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://wimg.rule34.xxx/images/1888/0334e8239c387a302348c01810815aef.jpeg?15738062", shopPrice: 1000, price: 1000 },
            { id: 11, name: "Campe√≥n Sombra", rarity: "tournament", baseAtk: 140, baseDef: 100, level: 1, img: "https://s100.erome.com/2418/B2TgruwR/61zc8Veb.png?v=1712563892", shopPrice: null, price: 0 },
            { id: 12, name: "Maestro del Fuego", rarity: "tournament", baseAtk: 150, baseDef: 90, level: 1, img: "https://s326.erome.com/5139/YBnb1NTO/pN2evqNZ.jpeg?v=1750357395", shopPrice: null, price: 0 },
            { id: 13, name: "Rey del Hielo", rarity: "tournament", baseAtk: 135, baseDef: 110, level: 1, img: "https://s10.erome.com/6694/EUAdAxk1/1zdVPLQh.jpeg?v=1764732026", shopPrice: null, price: 0 },
            { id: 14, name: "Felina", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx/samples/2288/sample_ce3c07d28a9fdd2475d6fc67df8ff4e4.jpg?15302020", shopPrice: 300, price: 300 },
            { id: 21, name: "Sabrina Carpente La Diva", rarity: "idolos", baseAtk: 120, baseDef: 80, level: 1, img: "https://i.pinimg.com/736x/4d/c9/b3/4dc9b3acdf2ab04c3c783d3fb2730a0c.jpg", shopPrice: 2000, price: 2000 },
            { id: 34, name: "LolaLolita", rarity: "idolos", baseAtk: 140, baseDef: 90, level: 1, img: "https://s204.erome.com/2280/sMLLJHdM/kYJtDcuQ.jpeg?v=1709700685", shopPrice: 2500, price: 2500 },
            { id: 46, name: "Dexter's Mom Beach", rarity: "animated", baseAtk: 1200, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116308/dm-scaled.webp", shopPrice: 2500, price: 2500 },
            { id: 50, name: "Busting Out", rarity: "animated", baseAtk: 5000, baseDef: 2500, level: 1, img: "https://cdn2.hentaigifz.com/115480/busting-the-fuck-out-scaled.webp", shopPrice: 5000, price: 5000 },
            { id: 61, name: "Samantha Bounce", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113850/gif-samantha-1-scaled.webp", shopPrice: 4000, price: 4000 },
            { id: 101, name: "Milf Handjob Wet", rarity: "actricesporno", baseAtk: 12000, baseDef: 6000, level: 1, img: "https://s2.pictoa.com/media/galleries/269/410/269410603155505d89c/393371260315552a7156.gif", shopPrice: 7000, price: 7000 }
        ];

        const TOURNAMENT_ENEMIES = [
            { phase: 1, name: "Novato Timmy", atk: 40, hp: 100, reward: 100, avatar: "https://cdn-icons-png.flaticon.com/512/1077/1077114.png" },
            { phase: 2, name: "Soldado Dave", atk: 55, hp: 130, reward: 200, avatar: "https://cdn-icons-png.flaticon.com/512/1077/1077114.png" },
            { phase: 3, name: "Comandante Tom", atk: 80, hp: 200, reward: 400, avatar: "https://cdn-icons-png.flaticon.com/512/1077/1077114.png" },
            { phase: 4, name: "CAMPE√ìN SHADOW", atk: 120, hp: 300, reward: 2000, avatar: "https://cdn-icons-png.flaticon.com/512/1077/1077114.png" }
        ];

        const PHASES = { 0: "Inicio", 1: "Octavos", 2: "Cuartos", 3: "Semifinal", 4: "Final" };

        // --- COMPONENTE CARDITEM ---
        const CardItem = ({ card, onClick, actionLabel, actionClass, disabled }) => (
            <div className={`relative flex flex-col bg-zinc-900/80 border-2 rounded-xl p-1.5 transition-all active:scale-95 ${RARITY_STYLES[card.rarity]} ${disabled ? 'opacity-50 grayscale' : ''}`}>
                <div className="relative aspect-[3/4] overflow-hidden rounded-lg mb-2 bg-black">
                    <img src={card.img} alt={card.name} className="w-full h-full object-cover" loading="lazy" />
                    <div className={`absolute top-1 right-1 px-1 py-0.5 rounded text-[7px] uppercase font-black text-white ${card.rarity === 'common' ? 'bg-zinc-500' : 'bg-black/60 shadow-lg'}`}>
                        {card.rarity}
                    </div>
                </div>
                <div className="flex-1 px-1">
                    <h4 className="text-[10px] font-black truncate text-zinc-100 uppercase mb-1">{card.name}</h4>
                    <div className="flex justify-between items-center text-[9px] mb-2 font-bold">
                        <span className="text-red-400">‚öîÔ∏è {card.baseAtk}</span>
                        <span className="text-cyan-400">üõ°Ô∏è {card.baseDef}</span>
                    </div>
                </div>
                {onClick && (
                    <button onClick={onClick} disabled={disabled} className={`w-full py-2 rounded-lg text-[9px] font-black uppercase transition-all shadow-lg ${actionClass || 'bg-zinc-800 text-white'}`}>
                        {actionLabel || 'Ver'}
                    </button>
                )}
            </div>
        );

        // --- COMPONENTE PRINCIPAL APP ---
        const App = () => {
            const [view, setView] = useState('news');
            const [diamonds, setDiamonds] = useState(1000);
            const [owned, setOwned] = useState([0, 1, 2]);
            const [deck, setDeck] = useState([0]);
            const [userName, setUserName] = useState('');
            const [userAvatar, setUserAvatar] = useState(CARDS[0].img);
            const [loading, setLoading] = useState(true);

            // Perfil
            const [isEditingName, setIsEditingName] = useState(false);
            const [isSelectingAvatar, setIsSelectingAvatar] = useState(false);
            const [tempName, setTempName] = useState('');

            // Batalla
            const [tournamentPhase, setTournamentPhase] = useState(0);
            const [currentEnemy, setCurrentEnemy] = useState(null);
            const [playerHp, setPlayerHp] = useState(100);
            const [enemyHp, setEnemyHp] = useState(100);
            const [battleLog, setBattleLog] = useState([]);
            const [battleResult, setBattleResult] = useState(null);
            const [isAttacking, setIsAttacking] = useState(false);
            const [attackerIdx, setAttackerIdx] = useState(null);
            const [enemyHit, setEnemyHit] = useState(false);
            const [playerHit, setPlayerHit] = useState(false);
            const [enemyAttacking, setEnemyAttacking] = useState(false);
            const [dmgPopups, setDmgPopups] = useState([]);

            // IA
            const [aiAdvice, setAiAdvice] = useState('');
            const [isAiLoading, setIsAiLoading] = useState(false);

            // Inicializaci√≥n
            useEffect(() => {
                let storedUser = localStorage.getItem('ft_user');
                if (!storedUser) {
                    storedUser = prompt("Tu nombre:") || "Comandante_" + Math.floor(Math.random() * 1000);
                    localStorage.setItem('ft_user', storedUser);
                }
                setUserName(storedUser);
                setTempName(storedUser);
                
                // Cargar de Firebase
                setLoading(true);
                db.ref('users/' + storedUser).once('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        setDiamonds(data.diamonds || 0);
                        setOwned(data.owned || [0, 1, 2]);
                        setDeck(data.deck || [0]);
                        setUserAvatar(data.avatar || CARDS[0].img);
                    }
                    setLoading(false);
                });
            }, []);

            const sync = useCallback((upd) => {
                if (userName) db.ref('users/' + userName).update(upd);
            }, [userName]);

            // Sistema de Batalla
            const spawnPopup = (val, x, y, color) => {
                const id = Date.now();
                setDmgPopups(prev => [...prev, {id, val, x, y, color}]);
                setTimeout(() => setDmgPopups(prev => prev.filter(p => p.id !== id)), 800);
            };

            const attackAction = async () => {
                if (!currentEnemy || battleResult || isAttacking) return;
                setIsAttacking(true);
                
                const randomIdx = Math.floor(Math.random() * deck.length);
                const pCard = CARDS.find(c => c.id === deck[randomIdx]);
                if (!pCard) { setIsAttacking(false); return; }

                setAttackerIdx(randomIdx);
                await new Promise(r => setTimeout(r, 200));
                
                const pDmg = Math.floor(pCard.baseAtk / 5 + (Math.random() * 5));
                const nEHp = Math.max(0, enemyHp - pDmg);
                setEnemyHit(true);
                spawnPopup(pDmg, 50, 30, 'text-red-500');
                setEnemyHp(nEHp);
                setBattleLog(prev => [`‚öîÔ∏è ${pCard.name}: ${pDmg} Da√±o`, ...prev]);

                await new Promise(r => setTimeout(r, 300));
                setEnemyHit(false);
                setAttackerIdx(null);

                if (nEHp <= 0) {
                    const nD = diamonds + currentEnemy.reward;
                    setDiamonds(nD); sync({ diamonds: nD });
                    setBattleResult({ winner: 'player', message: `¬°Ganas! +${currentEnemy.reward} üíé` });
                    setIsAttacking(false);
                    return;
                }

                await new Promise(r => setTimeout(r, 400));
                setEnemyAttacking(true);
                await new Promise(r => setTimeout(r, 200));

                const eDmg = Math.floor(currentEnemy.atk / 5 + (Math.random() * 3));
                const nPHp = Math.max(0, playerHp - eDmg);
                setPlayerHit(true);
                spawnPopup(eDmg, 50, 70, 'text-cyan-500');
                setPlayerHp(nPHp);
                setBattleLog(prev => [`üí• ${currentEnemy.name} golpea: ${eDmg} Da√±o`, ...prev]);

                await new Promise(r => setTimeout(r, 300));
                setPlayerHit(false);
                setEnemyAttacking(false);
                if (nPHp <= 0) setBattleResult({ winner: 'enemy', message: "Ca√≠ste en combate." });
                setIsAttacking(false);
            };

            const fetchAdvice = async () => {
                setIsAiLoading(true);
                try {
                    // Nota: En un entorno de navegador real sin proxy, 
                    // process.env.API_KEY debe reemplazarse por el valor real o un input.
                    // Aqu√≠ se usa el est√°ndar del sistema.
                    const ai = new GoogleGenAI({ apiKey: "TU_API_KEY_AQUI_O_DEJALA_COMO_ESTA" });
                    const deckInfo = deck.map(id => CARDS.find(c => c.id === id).name).join(', ');
                    const prompt = `Como estratega de Fortnite, aconseja a ${userName} que tiene este mazo: ${deckInfo} y ${diamonds} gemas. S√© breve y √©pico.`;
                    const res = await ai.models.generateContent({ model: 'gemini-3-flash-preview', contents: prompt });
                    setAiAdvice(res.text || "¬°Lucha con valor!");
                } catch { setAiAdvice("El or√°culo est√° en silencio..."); }
                finally { setIsAiLoading(false); }
            };

            if (loading) return <div className="h-screen flex items-center justify-center bg-black text-white font-black animate-pulse">CARGANDO...</div>;

            return (
                <div className="max-w-md mx-auto min-h-screen pb-24 bg-[#020202] text-white flex flex-col relative overflow-hidden">
                    
                    {/* Selector de Avatar */}
                    {isSelectingAvatar && (
                        <div className="fixed inset-0 z-[100] bg-black/95 backdrop-blur-2xl flex flex-col p-8 animate-in fade-in duration-300">
                           <div className="flex justify-between items-center mb-8">
                             <h2 className="text-2xl font-black italic text-cyan-400 uppercase">Avatar</h2>
                             <button onClick={() => setIsSelectingAvatar(false)} className="bg-zinc-800 w-12 h-12 rounded-full">‚úï</button>
                           </div>
                           <div className="grid grid-cols-3 gap-4 overflow-y-auto custom-scrollbar">
                             {owned.map(id => {
                               const c = CARDS.find(x => x.id === id);
                               return (
                                 <button key={id} onClick={() => { setUserAvatar(c.img); sync({ avatar: c.img }); setIsSelectingAvatar(false); }}
                                  className="aspect-square rounded-2xl overflow-hidden border-2 border-zinc-800 hover:border-cyan-500 transition-all active:scale-90 shadow-xl">
                                   <img src={c.img} className="w-full h-full object-cover" />
                                 </button>
                               );
                             })}
                           </div>
                        </div>
                    )}

                    <header className="p-4 flex justify-between items-center bg-zinc-950/90 border-b border-zinc-800 sticky top-0 z-50 backdrop-blur-md">
                        <div className="flex items-center gap-3">
                            <button onClick={() => setIsSelectingAvatar(true)} className="relative w-12 h-12">
                                <img src={userAvatar} className="w-12 h-12 rounded-full border-2 border-cyan-500/50 object-cover" />
                                <div className="absolute -bottom-1 -right-1 bg-cyan-600 text-[8px] w-4 h-4 flex items-center justify-center rounded-full border border-black">‚úé</div>
                            </button>
                            <div>
                                <h1 className="text-sm font-black text-white italic uppercase leading-none">FT CLOUD</h1>
                                <p className="text-[10px] opacity-60 font-bold truncate max-w-[100px]">{userName}</p>
                            </div>
                        </div>
                        <div className="bg-zinc-900/50 px-3 py-1.5 rounded-2xl text-xs font-black border border-zinc-800 text-amber-500 italic">
                            üíé {diamonds.toLocaleString()}
                        </div>
                    </header>

                    <main className="flex-1 p-4 overflow-y-auto custom-scrollbar relative">
                        {view === 'tournament' && (
                            <div className="h-full flex flex-col space-y-4">
                                {tournamentPhase === 0 ? (
                                    <div className="flex-1 flex flex-col items-center justify-center space-y-8 bg-zinc-900/30 rounded-[3rem] border border-zinc-800 p-10 text-center shadow-2xl">
                                        <div className="text-8xl drop-shadow-[0_0_30px_rgba(245,158,11,0.5)]">üèÜ</div>
                                        <h2 className="text-3xl font-black text-amber-500 italic tracking-tighter uppercase leading-none">Torneo Ultimate</h2>
                                        <button onClick={() => {
                                            if(!deck.length) return alert("Carga tu mazo");
                                            setTournamentPhase(1);
                                            const e = TOURNAMENT_ENEMIES[0];
                                            setCurrentEnemy(e); setEnemyHp(e.hp); setPlayerHp(100); setBattleResult(null); setBattleLog(["¬°Lucha!"]);
                                        }} className="w-full py-5 bg-amber-600 text-black font-black rounded-3xl shadow-xl active:scale-95 transition-all">ENTRAR A LA ARENA</button>
                                    </div>
                                ) : (
                                    <div className="flex-1 flex flex-col space-y-4 relative">
                                        {/* Boss HUD */}
                                        <div className={`transition-all ${enemyHit ? 'animate-shake' : ''}`}>
                                            <div className="bg-zinc-900 border border-zinc-800 p-4 rounded-3xl flex items-center justify-between relative overflow-hidden shadow-2xl">
                                                <div className="flex items-center gap-3 z-10">
                                                    <div className={`w-14 h-14 rounded-xl overflow-hidden border-2 border-red-500/50 ${enemyAttacking ? 'animate-attack-enemy' : ''}`}>
                                                        <img src={currentEnemy?.avatar} className="w-full h-full object-cover" />
                                                    </div>
                                                    <h3 className="text-xs font-black uppercase text-red-500 italic">{currentEnemy?.name}</h3>
                                                </div>
                                                <div className="z-10 text-right">
                                                    <div className="text-[10px] font-black">{enemyHp} HP</div>
                                                    <div className="w-20 h-1.5 bg-black rounded-full overflow-hidden border border-zinc-800 mt-1">
                                                        <div className="h-full bg-red-600 transition-all duration-500" style={{ width: `${(enemyHp/(currentEnemy?.hp||100))*100}%` }} />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        {/* Battle Arena */}
                                        <div className="flex-1 relative min-h-[140px] flex items-center justify-center overflow-visible">
                                            {dmgPopups.map(p => (
                                                <div key={p.id} className={`damage-popup ${p.color} text-4xl`} style={{ left: `${p.x}%`, top: `${p.y}%` }}>-{p.val}</div>
                                            ))}
                                            <div className="text-zinc-900 text-6xl font-black italic select-none opacity-20 uppercase tracking-tighter">Versus</div>
                                        </div>

                                        {/* Player HUD */}
                                        <div className={`transition-all ${playerHit ? 'animate-shake' : ''}`}>
                                            <div className="bg-zinc-900 border border-zinc-800 p-4 rounded-3xl space-y-4 shadow-2xl relative">
                                                <div className="flex justify-between items-center text-[10px] font-black uppercase text-cyan-500">
                                                    <span>Escuadr√≥n</span>
                                                    <span>{playerHp} HP</span>
                                                </div>
                                                <div className="flex justify-center gap-2 h-28 items-end">
                                                    {deck.map((id, idx) => {
                                                        const c = CARDS.find(x => x.id === id);
                                                        return (
                                                            <div key={idx} className={`w-16 h-24 rounded-lg overflow-hidden border-2 bg-black transition-all ${attackerIdx === idx ? 'animate-attack-player border-cyan-400 z-50' : 'border-zinc-800'}`}>
                                                                <img src={c.img} className="w-full h-full object-cover" />
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                                {!battleResult ? (
                                                    <button onClick={attackAction} disabled={isAttacking} className="w-full py-4 bg-cyan-600 rounded-2xl font-black uppercase text-xs tracking-widest active:scale-95 disabled:opacity-50 transition-all">üí• ATACAR</button>
                                                ) : (
                                                    <div className="text-center space-y-4 pt-2">
                                                        <div className={`text-2xl font-black italic ${battleResult.winner === 'player' ? 'text-green-500' : 'text-red-500'}`}>{battleResult.winner === 'player' ? '¬°VICTORIA!' : 'DERROTA'}</div>
                                                        <button onClick={battleResult.winner === 'player' ? () => {
                                                            const nP = tournamentPhase + 1;
                                                            if (nP > 4) { alert("¬°CAMPE√ìN!"); setTournamentPhase(0); }
                                                            else {
                                                                setTournamentPhase(nP); const e = TOURNAMENT_ENEMIES.find(x => x.phase === nP);
                                                                setCurrentEnemy(e); setEnemyHp(e.hp); setPlayerHp(100); setBattleResult(null);
                                                            }
                                                        } : () => setTournamentPhase(0)} className="w-full py-3 bg-zinc-800 rounded-xl font-black text-[10px] uppercase">Continuar</button>
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {view === 'news' && (
                            <div className="space-y-6">
                                <section className="bg-zinc-900 border border-zinc-800 p-10 rounded-[3rem] text-center shadow-2xl relative overflow-hidden">
                                    <div className="absolute inset-0 bg-cyan-500/5"></div>
                                    <img src={userAvatar} className="w-24 h-24 rounded-full mx-auto mb-6 border-2 border-cyan-500 shadow-2xl object-cover" />
                                    <h2 className="text-2xl font-black italic tracking-tighter mb-2 uppercase">Base Cloud</h2>
                                    <p className="text-xs opacity-50 mb-8 italic italic">Progreso sincronizado en la nube.</p>
                                    <button onClick={() => { setDiamonds(d => d + 10000); alert("¬°Bono!"); }} className="w-full bg-cyan-600 py-4 rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-xl">Gemas Diarias</button>
                                </section>
                            </div>
                        )}

                        {view === 'shop' && (
                            <div className="grid grid-cols-2 gap-3 pb-4">
                                {CARDS.filter(c => !owned.includes(c.id)).map(card => (
                                    <CardItem key={card.id} card={card} onClick={() => {
                                        if (diamonds >= card.shopPrice) {
                                            const nO = [...owned, card.id]; const nD = diamonds - card.shopPrice;
                                            setOwned(nO); setDiamonds(nD); sync({ owned: nO, diamonds: nD });
                                        } else alert("Pobre...");
                                    }} actionLabel={`üíé ${card.shopPrice}`} actionClass="bg-green-600" />
                                ))}
                            </div>
                        )}

                        {view === 'deck' && (
                            <div className="space-y-6">
                                <h3 className="text-[10px] font-black text-zinc-600 uppercase tracking-widest px-2 italic">Escuadr√≥n ({deck.length}/3)</h3>
                                <div className="grid grid-cols-3 gap-3 bg-zinc-900/20 border-2 border-dashed border-zinc-800 rounded-[2rem] p-4 min-h-[160px]">
                                    {deck.map(id => {
                                        const c = CARDS.find(x => x.id === id);
                                        return <CardItem key={id} card={c} onClick={() => { const nD = deck.filter(x => x !== id); setDeck(nD); sync({ deck: nD }); }} actionLabel="‚úï" actionClass="bg-red-900/20 text-red-500" />;
                                    })}
                                </div>
                                <h3 className="text-[10px] font-black text-zinc-600 uppercase tracking-widest px-2 italic">Reserva ({owned.length})</h3>
                                <div className="grid grid-cols-3 gap-3">
                                    {owned.map(id => {
                                        const c = CARDS.find(x => x.id === id); const isIn = deck.includes(id);
                                        return <CardItem key={id} card={c} onClick={() => {
                                            if (isIn) { const nD = deck.filter(x => x !== id); setDeck(nD); sync({ deck: nD }); }
                                            else if (deck.length < 3) { const nD = [...deck, id]; setDeck(nD); sync({ deck: nD }); }
                                        }} actionLabel={isIn ? "‚úì" : "+"} actionClass={isIn ? "bg-red-600/20 text-red-500" : "bg-cyan-600 shadow-lg"} />;
                                    })}
                                </div>
                            </div>
                        )}

                        {view === 'ai-strategy' && (
                            <div className="flex-1 flex flex-col items-center justify-center p-6 text-center space-y-8 bg-zinc-900/30 rounded-[3rem] border border-purple-500/20">
                                <div className="text-7xl drop-shadow-[0_0_15px_rgba(168,85,247,0.5)]">üßô‚Äç‚ôÇÔ∏è</div>
                                <h2 className="text-2xl font-black italic tracking-tighter text-purple-400 uppercase">Or√°culo Sabio</h2>
                                <div className="bg-black/60 p-6 rounded-2xl border border-zinc-800 min-h-[140px] text-[10px] italic opacity-80 leading-relaxed shadow-inner">
                                    {isAiLoading ? "Consultando el meta de la isla..." : (aiAdvice || "Invoca consejos estrat√©gicos para dominar el torneo.")}
                                </div>
                                <button onClick={fetchAdvice} disabled={isAiLoading} className="w-full py-5 bg-purple-600 rounded-2xl font-black uppercase text-[10px] tracking-widest shadow-xl disabled:opacity-30">INVOCAR SABIDUR√çA</button>
                            </div>
                        )}
                    </main>

                    <nav className="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-zinc-950/95 border-t border-zinc-800 py-6 flex justify-around items-center z-50 rounded-t-[2.5rem] shadow-[0_-20px_60px_rgba(0,0,0,1)] px-4 backdrop-blur-xl">
                        <NavBtn active={view === 'news'} onClick={() => setView('news')} label="HOME" icon="üè†" />
                        <NavBtn active={view === 'tournament'} onClick={() => setView('tournament')} label="WAR" icon="üèÜ" />
                        <NavBtn active={view === 'shop'} onClick={() => setView('shop')} label="SHOP" icon="üõí" />
                        <NavBtn active={view === 'deck'} onClick={() => setView('deck')} label="DECK" icon="üÉè" />
                        <NavBtn active={view === 'ai-strategy'} onClick={() => setView('ai-strategy')} label="SAGE" icon="üßô‚Äç‚ôÇÔ∏è" />
                    </nav>
                </div>
            );
        };

        const NavBtn = ({ active, onClick, icon, label }) => (
            <button onClick={onClick} className={`flex flex-col items-center gap-1.5 transition-all duration-300 ${active ? 'scale-110' : 'opacity-20 hover:opacity-50'}`}>
                <span className={`text-xl w-10 h-10 flex items-center justify-center rounded-2xl transition-all ${active ? 'bg-cyan-600 text-white shadow-[0_0_15px_rgba(6,182,212,0.6)]' : 'bg-zinc-900 text-zinc-400'}`}>{icon}</span>
                <span className={`text-[7px] font-black tracking-widest ${active ? 'text-cyan-400' : 'text-zinc-600'}`}>{label}</span>
            </button>
        );

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
