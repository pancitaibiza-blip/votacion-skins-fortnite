<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Fortnite Cartas √âpicas</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <style>
    body {
      background: linear-gradient(135deg, #0c0a25, #2a1b5e, #1a1a3a);
      background-size: 400% 400%;
      animation: gradientBG 20s ease infinite;
      color: white;
      min-height: 100vh;
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      overflow-x: hidden;
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .hidden { display: none !important; }
    .btn {
      background: #8b5cf6;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 6px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    .btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
    }
    .card-small {
      width: 110px;
      background: rgba(20, 20, 40, 0.9);
      border-radius: 10px;
      padding: 6px;
      text-align: center;
      transition: all 0.3s;
    }
    .card-small:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 15px rgba(100, 100, 255, 0.6);
    }
    .card-battle {
      width: 160px;
      height: 240px;
      background: rgba(10, 10, 30, 0.95);
      border-radius: 16px;
      padding: 10px;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 0 0 25px rgba(0, 0, 0, 0.7);
      transition: all 0.4s;
      position: relative;
    }
    .card-battle.attacking {
      animation: attackPulse 0.8s 3;
    }
    @keyframes attackPulse {
      0%, 100% { transform: scale(1); filter: brightness(1); }
      50% { transform: scale(1.1); filter: brightness(1.5); box-shadow: 0 0 40px gold; }
    }
    .hp-bar {
      height: 8px;
      background: #333;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 4px;
    }
    .hp-fill {
      height: 100%;
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      transition: width 0.5s ease;
    }
    .timer-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #ff6b35;
      color: white;
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 12px;
      font-weight: bold;
      z-index: 2;
    }
    .rarity-common { border-top: 4px solid #9e9e9e; }
    .rarity-rare { border-top: 4px solid #4caf50; }
    .rarity-epic { border-top: 4px solid #9c27b0; }
    .rarity-legendary { border-top: 4px solid #ff9800; }
    .rarity-tournament { border-top: 4px solid #f44336; }
    #battleLog {
      min-height: 80px;
      background: rgba(0,0,0,0.5);
      padding: 15px;
      border-radius: 12px;
      margin: 20px 0;
      text-align: center;
      font-size: 18px;
      line-height: 1.4;
    }

    /* === CONTADOR DE COFRES === */
    #chestsBanner {
      background: linear-gradient(to right, #ff416c, #ff4b2b);
      color: white;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      font-size: 18px;
      overflow: hidden;
      white-space: nowrap;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.5);
    }
    #tickerText {
      display: inline-block;
      animation: scrollLeft 25s linear infinite;
    }
    @keyframes scrollLeft {
      0% { transform: translateX(100%); }
      100% { transform: translateX(-100%); }
    }
    #countdownTimer {
      display: inline-block;
      background: #000;
      color: gold;
      padding: 2px 10px;
      border-radius: 6px;
      margin: 0 8px;
      font-weight: bold;
    }

    /* === EFECTO DE CALAVERA === */
    .skull-effect {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 2000;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
    }
    .skull-icon {
      font-size: 120px;
      color: #ff0055;
      text-shadow: 0 0 20px rgba(255, 0, 85, 0.8);
      animation: skullFloat 1.5s ease-out, skullPulse 2s infinite alternate;
    }
    @keyframes skullFloat {
      0% { transform: scale(0.2) translateY(100px); opacity: 0; }
      60% { transform: scale(1.2) translateY(-20px); opacity: 1; }
      100% { transform: scale(1) translateY(0); opacity: 1; }
    }
    @keyframes skullPulse {
      from { text-shadow: 0 0 20px rgba(255, 0, 85, 0.8); }
      to { text-shadow: 0 0 40px rgba(255, 0, 85, 1), 0 0 60px rgba(255, 0, 150, 1); }
    }
  </style>
</head>
<body>
  <!-- CONTADOR DE COFRES -->
  <div id="chestsBanner">
    <span id="tickerText">
      üîî ¬°LLEGAN LOS COFRES! üîî ¬øQu√© carta nueva te tocar√°? 
      <span id="countdownTimer">Cargando...</span>
    </span>
  </div>

  <!-- EFECTO DE CALAVERA (INICIALMENTE OCULTO) -->
  <div id="skullEffect" class="skull-effect">
    <i class="fas fa-skull skull-icon"></i>
  </div>

  <div class="container mx-auto px-4 py-6 pt-20">
    <h1 class="text-3xl font-bold text-center mb-6 bg-clip-text text-transparent bg-gradient-to-r from-purple-400 via-pink-500 to-yellow-400">
      üõ°Ô∏è FORTNITE: BATALLA DE CARTAS
    </h1>

    <div id="content" class="mb-24">
      <!-- Batalla -->
      <div id="battle" class="view">
        <div id="battleLog">¬°Elige una carta y ataca!</div>
        
        <div class="text-center mb-8">
          <h3 class="text-xl font-bold text-red-400 mb-3">IA</h3>
          <div id="enemyCard" class="inline-block"></div>
        </div>

        <div class="text-center">
          <h3 class="text-xl font-bold text-green-400 mb-3">TU MAZO</h3>
          <div id="playerCards" class="flex flex-wrap justify-center gap-4"></div>
        </div>

        <div class="text-center mt-6">
          <button class="btn bg-red-600" onclick="playerAttack()">üî• ATACAR</button>
          <button class="btn bg-blue-600" onclick="playerDefend()">üõ°Ô∏è DEFENDER</button>
        </div>
      </div>

      <!-- Mazo -->
      <div id="deck" class="view hidden">
        <h2 class="text-2xl text-center mb-4">üé¥ TU MAZO</h2>
        <div class="text-center mb-4">
          <select id="rarityFilter" onchange="renderDeck()" class="bg-gray-800 text-white p-2 rounded">
            <option value="all">Todas</option>
            <option value="common">Com√∫n</option>
            <option value="rare">Rara</option>
            <option value="epic">√âpica</option>
            <option value="legendary">Legendaria</option>
            <option value="tournament">Torneo</option>
          </select>
        </div>
        <div id="deckCards" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 justify-center"></div>
      </div>

      <!-- Tienda -->
      <div id="shop" class="view hidden">
        <h2 class="text-2xl text-center mb-4">üíé TIENDA (Rotaci√≥n: 5 d√≠as)</h2>
        <div id="shopCards" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 justify-center"></div>
      </div>

      <!-- Torneo -->
      <div id="tournament" class="view hidden">
        <h2 class="text-3xl font-bold text-center mb-2 text-yellow-400">üèÜ TORNEO √âPICO</h2>
        
        <div class="bg-gradient-to-r from-red-900 via-orange-800 to-yellow-900 border-2 border-yellow-500 rounded-xl p-4 mb-6 mx-auto max-w-2xl animate-pulse">
          <div class="flex items-center justify-center gap-3 mb-2">
            <i class="fas fa-star text-yellow-300 text-xl"></i>
            <span class="text-xl font-bold text-white">¬°NUEVO DESAF√çO!</span>
            <i class="fas fa-star text-yellow-300 text-xl"></i>
          </div>
          <p class="text-center text-yellow-100 font-semibold">
            üèÜ Consigue esta carta <span class="text-yellow-300 font-extrabold">LEGENDARIA</span> ganando 5 rondas.
          </p>
          <div class="text-center mt-3">
            <img 
              src="https://s206.erome.com/4699/lpRzYjBO/gU2HfmRY.jpeg?v=1745795818" 
              alt="Carta Legendaria: IA √âLITE" 
              class="inline-block w-24 h-24 rounded-lg border-2 border-yellow-400 shadow-lg mx-auto"
            />
            <div class="text-yellow-200 text-sm font-bold mt-1">IA √âLITE</div>
          </div>
        </div>

        <p class="text-center text-gray-300 mb-6">
          ¬°Derrota a 5 jefes poderosos en ronda consecutiva y desbloquear√°s esta carta exclusiva!
        </p>
        
        <div class="text-center">
          <button class="btn bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-6 py-3 rounded-lg text-lg font-bold shadow-lg hover:shadow-xl transition-all" onclick="startTournament()">
            ‚öîÔ∏è ENTRAR AL TORNEO
          </button>
        </div>
      </div>
    </div>

    <div class="fixed bottom-4 left-0 right-0 flex justify-center gap-3 z-10">
      <button class="btn bg-gray-800" onclick="showView('battle')">Batalla</button>
      <button class="btn bg-gray-800" onclick="showView('deck')">Mazo</button>
      <button class="btn bg-gray-800" onclick="showView('shop')">Tienda</button>
      <button class="btn bg-gray-800" onclick="showView('tournament')">Torneo</button>
    </div>
  </div>

  <script>
    // === CONTADOR DE COFRES ===
    function updateChestCountdown() {
      const lastUpdate = localStorage.getItem('lastShopUpdate') || new Date().toISOString();
      const nextUpdate = new Date(new Date(lastUpdate).getTime() + 5 * 24 * 60 * 60 * 1000);
      const now = new Date();
      let diff = nextUpdate - now;

      if (diff <= 0) {
        localStorage.setItem('lastShopUpdate', new Date().toISOString());
        document.getElementById('countdownTimer').textContent = '¬°AHORA!';
        setTimeout(() => location.reload(), 3000);
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const mins = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const secs = Math.floor((diff % (1000 * 60)) / 1000);

      document.getElementById('countdownTimer').textContent = 
        `${days}d ${hours}h ${mins}m ${secs}s`;
    }

    setInterval(updateChestCountdown, 1000);
    updateChestCountdown();

    // === EFECTO DE CALAVERA ===
    function showSkullEffect() {
      const skull = document.getElementById('skullEffect');
      skull.style.opacity = '1';
      skull.style.display = 'flex';
      setTimeout(() => {
        skull.style.opacity = '0';
        setTimeout(() => skull.style.display = 'none', 1000);
      }, 2000);
    }

    // === RESTO DEL JUEGO ===
    const ALL_CARDS = [
      { id: 0, name: "Ram√≠rez", rarity: "common", atk: 60, def: 50, img: "https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", shopPrice: null },
      { id: 1, name: "Fortaleza", rarity: "rare", atk: 60, def: 70, img: "https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", shopPrice: null },
      { id: 2, name: "Escudera", rarity: "common", atk: 55, def: 65, img: "https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", shopPrice: null },
      { id: 3, name: "Azulita", rarity: "rare", atk: 70, def: 55, img: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", shopPrice: 80 },
      { id: 4, name: "Tormenta", rarity: "epic", atk: 80, def: 45, img: "https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", shopPrice: 120 },
      { id: 5, name: "Furia", rarity: "legendary", atk: 90, def: 40, img: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", shopPrice: 200 },
      { id: 6, name: "Asesina", rarity: "legendary", atk: 95, def: 30, img: "https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", shopPrice: 250 }
    ];

    const IA_CARDS = [
      { id: 100, name: "IA B√°sica", rarity: "common", atk: 65, def: 70, img: "https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894" },
      { id: 101, name: "IA √âlite", rarity: "legendary", atk: 95, def: 60, img: "https://s206.erome.com/4699/lpRzYjBO/gU2HfmRY.jpeg?v=1745795818" }
    ];

    let gameState = {
      playerCards: [
        { ...ALL_CARDS[0], currentHp: 50, alive: true },
        { ...ALL_CARDS[1], currentHp: 70, alive: true },
        { ...ALL_CARDS[2], currentHp: 65, alive: true }
      ],
      enemyCard: { ...IA_CARDS[0], currentHp: 70, alive: true },
      diamonds: 100,
      ownedCardIds: [0, 1, 2]
    };

    function saveGame() {
      localStorage.setItem('ownedCardIds', JSON.stringify(gameState.ownedCardIds));
      localStorage.setItem('diamonds', gameState.diamonds);
      localStorage.setItem('lastShopUpdate', new Date().toISOString());
    }

    function loadGame() {
      const saved = localStorage.getItem('ownedCardIds');
      if (saved) {
        gameState.ownedCardIds = JSON.parse(saved);
        if (gameState.ownedCardIds.length === 0) {
          gameState.ownedCardIds = [0, 1, 2];
        }
      }
      gameState.diamonds = parseInt(localStorage.getItem('diamonds') || '100');
    }

    function renderDeck() {
      const container = document.getElementById('deckCards');
      const rarity = document.getElementById('rarityFilter').value;
      const cardsToShow = ALL_CARDS.filter(c => 
        gameState.ownedCardIds.includes(c.id) &&
        (rarity === 'all' || c.rarity === rarity)
      );

      container.innerHTML = cardsToShow.map(c => `
        <div class="card-small ${c.rarity}">
          <img src="${c.img}" style="width:100%; height:130px; object-fit:cover; border-radius:6px;">
          <div class="font-bold text-xs mt-1 truncate">${c.name}</div>
          <div class="text-[10px] opacity-80">${c.rarity}</div>
        </div>
      `).join('');
    }

    function renderShop() {
      const container = document.getElementById('shopCards');
      const lastUpdate = localStorage.getItem('lastShopUpdate');
      const now = new Date();
      let daysPassed = 0;
      if (lastUpdate) {
        daysPassed = Math.floor((now - new Date(lastUpdate)) / (1000 * 60 * 60 * 24));
      }
      const daysLeft = Math.max(0, 5 - daysPassed);

      const shopCards = ALL_CARDS.filter(c => c.shopPrice !== null && !gameState.ownedCardIds.includes(c.id));
      container.innerHTML = shopCards.map(c => `
        <div class="card-small ${c.rarity} relative">
          <div class="timer-badge">${daysLeft}d</div>
          <img src="${c.img}" style="width:100%; height:130px; object-fit:cover; border-radius:6px;">
          <div class="font-bold text-xs mt-1 truncate">${c.name}</div>
          <div class="text-yellow-400 text-[11px]">üíé${c.shopPrice}</div>
          <button class="btn w-full mt-1 py-1 text-[10px]" onclick="buyCard(${c.id})">Comprar</button>
        </div>
      `).join('');
    }

    function renderBattle() {
      const enemy = gameState.enemyCard;
      const enemyHpPercent = Math.max(0, Math.min(100, Math.round((enemy.currentHp / enemy.def) * 100)));
      document.getElementById('enemyCard').innerHTML = `
        <div class="card-battle ${enemy.rarity}" style="${!enemy.alive ? 'opacity:0.4; filter: grayscale(1);' : ''}">
          <img src="${enemy.img}" style="width:100%; height:140px; object-fit:cover; border-radius:8px;">
          <div class="font-bold">${enemy.name}</div>
          <div class="text-sm">‚öîÔ∏è${enemy.atk} üõ°Ô∏è${enemy.def}</div>
          <div class="hp-bar"><div class="hp-fill" style="width:${enemyHpPercent}%"></div></div>
          <div class="text-xs">HP: ${enemy.currentHp}/${enemy.def}</div>
        </div>
      `;

      const playerContainer = document.getElementById('playerCards');
      playerContainer.innerHTML = gameState.playerCards.map((card, i) => {
        const hpPercent = Math.max(0, Math.min(100, Math.round((card.currentHp / card.def) * 100)));
        return `
          <div class="card-battle ${card.rarity}" style="cursor:pointer; ${!card.alive ? 'opacity:0.4; filter: grayscale(1);' : ''}" onclick="selectPlayerCard(${i})">
            <img src="${card.img}" style="width:100%; height:140px; object-fit:cover; border-radius:8px;">
            <div class="font-bold">${card.name}</div>
            <div class="text-sm">‚öîÔ∏è${card.atk} üõ°Ô∏è${card.def}</div>
            <div class="hp-bar"><div class="hp-fill" style="width:${hpPercent}%"></div></div>
            <div class="text-xs">HP: ${card.currentHp}/${card.def}</div>
          </div>
        `;
      }).join('');
    }

    function buyCard(cardId) {
      const card = ALL_CARDS.find(c => c.id === cardId);
      if (!card || !card.shopPrice) return;
      if (gameState.diamonds >= card.shopPrice) {
        gameState.diamonds -= card.shopPrice;
        gameState.ownedCardIds.push(cardId);
        saveGame();
        renderShop();
        renderDeck();
        alert(`¬°Has comprado ${card.name}!`);
      } else {
        alert("¬°No tienes suficientes diamantes! üíé");
      }
    }

    let selectedPlayerIndex = 0;
    function selectPlayerCard(index) {
      if (!gameState.playerCards[index].alive) return;
      selectedPlayerIndex = index;
      document.querySelectorAll('.card-battle').forEach(el => el.classList.remove('attacking'));
      document.querySelectorAll('.card-battle')[index + 1]?.classList.add('attacking');
    }

    function playerAttack() {
      const playerCard = gameState.playerCards[selectedPlayerIndex];
      const enemy = gameState.enemyCard;

      if (!playerCard || !playerCard.alive) {
        document.getElementById('battleLog').innerHTML = "¬°Esta carta est√° fuera de combate!";
        return;
      }

      const damage = Math.max(5, playerCard.atk - Math.floor(enemy.def * 0.3));
      enemy.currentHp = Math.max(0, enemy.currentHp - damage);

      document.getElementById('battleLog').innerHTML = `¬°${playerCard.name} ataca a ${enemy.name} por <strong>${damage} da√±o</strong>!`;

      const enemyEl = document.getElementById('enemyCard').querySelector('.card-battle');
      enemyEl.style.animation = 'attackPulse 0.8s 1';
      setTimeout(() => enemyEl.style.animation = '', 800);

      setTimeout(() => {
        renderBattle();
        if (enemy.currentHp <= 0 && enemy.alive) {
          enemy.alive = false;
          document.getElementById('battleLog').innerHTML = `üíÄ ¬°${enemy.name} fue eliminado!`;
          showSkullEffect();
        }
      }, 800);
    }

    function playerDefend() {
      const playerCard = gameState.playerCards[selectedPlayerIndex];
      if (!playerCard || !playerCard.alive) {
        document.getElementById('battleLog').innerHTML = "¬°Esta carta est√° fuera de combate!";
        return;
      }
      document.getElementById('battleLog').innerHTML = `¬°${playerCard.name} se defiende y reduce el pr√≥ximo da√±o!`;
    }

    function startTournament() {
      alert("¬°El torneo √©pico est√° en desarrollo! Pr√≥ximamente podr√°s ganar la carta legendaria IA √âLITE.");
    }

    function showView(view) {
      document.querySelectorAll('.view').forEach(el => el.classList.add('hidden'));
      document.getElementById(view).classList.remove('hidden');
      if (view === 'deck') renderDeck();
      if (view === 'shop') renderShop();
      if (view === 'battle') renderBattle();
    }

    loadGame();
    showView('battle');
  </script>
</body>
</html>
