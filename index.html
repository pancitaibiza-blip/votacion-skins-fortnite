undefined<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>üéÑ Fortnite Cartas - Evento Navide√±o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Configuraci√≥n global */
        body {
            background: linear-gradient(135deg, #b22222, #228b22, #ffd700, #ffffff);
            background-size: 400% 400%;
            animation: gradientBG 30s ease infinite;
            color: white;
            min-height: 100vh;
            margin: 0;
            font-family: 'Montserrat', sans-serif;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Efectos de iluminaci√≥n */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2) 0%, rgba(255,255,255,0) 70%);
            pointer-events: none;
            z-index: 1;
        }
        
        body::after {
            content: "‚ùÑÔ∏è";
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-size: 28px;
            opacity: 0.6;
            z-index: 1;
            text-shadow: 0 0 10px rgba(255,255,255,0.8);
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .snowflake {
            position: absolute;
            background: white;
            border-radius: 50%;
            pointer-events: none;
            animation: fall linear infinite;
            z-index: 0;
            box-shadow: 0 0 5px rgba(255,255,255,0.8);
        }
        
        @keyframes fall {
            0% { top: -10vh; transform: translateX(0); }
            100% { top: 110vh; transform: translateX(50px); }
        }
        
        /* Botones */
        .btn {
            background: linear-gradient(to right, #d42020, #ff4545);
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 4px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
            font-family: 'Montserrat', sans-serif;
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(255,255,255,0.3) 0%, rgba(255,255,255,0) 50%);
            z-index: -1;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        /* Contenedor de cartas */
        .card-container {
            position: relative;
            display: inline-block;
            margin: 4px;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .card-container:hover {
            transform: translateY(-5px);
        }
        
        /* Base de cartas */
        .card-base {
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            width: 160px;
            background: linear-gradient(135deg, rgba(10, 15, 25, 0.95) 0%, rgba(30, 35, 45, 0.95) 100%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.3s ease;
        }
        
        .card-container:hover .card-base {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        /* Efecto de brillo */
        .card-glow {
            position: absolute;
            top: -15px;
            left: -15px;
            right: -15px;
            bottom: -15px;
            border-radius: 24px;
            z-index: -1;
            opacity: 0.7;
            filter: blur(15px);
            transition: all 0.5s ease;
        }
        
        .card-container:hover .card-glow {
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Efectos de rareza */
        .rarity-common .card-glow { 
            background: #9e9e9e;
            box-shadow: 0 0 20px rgba(158, 158, 158, 0.8);
        }
        .rarity-rare .card-glow { 
            background: #4caf50;
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.8);
        }
        .rarity-epic .card-glow { 
            background: #9c27b0;
            box-shadow: 0 0 20px rgba(156, 39, 176, 0.8);
        }
        .rarity-legendary .card-glow { 
            background: #d4a017;
            box-shadow: 0 0 25px rgba(212, 160, 23, 0.9);
        }
        .rarity-idolos .card-glow { 
            background: linear-gradient(45deg, #ff9800, #ff4081, #ffc107);
            opacity: 0.8;
            filter: blur(15px);
            animation: glowPulse 2s infinite alternate;
            box-shadow: 0 0 30px rgba(255, 152, 0, 0.9);
        }
        .rarity-animated .card-glow { 
            background: linear-gradient(45deg, #ff1493, #ff69b4, #ffc0cb);
            opacity: 0.9;
            filter: blur(18px);
            animation: glowPulseAnimated 1.5s infinite alternate;
            box-shadow: 0 0 35px rgba(255, 20, 147, 0.9);
        }
        
        @keyframes glowPulse {
            0% { transform: scale(1); opacity: 0.6; }
            100% { transform: scale(1.2); opacity: 1; }
        }
        
        @keyframes glowPulseAnimated {
            0% { transform: scale(1); opacity: 0.7; }
            100% { transform: scale(1.3); opacity: 1; }
        }
        
        .rarity-animated .card-base { 
            box-shadow: 0 0 25px #ff1493, 0 0 35px #ff69b4, 0 10px 20px rgba(0,0,0,0.4);
            animation: bounceSlight 2s infinite;
        }
        
        @keyframes bounceSlight {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        .rarity-tournament .card-glow { 
            background: #f44336;
            box-shadow: 0 0 25px rgba(244, 67, 54, 0.9);
        }
        .rarity-paises .card-glow { 
            background: linear-gradient(45deg, #ff0000, #ffffff, #0000ff);
            opacity: 0.8;
            filter: blur(15px);
            animation: glowPulse 2s infinite alternate;
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.8);
        }
        .rarity-paises .card-base { 
            box-shadow: 0 0 20px #ff0000, 0 0 30px #0000ff, 0 10px 20px rgba(0,0,0,0.4);
        }
        
        /* Contenido de cartas */
        .card-content {
            padding: 8px;
            text-align: center;
            position: relative;
            z-index: 2;
        }
        
        .card-content img {
            transition: transform 0.3s ease;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .card-container:hover .card-content img {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        /* Insignia de mejora */
        .upgrade-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background: linear-gradient(to bottom, #ffd700, #d4af37);
            color: #333;
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 6px;
            font-weight: bold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        /* Barra de estad√≠sticas */
        .stats-bar {
            background: linear-gradient(135deg, rgba(10, 20, 10, 0.9) 0%, rgba(30, 40, 30, 0.9) 100%);
            border-radius: 20px;
            padding: 16px;
            margin: 24px 0;
            display: flex;
            justify-content: center;
            gap: 24px;
            border: 1px solid rgba(212, 32, 32, 0.5);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .stat { 
            font-weight: bold; 
            font-size: 20px; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .trophy { color: #FFD700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
        .gem { color: #4FC3F7; text-shadow: 0 0 10px rgba(79, 195, 247, 0.5); }
        .crown { color: #FFAA00; text-shadow: 0 0 10px rgba(255, 170, 0, 0.5); }
        
        /* Banners */
        #offerBanner {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 20px;
            position: fixed;
            top: 70px;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        #gemsCountdown {
            display: inline-block;
            background: rgba(0,0,0,0.8);
            color: gold;
            padding: 4px 10px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        #exclusiveBanner {
            background: linear-gradient(135deg, #ff0066 0%, #ff00ff 50%, #ff66cc 100%);
            color: white;
            padding: 16px;
            text-align: center;
            font-weight: bold;
            font-size: 22px;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1001;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            animation: pulseGlow 2s infinite;
        }
        
        @keyframes pulseGlow {
            0% { box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(255,0,255,0.8); }
            50% { box-shadow: 0 8px 16px rgba(0,0,0,0.5), 0 10px 20px rgba(255,0,255,1); }
            100% { box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(255,0,255,0.8); }
        }
        
        #exclusiveCountdown {
            display: inline-block;
            background: rgba(0,0,0,0.8);
            color: #ff00ff;
            padding: 6px 12px;
            border-radius: 10px;
            margin-left: 12px;
            font-size: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        #announcementBanner {
            background: linear-gradient(135deg, #ffd700 0%, #ff8c00 100%);
            color: #333;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            position: fixed;
            top: 130px;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        /* Secciones */
        #deck, #shop, #tournament, #cupMode, #ranking, #achievements, #skinsDuel, #coliseum, #arena { display: none; }
        #deck.active, #shop.active, #tournament.active, #cupMode.active, #ranking.active, #achievements.active, #skinsDuel.active, #coliseum.active, #arena.active { 
            display: block; 
            animation: fadeIn 0.5s ease forwards;
        }
        
        @keyframes fadeIn {
            0% { opacity: 0; transform: translateY(20px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            gap: 16px;
            justify-content: center;
            margin-top: 20px;
        }
        
        .filter-bar { 
            text-align: center; 
            margin-bottom: 20px;
        }
        
        .filter-bar select {
            background: linear-gradient(135deg, rgba(51,51,51,0.9) 0%, rgba(71,71,71,0.9) 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 12px;
            border: 1px solid rgba(85,85,85,0.5);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* Modal */
        #cardModal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            backdrop-filter: blur(5px);
        }
        
        #cardModalContent {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(40, 40, 60, 0.98) 100%);
            border-radius: 24px;
            padding: 40px;
            max-width: 450px;
            text-align: center;
            border: 4px solid rgba(255,215,0,0.5);
            box-shadow: 0 0 50px rgba(255,215,0,0.3), 0 10px 20px rgba(0,0,0,0.5);
            transition: transform 0.5s ease;
        }
        
        #cardModalContent:hover {
            transform: scale(1.02);
        }
        
        #cardModalImage {
            width: 100%;
            max-height: 350px;
            object-fit: cover;
            border-radius: 16px;
            margin-bottom: 24px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.5s ease;
        }
        
        #cardModalImage:hover {
            transform: scale(1.02);
        }
        
        /* Ranking */
        .ranking-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px;
            background: linear-gradient(135deg, rgba(30, 30, 50, 0.8) 0%, rgba(50, 50, 70, 0.8) 100%);
            border-radius: 16px;
            margin-bottom: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: transform 0.3s ease;
        }
        
        .ranking-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .ranking-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px solid gold;
            box-shadow: 0 0 10px rgba(255,215,0,0.3), 0 4px 8px rgba(0,0,0,0.3);
            background-size: cover;
            background-position: center;
        }
        
        /* Batalla */
        #battle {
            display: none;
            padding: 24px;
            padding-bottom: 150px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(20, 20, 20, 0.4) 100%);
            border-radius: 20px;
            margin-top: 24px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        #battle.active { display: block; }
        
        .battle-ia-cards, .battle-player-cards {
            display: flex;
            justify-content: center;
            gap: 24px;
            flex-wrap: wrap;
        }
        
        .ia-card, .player-card {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(30, 30, 30, 0.7) 100%);
            border: 3px solid #d42020;
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            width: 180px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .player-card { 
            border: 3px solid #00bcd4; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .ia-card.selected, .player-card.selected { 
            border-color: yellow;
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4), 0 5px 10px rgba(255, 255, 0, 0.6);
        }
        
        .ia-card:hover, .player-card:hover { 
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        .player-card:hover {
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        .ia-card img, .player-card img {
            width: 100%;
            height: 160px;
            object-fit: cover;
            border-radius: 12px;
            margin-bottom: 12px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .ia-card:hover img, .player-card:hover img {
            transform: scale(1.05);
        }
        
        .name { 
            font-weight: bold; 
            margin: 12px 0; 
            font-size: 18px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .stats { 
            display: flex; 
            justify-content: center; 
            gap: 12px; 
            font-size: 16px; 
            margin: 12px 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        
        .hp-bar { 
            height: 10px; 
            background: linear-gradient(90deg, #333 0%, #222 100%);
            border-radius: 5px; 
            overflow: hidden; 
            margin: 12px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) inset;
        }
        
        .hp-fill { 
            height: 100%; 
            background: linear-gradient(90deg, #d42020 0%, #ff4545 100%);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(212, 32, 32, 0.5);
        }
        
        .hp-text { 
            font-size: 14px; 
            text-align: center; 
            margin-top: 6px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        
        /* Botones de batalla */
        .attack-button, .defend-button {
            background: linear-gradient(135deg, #d42020 0%, #ff4545 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 14px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(212, 32, 32, 0.4);
            margin: 0 12px;
        }
        
        .defend-button { 
            background: linear-gradient(135deg, #00bcd4 0%, #00e5ff 100%);
            box-shadow: 0 4px 8px rgba(0, 188, 212, 0.4);
        }
        
        .attack-button:hover, .defend-button:hover { 
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(212, 32, 32, 0.6);
        }
        
        .defend-button:hover {
            box-shadow: 0 8px 16px rgba(0, 188, 212, 0.6);
        }
        
        .attack-button:active, .defend-button:active {
            transform: translateY(1px);
        }
        
        /* Contenedor de secciones */
        .section-container {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(200, 200, 200, 0.1) 100%);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: transform 0.3s ease;
        }
        
        .section-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        /* Mensaje de batalla */
        #battleMessage {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(30, 30, 30, 0.9) 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            z-index: 2000;
            box-shadow: 0 0 50px rgba(255, 255, 255, 0.5), 0 10px 20px rgba(0, 0, 0, 0.5);
            animation: messageAppear 0.5s ease forwards;
        }
        
        @keyframes messageAppear {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        /* Botones de navegaci√≥n */
        .nav-btn {
            background: linear-gradient(135deg, rgba(100, 100, 100, 0.7) 0%, rgba(120, 120, 120, 0.7) 100%);
            color: white;
            border: 2px solid #555;
            font-weight: bold;
            transition: all 0.3s ease;
            border-radius: 12px;
            padding: 10px 20px;
            margin: 4px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .nav-btn:hover {
            background: linear-gradient(135deg, rgba(200, 200, 200, 0.9) 0%, rgba(220, 220, 220, 0.9) 100%);
            color: black;
            border-color: #fff;
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(240, 240, 240, 0.9) 100%);
            color: black;
            border-color: gold;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(255,215,0,0.5);
        }
        
        /* Contador de colecci√≥n */
        #collectionCounter {
            text-align: center;
            font-size: 22px;
            font-weight: bold;
            margin: 15px 0;
            padding: 12px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.6) 100%);
            border-radius: 12px;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* Cofres */
        .chest-container {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .chest-container:hover {
            transform: translateY(-10px);
        }
        
        .chest {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #333 0%, #444 100%);
            border-radius: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            transition: transform 0.3s ease;
        }
        
        .chest-container:hover .chest {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
        
        .chest-rare { 
            box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(76, 175, 80, 0.6);
        }
        
        .chest-epic { 
            box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(156, 39, 176, 0.6);
        }
        
        .chest-legendary { 
            box-shadow: 0 4px 8px rgba(0,0,0,0.3), 0 5px 10px rgba(255, 152, 0, 0.6);
        }
        
        .chests-grid {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
            margin: 40px 0;
        }
        
        /* Animaciones */
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .blink { animation: blink 1s infinite; }
        
        .attacked {
            animation: hit 0.5s ease;
        }
        
        @keyframes hit {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }
        
        .defended {
            animation: shield 1s ease;
        }
        
        @keyframes shield {
            0% { 
                box-shadow: 0 0 25px rgba(0, 188, 212, 0.6), 0 4px 8px rgba(0,0,0,0.2);
            }
            50% { 
                box-shadow: 0 0 50px rgba(0, 188, 212, 1), 0 10px 20px rgba(0,0,0,0.4);
                transform: scale(1.1);
            }
            100% { 
                box-shadow: 0 0 25px rgba(0, 188, 212, 0.6), 0 4px 8px rgba(0,0,0,0.2);
            }
        }
        
        /* Efectos de fuegos artificiales */
        .firework {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            animation: explode 1s ease-out forwards;
        }
        
        @keyframes explode {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--x), var(--y));
                opacity: 0;
            }
        }
        
        /* Modo Duelo de Skins */
        #skinsDuel {
            padding: 20px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(30, 0, 50, 0.7) 0%, rgba(50, 0, 80, 0.7) 100%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .duel-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .duel-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .duel-stat {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.6) 100%);
            border-radius: 15px;
            width: 45%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .boss-health {
            background: linear-gradient(90deg, #8b0000 0%, #ff0000 100%);
        }
        
        .player-health {
            background: linear-gradient(90deg, #0066cc 0%, #00ccff 100%);
        }
        
        .health-bar {
            height: 20px;
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) inset;
        }
        
        .health-fill {
            height: 100%;
            width: 100%;
            transition: width 0.5s ease;
        }
        
        .cards-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .skin-card {
            background: linear-gradient(135deg, rgba(20, 20, 40, 0.9) 0%, rgba(40, 40, 60, 0.9) 100%);
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .skin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        .skin-card.attack-type {
            border: 2px solid #ff3333;
        }
        
        .skin-card.defense-type {
            border: 2px solid #3366ff;
        }
        
        .skin-card.matched {
            animation: matchedPulse 0.6s ease;
            border-color: #ffff00;
            box-shadow: 0 0 20px rgba(255, 255, 0, 0.8), 0 8px 16px rgba(0,0,0,0.3);
        }
        
        @keyframes matchedPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .skin-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 8px;
        }
        
        .skin-card-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .skin-card-type {
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
            margin-bottom: 5px;
        }
        
        .attack-badge {
            background: linear-gradient(135deg, #ff3333 0%, #ff6666 100%);
            color: white;
        }
        
        .defense-badge {
            background: linear-gradient(135deg, #3366ff 0%, #6699ff 100%);
            color: white;
        }
        
        .skin-card-value {
            font-weight: bold;
            font-size: 16px;
        }
        
        .duel-controls {
            text-align: center;
            margin-top: 20px;
        }
        
        .duel-message {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            min-height: 25px;
            color: #ffff00;
            text-shadow: 0 0 10px rgba(255, 255, 0, 0.5);
        }
        
        .duel-boss {
            text-align: center;
            margin: 20px 0;
        }
        
        .boss-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 15px;
            border: 4px solid #ff3333;
            box-shadow: 0 0 20px rgba(255, 51, 51, 0.6), 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.5s ease;
        }
        
        .boss-image.attacking {
            animation: bossAttack 0.8s ease;
        }
        
        @keyframes bossAttack {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        /* Coliseo de Oro */
        #coliseum {
            padding: 20px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(50, 30, 0, 0.8) 0%, rgba(80, 50, 0, 0.8) 100%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .coliseum-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .coliseum-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .coliseum-stat {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.6) 100%);
            border-radius: 15px;
            width: 45%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .coliseum-health {
            background: linear-gradient(90deg, #8b6914 0%, #ffd700 100%);
        }
        
        .opponent-health {
            background: linear-gradient(90deg, #8b0000 0%, #ff0000 100%);
        }
        
        .coliseum-arena {
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.6) 0%, rgba(205, 133, 63, 0.6) 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            position: relative;
            min-height: 300px;
            overflow: hidden;
        }
        
        .arena-event {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        .lightning {
            position: absolute;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, transparent, #ffffff, transparent);
            animation: lightning 0.5s ease-out;
            opacity: 0.8;
        }
        
        @keyframes lightning {
            0% { opacity: 0; transform: scaleY(0); }
            50% { opacity: 1; transform: scaleY(1); }
            100% { opacity: 0; transform: scaleY(1); }
        }
        
        .gift {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            animation: giftFall 2s ease-in forwards;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
        }
        
        @keyframes giftFall {
            0% { top: -50px; opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { top: 100%; opacity: 0; }
        }
        
        .coliseum-cards {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }
        
        .coliseum-card {
            width: 120px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(30, 30, 30, 0.7) 100%);
            border: 3px solid #ffd700;
            border-radius: 20px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .coliseum-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .coliseum-card.shaking {
            animation: shake 0.5s ease-in-out infinite;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .coliseum-controls {
            text-align: center;
            margin-top: 20px;
        }
        
        .coliseum-message {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            min-height: 25px;
            color: #ffd700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .coliseum-opponent {
            text-align: center;
            margin: 20px 0;
        }
        
        .opponent-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 15px;
            border: 4px solid #ff0000;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.6), 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.5s ease;
        }
        
        .opponent-image.attacking {
            animation: bossAttack 0.8s ease;
        }
        
        .risk-multiplier {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 15px 0;
            color: #ff6600;
            text-shadow: 0 0 10px rgba(255, 102, 0, 0.5);
        }
        
        .risk-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }
        
        .chat-container {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(30, 30, 30, 0.7) 100%);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .chat-message {
            padding: 8px;
            margin-bottom: 5px;
            border-radius: 10px;
            background: rgba(50, 50, 50, 0.5);
        }
        
        .chat-username {
            font-weight: bold;
            color: #4FC3F7;
        }
        
        .spectator-vote {
            display: flex;
            justify-content: space-around;
            margin-top: 10px;
        }
        
        .vote-button {
            background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .vote-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .boss-infiltrated {
            border: 4px solid #ffd700 !important;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.8) !important;
            animation: bossGlow 2s infinite alternate;
        }
        
        @keyframes bossGlow {
            0% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
            100% { box-shadow: 0 0 40px rgba(255, 215, 0, 1); }
        }
        
        .coliseum-reward {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            margin: 15px 0;
            color: #4CAF50;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        
        /* Modo Arena */
        #arena {
            padding: 20px;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(0, 30, 60, 0.8) 0%, rgba(0, 50, 100, 0.8) 100%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .arena-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .arena-stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
        }
        
        .arena-stat {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.6) 100%);
            border-radius: 15px;
            width: 45%;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .arena-rank {
            background: linear-gradient(90deg, #1a237e 0%, #3949ab 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
            font-weight: bold;
            margin-bottom: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .arena-progress {
            background: linear-gradient(90deg, #333 0%, #555 100%);
            border-radius: 10px;
            height: 20px;
            margin: 10px 0;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) inset;
        }
        
        .arena-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50 0%, #8bc34a 100%);
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        
        .arena-progress-text {
            text-align: center;
            font-size: 14px;
            margin-top: 5px;
        }
        
        .arena-battlefield {
            background: linear-gradient(135deg, rgba(25, 25, 50, 0.7) 0%, rgba(40, 40, 80, 0.7) 100%);
            border-radius: 20px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            min-height: 300px;
            position: relative;
        }
        
        .arena-enemy {
            text-align: center;
            margin: 20px 0;
        }
        
        .enemy-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 15px;
            border: 4px solid #ff3333;
            box-shadow: 0 0 20px rgba(255, 51, 51, 0.6), 0 4px 8px rgba(0,0,0,0.3);
            transition: transform 0.5s ease;
        }
        
        .enemy-image.attacking {
            animation: bossAttack 0.8s ease;
        }
        
        .enemy-name {
            font-size: 24px;
            font-weight: bold;
            color: #ff3333;
            text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
        }
        
        .enemy-rank {
            font-size: 16px;
            color: #ffcc00;
            margin-top: 5px;
        }
        
        .arena-cards {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 20px 0;
        }
        
        .arena-card {
            width: 120px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(30, 30, 30, 0.7) 100%);
            border: 3px solid #4caf50;
            border-radius: 20px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }
        
        .arena-card img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        
        .arena-card.shaking {
            animation: shake 0.5s ease-in-out infinite;
        }
        
        .arena-controls {
            text-align: center;
            margin-top: 20px;
        }
        
        .arena-message {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            margin: 15px 0;
            min-height: 25px;
            color: #4caf50;
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        
        .arena-rewards {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.6) 0%, rgba(30, 30, 30, 0.6) 100%);
            border-radius: 15px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
        }
        
        .arena-rewards h3 {
            color: #ffd700;
            margin-bottom: 10px;
        }
        
        .reward-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }
        
        .reward-name {
            color: #ffffff;
        }
        
        .reward-value {
            color: #4caf50;
            font-weight: bold;
        }
        
        .arena-rank-up {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(30, 30, 30, 0.9) 100%);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            z-index: 2000;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5), 0 10px 20px rgba(0, 0, 0, 0.5);
            display: none;
            animation: messageAppear 0.5s ease forwards;
        }
        
        .rank-up-title {
            font-size: 32px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 20px;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
        }
        
        .rank-up-rank {
            font-size: 24px;
            color: #4caf50;
            margin-bottom: 20px;
        }
        
        .rank-up-rewards {
            font-size: 18px;
            color: #ffffff;
            margin-bottom: 20px;
        }
        
        .rank-up-button {
            background: linear-gradient(135deg, #4caf50 0%, #8bc34a 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        
        .rank-up-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.4);
        }
    </style>
</head>
<body>
    <div id="exclusiveBanner">
        üî• ¬°CARTA EXCLUSIVA POR 24 HORAS! üî• BUSTING THE FUCK OUT - LA M√ÅS PODEROSA JAM√ÅS VISTA
        <span id="exclusiveCountdown">1h 0m 0s</span>
    </div>
    <div id="offerBanner">
        üéÅ ¬°OFERTA POR TIEMPO LIMITADO! üíé ¬°1000 GEMAS POR SOLO HOY!
        <span id="gemsCountdown">--h --m --s</span>
    </div>
    <div id="announcementBanner">
        ¬°NUEVA ACTUALIZACI√ìN! YA EST√ÅN DISPONIBLES LOS COFRES EN LA TIENDA üéÅ
    </div>
    <div class="container mx-auto px-4 py-6 pt-32">
        <div class="text-center mb-6">
            <img id="profileAvatar" src="https://rule34.xxx//samples/1888/sample_4387d777c732825ae6e377664c2ce885.jpg?15738037" alt="Avatar" class="w-20 h-20 rounded-full mx-auto border-4 border-red-500 shadow-lg">
            <h2 class="text-2xl font-bold mt-3" id="playerName">Jugador</h2>
        </div>
        <div class="stats-bar">
            <div class="stat"><i class="fas fa-trophy trophy"></i> <span id="trophies">0</span></div>
            <div class="stat"><i class="fas fa-gem gem"></i> <span id="diamonds">100</span></div>
            <div class="stat"><i class="fas fa-crown crown"></i> <span id="cups">0</span></div>
        </div>
        <h1 class="text-4xl font-bold text-center mb-8 text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-green-500">üéÑ FORTNITE: BATALLA NAVIDE√ëA</h1>
        
        <div id="battle" class="active section-container">
            <div class="battle-header">
                <h2 class="text-3xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-red-600">‚öîÔ∏è BATALLA</h2>
                <p class="text-lg">¬°Elige una carta y ataca con estilo navide√±o!</p>
            </div>
            <div class="battle-ia-cards" id="battleIaCards"></div>
            <div class="battle-player-cards" id="battlePlayerCards"></div>
            <div class="text-center mt-4">
                <button class="attack-button" onclick="playerAttack()">üî• ATACAR</button>
                <button class="defend-button" onclick="playerDefend()">üõ°Ô∏è DEFENDER</button>
            </div>
        </div>
        
        <div id="arena" class="section-container">
            <div class="arena-header">
                <h2 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-blue-600">üèüÔ∏è MODO ARENA</h2>
                <p class="text-lg">¬°Un camino de niveles donde cada cinco victorias subes a un rango superior con enemigos m√°s fuertes y mejores premios!</p>
            </div>
            
            <div class="arena-stats">
                <div class="arena-stat">
                    <h3 class="text-xl font-bold text-blue-400">TU RANGO</h3>
                    <div class="arena-rank" id="arenaRank">Rango 1</div>
                    <div class="arena-progress">
                        <div id="arenaProgressFill" class="arena-progress-fill" style="width: 0%"></div>
                    </div>
                    <div id="arenaProgressText" class="arena-progress-text">0 / 5 victorias</div>
                </div>
                
                <div class="arena-stat">
                    <h3 class="text-xl font-bold text-red-400">ENEMIGO</h3>
                    <div class="health-bar">
                        <div id="arenaEnemyHealthBar" class="health-fill boss-health"></div>
                    </div>
                    <div id="arenaEnemyHealthText">100 / 100</div>
                </div>
            </div>
            
            <div class="arena-battlefield" id="arenaBattlefield">
                <div class="arena-enemy">
                    <div id="arenaEnemyImage" class="enemy-image">
                        <img src="https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622" alt="Enemigo" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">
                    </div>
                    <h3 id="arenaEnemyName" class="enemy-name">Guerrero Novato</h3>
                    <div id="arenaEnemyRank" class="enemy-rank">Rango 1</div>
                </div>
                
                <div class="arena-cards" id="arenaCards"></div>
            </div>
            
            <div class="arena-message" id="arenaMessage">Presiona "INICIAR ARENA" para comenzar tu camino</div>
            
            <div class="arena-rewards" id="arenaRewards">
                <h3>Pr√≥ximas Recompensas</h3>
                <div class="reward-item">
                    <span class="reward-name">Gemas por victoria</span>
                    <span class="reward-value" id="gemsPerVictory">10</span>
                </div>
                <div class="reward-item">
                    <span class="reward-name">Recompensa de rango</span>
                    <span class="reward-value" id="rankReward">50 gemas</span>
                </div>
            </div>
            
            <div class="arena-controls">
                <button class="btn bg-blue-600 text-lg px-8 py-3" onclick="startArena()" id="startArenaBtn">INICIAR ARENA</button>
                <button class="btn bg-gray-600 text-lg px-8 py-3" onclick="resetArena()" id="resetArenaBtn" style="display: none;">REINICIAR</button>
            </div>
        </div>
        
        <div id="coliseum" class="section-container">
            <div class="coliseum-header">
                <h2 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-yellow-600">üèüÔ∏è COLISEO DE ORO</h2>
                <p class="text-lg">¬°Elige tus tres mejores cartas y enfr√©ntate a cinco oponentes seguidos!</p>
            </div>
            
            <div class="coliseum-stats">
                <div class="coliseum-stat">
                    <h3 class="text-xl font-bold text-yellow-400">TU SALUD</h3>
                    <div class="health-bar">
                        <div id="coliseumPlayerHealthBar" class="health-fill coliseum-health"></div>
                    </div>
                    <div id="coliseumPlayerHealthText">100 / 100</div>
                </div>
                
                <div class="coliseum-stat">
                    <h3 class="text-xl font-bold text-red-400">OPONENTE</h3>
                    <div class="health-bar">
                        <div id="coliseumOpponentHealthBar" class="health-fill opponent-health"></div>
                    </div>
                    <div id="coliseumOpponentHealthText">100 / 100</div>
                </div>
            </div>
            
            <div class="coliseum-arena" id="coliseumArena">
                <div class="arena-event" id="arenaEvent"></div>
                <div class="coliseum-cards" id="coliseumCards"></div>
            </div>
            
            <div class="coliseum-opponent">
                <div id="coliseumOpponentImage" class="opponent-image">
                    <img src="https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622" alt="Oponente" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">
                </div>
                <h3 id="coliseumOpponentName" class="text-2xl font-bold text-red-500">Oponente 1</h3>
            </div>
            
            <div class="coliseum-message" id="coliseumMessage">Selecciona tus tres mejores cartas para comenzar</div>
            
            <div class="risk-multiplier" id="riskMultiplier" style="display: none;">Multiplicador: x<span id="multiplierValue">1</span></div>
            
            <div class="risk-buttons" id="riskButtons" style="display: none;">
                <button class="btn bg-green-600" onclick="collectWinnings()">Recoger Ganancias</button>
                <button class="btn bg-red-600" onclick="continueBattle()">Continuar</button>
            </div>
            
            <div class="coliseum-reward" id="coliseumReward" style="display: none;"></div>
            
            <div class="coliseum-controls">
                <button class="btn bg-yellow-600 text-lg px-8 py-3" onclick="startColiseum()" id="startColiseumBtn">INICIAR COLISEO (100 gemas)</button>
                <button class="btn bg-gray-600 text-lg px-8 py-3" onclick="resetColiseum()" id="resetColiseumBtn" style="display: none;">REINICIAR</button>
            </div>
            
            <div class="chat-container" id="chatContainer" style="display: none;">
                <h3 class="text-lg font-bold mb-2">Chat de Espectadores</h3>
                <div id="chatMessages"></div>
                <div class="spectator-vote">
                    <span>¬øQui√©n crees que ganar√°?</span>
                    <button class="vote-button" onclick="spectatorVote('player')">Jugador</button>
                    <button class="vote-button" onclick="spectatorVote('opponent')">Oponente</button>
                </div>
            </div>
        </div>
        
        <div id="skinsDuel" class="section-container">
            <div class="duel-header">
                <h2 class="text-3xl font-bold mb-4 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">‚öîÔ∏è DUELO DE SKINS</h2>
                <p class="text-lg">¬°Encuentra parejas de Skins de Ataque para da√±ar al jefe o parejas de Escudos para recuperar vida!</p>
            </div>
            
            <div class="duel-stats">
                <div class="duel-stat">
                    <h3 class="text-xl font-bold text-red-400">JEFE FINAL</h3>
                    <div class="health-bar">
                        <div id="bossHealthBar" class="health-fill boss-health"></div>
                    </div>
                    <div id="bossHealthText">100 / 100</div>
                </div>
                
                <div class="duel-stat">
                    <h3 class="text-xl font-bold text-blue-400">TU VIDA</h3>
                    <div class="health-bar">
                        <div id="playerHealthBar" class="health-fill player-health"></div>
                    </div>
                    <div id="playerHealthText">100 / 100</div>
                </div>
            </div>
            
            <div class="duel-boss">
                <div id="bossImage" class="boss-image">
                    <img src="https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622" alt="Jefe" style="width:100%; height:100%; object-fit:cover; border-radius:50%;">
                </div>
                <h3 class="text-2xl font-bold text-red-500">Furia</h3>
            </div>
            
            <div class="duel-message" id="duelMessage">¬°Encuentra parejas para comenzar el duelo!</div>
            
            <div class="cards-board" id="skinsBoard"></div>
            
            <div class="duel-controls">
                <button class="btn bg-purple-700 text-lg px-8 py-3" onclick="startSkinsDuel()">INICIAR DUELO</button>
                <button class="btn bg-red-700 text-lg px-8 py-3" onclick="resetSkinsDuel()">REINICIAR</button>
            </div>
        </div>
        
        <div id="deck" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600">üé¥ TU MAZO</h2>
            <div id="collectionCounter">Cartas coleccionadas: <span id="collectedCount">0</span> / 62</div>
            <div class="filter-bar">
                <select id="rarityFilter" onchange="renderDeck()">
                    <option value="all">Todas las rarezas</option>
                    <option value="common">Com√∫n</option>
                    <option value="rare">Rara</option>
                    <option value="epic">√âpica</option>
                    <option value="legendary">Legendaria</option>
                    <option value="idolos">√çdolos</option>
                    <option value="tournament">Torneo</option>
                    <option value="paises">Pa√≠ses</option>
                    <option value="animated">Animados</option>
                </select>
            </div>
            <div class="card-grid" id="deckCards"></div>
            <div class="text-center mt-6">
                <button class="btn bg-purple-700" onclick="saveDeck()">üíæ Guardar Mazo</button>
            </div>
        </div>
        <div id="shop" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">üíé TIENDA NAVIDE√ëA</h2>
            <div id="gemsOffer" class="bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-2xl text-center mb-8 mx-auto max-w-3xl animate-pulse shadow-xl">
                <h3 class="text-2xl font-bold text-yellow-300">üî• ¬°OFERTA √öNICA! üî•</h3>
                <p class="text-xl">¬°1000 GEMAS por tiempo limitado!</p>
                <p class="text-md text-yellow-200">Oferta termina en: <span id="shopGemsCountdown">--h --m --s</span></p>
                <button class="btn bg-yellow-500 text-black mt-4" onclick="buyGemsPackage()">Comprar por $4.99</button>
            </div>
            <h3 class="text-3xl font-bold text-center mb-6 text-yellow-300">üéÅ COFRES DISPONIBLES</h3>
            <div class="chests-grid">
                <div class="chest-container" onclick="openChest('rare')">
                    <div class="chest chest-rare">üì¶</div>
                    <p class="text-center mt-4 text-xl font-bold">Cofre Raro<br><span class="text-yellow-300">150 gemas</span><br><small>3-5 cartas (comunes/raras)</small></p>
                </div>
                <div class="chest-container" onclick="openChest('epic')">
                    <div class="chest chest-epic">üì¶</div>
                    <p class="text-center mt-4 text-xl font-bold">Cofre √âpico<br><span class="text-yellow-300">400 gemas</span><br><small>4-6 cartas (raras/√©picas)</small></p>
                </div>
                <div class="chest-container" onclick="openChest('legendary')">
                    <div class="chest chest-legendary">üì¶</div>
                    <p class="text-center mt-4 text-xl font-bold">Cofre Legendario<br><span class="text-yellow-300">800 gemas</span><br><small>5-8 cartas (√©picas+)</small></p>
                </div>
            </div>
            <h3 class="text-3xl font-bold text-center mb-6 text-pink-400">üî• PACKS ESPECIALES</h3>
            <div class="chests-grid">
                <div class="chest-container" onclick="buyAnimatedPack()">
                    <div class="chest" style="background: linear-gradient(#ff1493, #ff69b4); box-shadow: 0 0 40px #ff1493;">üçÜ</div>
                    <p class="text-center mt-4 text-xl font-bold">Pack GIFS ANIMADOS<br><span class="text-yellow-300">3000 gemas</span><br><small>3 Pok√©mon follados animados</small></p>
                </div>
                <div class="chest-container" onclick="buyClassicPack()">
                    <div class="chest" style="background: linear-gradient(#ff69b4, #ff1493); box-shadow: 0 0 40px #ff69b4;">üçë</div>
                    <p class="text-center mt-4 text-xl font-bold">Classic Thicc Pack<br><span class="text-yellow-300">3500 gemas</span><br><small>3 chicas cl√°sicas thicc animadas</small></p>
                </div>
            </div>
            <div class="card-grid" id="shopCards"></div>
        </div>
        <div id="tournament" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6 text-yellow-400">üèÜ TORNEOS DISPONIBLES</h2>
            <div id="tournamentsList" class="flex flex-col gap-8 mx-auto max-w-3xl"></div>
        </div>
        <div id="ranking" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6">üèÜ RANKING GLOBAL</h2>
            <div id="rankingList" class="max-h-96 overflow-y-auto"></div>
        </div>
        <div id="cupMode" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6 text-yellow-500">üèÖ CONSEGUIR COPAS</h2>
            <p class="text-center text-lg mb-6">¬°Gana batallas f√°ciles para obtener copas y desbloquear torneos!</p>
            <div class="text-center">
                <button class="btn bg-yellow-600 text-lg px-8 py-4" onclick="startCupBattle()">Iniciar Batalla por Copas</button>
            </div>
        </div>
        <div id="achievements" class="section-container">
            <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-600">üèÖ LOGROS</h2>
            <div id="achievementsList" class="max-h-96 overflow-y-auto"></div>
        </div>
    </div>
    <div id="cardModal" onclick="closeCardModal()">
        <div id="cardModalContent" onclick="event.stopPropagation()">
            <img id="cardModalImage" src="" alt="Carta" />
            <h2 id="cardModalName" class="text-3xl font-bold"></h2>
            <div id="cardModalRarity" class="font-bold text-xl"></div>
            <div id="cardModalLevel" class="font-bold text-lg mt-2"></div>
            <div id="cardModalStats" class="text-xl mt-4"></div>
            <button class="btn bg-gray-700 mt-6" onclick="closeCardModal()">Cerrar</button>
        </div>
    </div>
    <div id="battleMessage">
        <h2 id="messageText"></h2>
        <button class="btn bg-green-600" onclick="rematch()">REVANCHA</button>
        <button class="btn bg-blue-600" onclick="closeBattleMessage()">Cerrar</button>
    </div>
    <div id="arenaRankUp" class="arena-rank-up">
        <div class="rank-up-title">¬°HAS SUBIDO DE RANGO!</div>
        <div class="rank-up-rank" id="rankUpRank">Rango 2</div>
        <div class="rank-up-rewards" id="rankUpRewards">Has obtenido 50 gemas</div>
        <button class="rank-up-button" onclick="closeRankUp()">Continuar</button>
    </div>
    <div class="fixed bottom-0 left-0 right-0 flex justify-center gap-3 z-10 flex-wrap px-4 py-4 bg-black/50 backdrop-blur-md rounded-t-2xl shadow-lg">
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('battle')">Batalla</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('arena')">Arena</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('coliseum')">Coliseo</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('skinsDuel')">Duelo de Skins</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('deck')">Mazo</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('shop')">Tienda</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('ranking')">Ranking</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('cupMode')">COPAS</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('tournament')">Torneo</button>
        <button class="nav-btn text-sm px-6 py-3" onclick="showView('achievements')">Logros</button>
    </div>
    <script>
        const GEMS_OFFER_END = (function() {
            const now = new Date();
            const endTime = new Date(now);
            endTime.setHours(1, 0, 0, 0);
            if (endTime <= now) endTime.setDate(endTime.getDate() + 1);
            return endTime;
        })();
        const EXCLUSIVE_END = new Date('2025-12-16T01:00:00');
        const SABRINA_START = new Date('2025-12-14T15:00:00');
        const CARMELA_AVAILABLE = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() + 1, 1, 0, 0);
        const DECK_MAX_SIZE = 3;
        const MAX_LEVEL = 100;
        const UPGRADE_COST_BASE = 50;
        const ARENA_RANKS = [
            { name: "Rango 1", enemyName: "Guerrero Novato", enemyMultiplier: 1, gemsPerVictory: 10, rankReward: 50 },
            { name: "Rango 2", enemyName: "Luchador Experimentado", enemyMultiplier: 1.2, gemsPerVictory: 15, rankReward: 75 },
            { name: "Rango 3", enemyName: "Campe√≥n Regional", enemyMultiplier: 1.5, gemsPerVictory: 20, rankReward: 100 },
            { name: "Rango 4", enemyName: "Maestro de Batalla", enemyMultiplier: 1.8, gemsPerVictory: 25, rankReward: 150 },
            { name: "Rango 5", enemyName: "Leyenda Arena", enemyMultiplier: 2.2, gemsPerVictory: 30, rankReward: 200 },
            { name: "Rango 6", enemyName: "Tit√°n Imbatible", enemyMultiplier: 2.7, gemsPerVictory: 40, rankReward: 300 },
            { name: "Rango 7", enemyName: "Destructor de Mundos", enemyMultiplier: 3.5, gemsPerVictory: 50, rankReward: 500 },
            { name: "Rango 8", enemyName: "Dios de la Guerra", enemyMultiplier: 4.5, gemsPerVictory: 75, rankReward: 750 },
            { name: "Rango 9", enemyName: "Ser Supremo", enemyMultiplier: 6, gemsPerVictory: 100, rankReward: 1000 },
            { name: "Rango 10", enemyName: "Invencible", enemyMultiplier: 8, gemsPerVictory: 150, rankReward: 2000 }
        ];
        const ALL_CARDS = [
            { id: 0, name: "Ram√≠rez", rarity: "common", baseAtk: 60, baseDef: 50, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", shopPrice: 50 },
            { id: 1, name: "Fortaleza", rarity: "rare", baseAtk: 60, baseDef: 70, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", shopPrice: 100 },
            { id: 2, name: "Escudera", rarity: "common", baseAtk: 55, baseDef: 65, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", shopPrice: 50 },
            { id: 3, name: "Azulita", rarity: "rare", baseAtk: 70, baseDef: 55, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", shopPrice: 80 },
            { id: 4, name: "Tormenta", rarity: "epic", baseAtk: 80, baseDef: 45, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", shopPrice: 120 },
            { id: 5, name: "Furia", rarity: "legendary", baseAtk: 90, baseDef: 40, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", shopPrice: 200 },
            { id: 6, name: "Asesina", rarity: "legendary", baseAtk: 95, baseDef: 30, level: 1, img: "https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", shopPrice: 250 },
            { id: 7, name: "Francine Smith", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://wimg.rule34.xxx//images/1888/0334e8239c387a302348c01810815aef.jpeg?15738062", shopPrice: 1000 },
            { id: 11, name: "Campe√≥n Sombra", rarity: "tournament", baseAtk: 140, baseDef: 100, level: 1, img: "https://s100.erome.com/2418/B2TgruwR/61zc8Veb.png?v=1712563892", shopPrice: null },
            { id: 12, name: "Maestro del Fuego", rarity: "tournament", baseAtk: 150, baseDef: 90, level: 1, img: "https://s326.erome.com/5139/YBnb1NTO/pN2evqNZ.jpeg?v=1750357395", shopPrice: null },
            { id: 13, name: "Rey del Hielo", rarity: "tournament", baseAtk: 135, baseDef: 110, level: 1, img: "https://s10.erome.com/6694/EUAdAxk1/1zdVPLQh.jpeg?v=1764732026", shopPrice: null },
            { id: 14, name: "Felina", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2288/sample_ce3c07d28a9fdd2475d6fc67df8ff4e4.jpg?15302020", shopPrice: 300 },
            { id: 16, name: "Serenade", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/3001/sample_59915a49be3c0b2a86030615f562d3c1.jpg?15147757", shopPrice: 700 },
            { id: 17, name: "Cammy and Chun-Li", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/714/sample_799c5e73f8d6f088e9a1930fe6d3f791.jpg?15175590", shopPrice: 700 },
            { id: 18, name: "Briar", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2510/sample_ea2393689e00c9127748cc78a08ef6b5.jpg?15205865", shopPrice: 700 },
            { id: 19, name: "Torrenta", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/1506/sample_b060c3279b1a9b0a7da0e19bb15fa2d5.jpg?15273482", shopPrice: 700 },
            { id: 20, name: "Siren", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/1766/sample_0e848cee467407d1da3fd407bbf6e484.jpg?15276598", shopPrice: 700 },
            { id: 21, name: "Sabrina Carpente La Diva", rarity: "idolos", baseAtk: 120, baseDef: 80, level: 1, img: "https://i.pinimg.com/736x/4d/c9/b3/4dc9b3acdf2ab04c3c783d3fb2730a0c.jpg", shopPrice: 2000 },
            { id: 22, name: "Carmela", rarity: "paises", baseAtk: 100, baseDef: 60, level: 1, img: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", shopPrice: 500 },
            { id: 23, name: "Amy Wong Thicc", rarity: "epic", baseAtk: 88, baseDef: 55, level: 1, img: "https://rule34.xxx//samples/2701/sample_eae1882d43a188cdcbb129ca7ad3e12e.jpg?14901475", shopPrice: 400 },
            { id: 24, name: "Neon Strike", rarity: "epic", baseAtk: 90, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/902/sample_2e1d3d88982219e96d1bb68453e57b27.jpg?14884672", shopPrice: 450 },
            { id: 25, name: "Beach Rebel", rarity: "epic", baseAtk: 85, baseDef: 60, level: 1, img: "https://rule34.xxx//samples/2019/sample_fd1e4fb4f37cab745ed074ee637ee911.jpg?14877326", shopPrice: 500 },
            { id: 26, name: "Panda Girl", rarity: "epic", baseAtk: 82, baseDef: 58, level: 1, img: "https://rule34.xxx//samples/1674/sample_9c2a1dc61194fef31518afef6288438d.jpg?14876583", shopPrice: 550 },
            { id: 27, name: "Beach Blonde", rarity: "epic", baseAtk: 92, baseDef: 48, level: 1, img: "https://rule34.xxx//samples/890/sample_ce7401fb27ce9a94e218feb294e9d107.jpg?14851213", shopPrice: 600 },
            { id: 28, name: "Wonder Slut", rarity: "epic", baseAtk: 95, baseDef: 45, level: 1, img: "https://rule34.xxx//samples/890/sample_5007ec807529d5075eebb9fc67df9f09.jpg?14851228", shopPrice: 650 },
            { id: 29, name: "Samurai Blue", rarity: "epic", baseAtk: 87, baseDef: 62, level: 1, img: "https://wimg.rule34.xxx//images/2149/86cb609ba898ff4285cfe105c5237f1a.png?14777959", shopPrice: 700 },
            { id: 30, name: "Pink Facesit", rarity: "epic", baseAtk: 80, baseDef: 65, level: 1, img: "https://rule34.xxx//samples/1545/sample_6ebdf1e38f29cb2e1d1cda76622fea1c.jpg?14763252", shopPrice: 750 },
            { id: 31, name: "D.Va & Uraraka", rarity: "epic", baseAtk: 93, baseDef: 52, level: 1, img: "https://rule34.xxx//samples/2122/sample_cadb0b375ac7de3414d0db39d552e7d4.jpg?14666699", shopPrice: 800 },
            { id: 32, name: "Laguna", rarity: "epic", baseAtk: 89, baseDef: 55, level: 1, img: "https://rule34.xxx//samples/842/sample_727d3f80cc43d197f3977fb5c9dfdc22.jpg?14662037", shopPrice: 850 },
            { id: 33, name: "Facesit Dominatrix", rarity: "epic", baseAtk: 94, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2314/sample_6bdcff4bfa032aed2751a5370a24cf05.jpg?14637455", shopPrice: 900 },
            { id: 34, name: "LolaLolita", rarity: "idolos", baseAtk: 140, baseDef: 90, level: 1, img: "https://s204.erome.com/2280/sMLLJHdM/kYJtDcuQ.jpeg?v=1709700685", shopPrice: 2500 },
            { id: 35, name: "DemonMika", rarity: "idolos", baseAtk: 145, baseDef: 85, level: 1, img: "https://s206.erome.com/3439/knzX8RV6/qi2fnmtw.jpeg?v=1730822823", shopPrice: 2800 },
            { id: 36, name: "Alejandra", rarity: "idolos", baseAtk: 150, baseDef: 100, level: 1, img: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", shopPrice: 3000 },
            { id: 37, name: "Mu√±eca Simpsons", rarity: "legendary", baseAtk: 115, baseDef: 75, level: 1, img: "https://wimg.rule34.xxx/images/1370/e31706328b6ffa7e207dbb2df991f116.gif", shopPrice: 1500 },
            { id: 38, name: "Princesa Peach", rarity: "legendary", baseAtk: 130, baseDef: 85, level: 1, img: "https://files.catbox.moe/0k9j2p.gif", shopPrice: 2000 },
            { id: 39, name: "Braixen Thicc Rider", rarity: "animated", baseAtk: 140, baseDef: 90, level: 1, img: "https://wimg.rule34.xxx/images/1620/752edf7523feb1cfac185fd1cf2a0785.gif", shopPrice: null },
            { id: 40, name: "Espeon Gym Thrust", rarity: "animated", baseAtk: 145, baseDef: 85, level: 1, img: "https://wimg.rule34.xxx/images/617/c15df1e76636ca51743b135ad3817685.gif", shopPrice: null },
            { id: 41, name: "Sylveon Forest Bounce", rarity: "animated", baseAtk: 135, baseDef: 95, level: 1, img: "https://wimg.rule34.xxx/images/701/e6fb4ba874eced64a960455ed6c03770.gif", shopPrice: null },
            { id: 42, name: "Otaku Girl", rarity: "animated", baseAtk: 500, baseDef: 120, level: 1, img: "https://wimg.rule34.xxx/images/3636/2238fbcefc001a701fe5e1f8c5236fe5.gif", shopPrice: 1800 },
            { id: 43, name: "Belle Beast Ride", rarity: "animated", baseAtk: 150, baseDef: 90, level: 1, img: "https://cdn2.hentaigifz.com/116588/belle-from-beauty-and-the-beast-scaled.webp", shopPrice: null },
            { id: 44, name: "Emo Bad Belle", rarity: "animated", baseAtk: 140, baseDef: 95, level: 1, img: "https://cdn2.hentaigifz.com/116536/emo-scaled.webp", shopPrice: null },
            { id: 45, name: "Betty Boop Tease", rarity: "animated", baseAtk: 145, baseDef: 85, level: 1, img: "https://cdn2.hentaigifz.com/116498/betty-boop-scaled.webp", shopPrice: null },
            { id: 46, name: "Dexter's Mom Beach", rarity: "animated", baseAtk: 1200, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116308/dm-scaled.webp", shopPrice: 2500 },
            { id: 47, name: "Keqing Thicc Ride", rarity: "animated", baseAtk: 1200, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116288/hentai-scaled.webp", shopPrice: 2500 },
            { id: 48, name: "Leona Gym Thrust", rarity: "animated", baseAtk: 1200, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116388/tmr-scaled.webp", shopPrice: 2500 },
            { id: 49, name: "Strange Hero Facesit", rarity: "animated", baseAtk: 1200, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116364/strangeh-scaled.webp", shopPrice: 2500 },
            { id: 50, name: "Busting The Fuck Out", rarity: "animated", baseAtk: 5000, baseDef: 2500, level: 1, img: "https://cdn2.hentaigifz.com/115480/busting-the-fuck-out-scaled.webp", shopPrice: 5000 },
            { id: 51, name: "Motoko Kusanagi Ride", rarity: "animated", baseAtk: 1600, baseDef: 1100, level: 1, img: "https://cdn2.hentaigifz.com/114768/fantasy-fuck-scaled.webp", shopPrice: 2800 },
            { id: 52, name: "Nezuko Asshole Fuck", rarity: "animated", baseAtk: 1700, baseDef: 1050, level: 1, img: "https://cdn2.hentaigifz.com/114338/id-fuck-the-hell-out-of-nezukos-asshole-scaled.webp", shopPrice: 2900 },
            { id: 53, name: "Eirin Yagokoro Dildo", rarity: "animated", baseAtk: 1550, baseDef: 1150, level: 1, img: "https://cdn2.hentaigifz.com/115486/bucketheadero-eirin-yagokoro-touhou-scaled.webp", shopPrice: 2700 },
            { id: 54, name: "Jessie Ass Throw", rarity: "animated", baseAtk: 1650, baseDef: 1200, level: 1, img: "https://cdn2.hentaigifz.com/115328/jessie-throwing-that-ass-way-out-scaled.webp", shopPrice: 2850 },
            { id: 55, name: "Raven Big Ass", rarity: "animated", baseAtk: 1800, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/115298/raven-big-ass-scaled.webp", shopPrice: 3000 },
            { id: 56, name: "Strapon Futa", rarity: "animated", baseAtk: 1750, baseDef: 1080, level: 1, img: "https://cdn2.hentaigifz.com/115150/strapon-scaled.webp", shopPrice: 2950 },
            { id: 57, name: "Bubblegum Tit Shake", rarity: "animated", baseAtk: 1500, baseDef: 1300, level: 1, img: "https://cdn2.hentaigifz.com/115728/by-dabbledraws-bubblegum-shakes-her-huge-tits-scaled.webp", shopPrice: 2600 },
            { id: 58, name: "Vinyl Luna Smirk", rarity: "animated", baseAtk: 1680, baseDef: 1120, level: 1, img: "https://cdn2.hentaigifz.com/115614/smirk-scaled.webp", shopPrice: 2880 },
            { id: 59, name: "Best Nelson Ride", rarity: "animated", baseAtk: 1900, baseDef: 950, level: 1, img: "https://cdn2.hentaigifz.com/115978/best-nelson-scaled.webp", shopPrice: 3100 },
            { id: 60, name: "Dragon Momma Slut", rarity: "animated", baseAtk: 2000, baseDef: 900, level: 1, img: "https://cdn2.hentaigifz.com/116346/dragon-momma-slut-chelodoy-scaled.webp", shopPrice: 3200 },
            { id: 61, name: "Samantha Bounce", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113850/gif-samantha-1-scaled.webp", shopPrice: 4000 },
            { id: 62, name: "Tracer Riding", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113896/tracer-ridingirastris-ii-scaled.webp", shopPrice: 4000 },
            { id: 63, name: "Jane Jetson MILF", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114176/milf-scaled.webp", shopPrice: 4000 },
            { id: 64, name: "Blonde Ahegao", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114102/blonde-scaled.webp", shopPrice: 4000 },
            { id: 65, name: "Mommy's Milk", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114104/mommys-milk-scaled.webp", shopPrice: 4000 },
            { id: 66, name: "Modeus Tight Fuck", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114096/hentai-fuck-tight-pussy-with-big-tits-scaled.webp", shopPrice: 4000 },
            { id: 67, name: "Family Guy XXXmas", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114026/holy-crap-xxxmas-scaled.webp", shopPrice: 4000 },
            { id: 68, name: "Harness Pussy Fuck", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114034/pussy-hentai-fuck-scaled.webp", shopPrice: 4000 },
            { id: 69, name: "Lisa Footjob", rarity: "legendary", baseAtk: 105, baseDef: 60, level: 1, img: "https://cdn.truyen-hentai.com/lisa-genshin-impact?interlace=1&quality=90&type=jpeg&url=https%3A%2F%2Fi.redd.it%2F2rhrtyfu486g1.jpeg&width=920&sign=fT55BfklnZBR2KbkAiywdF3fKOyO99UCruuDvfceJcs", shopPrice: 500 },
            { id: 71, name: "Susan Long MILF", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116566/hentai-milf-susan-long-american-dragon-jake-long-scaled.webp", shopPrice: 3000 },
            { id: 72, name: "TMR Thicc", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116442/tmr-scaled.webp", shopPrice: 3000 },
            { id: 73, name: "Jinx League of Legends", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/3971/sample_2da1c8ff33fe588f243910961ed11a06.jpg?13091729", shopPrice: 1200 },
            { id: 74, name: "Ahri Fox Legend", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/2954/sample_2386105dbcb97ac0248cc3ea8500b84a.jpg?13155724", shopPrice: 1200 },
            { id: 75, name: "Seraphine Popstar", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/4746/sample_37fa548a5434c088e9a1930fe6d3f791.jpg?13157246", shopPrice: 1200 },
            { id: 76, name: "Sonia Pokemon Thicc", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/3480/sample_bcffd58f4d3323097bff61a131fefcf7.jpg?13212611", shopPrice: 1200 },
            { id: 77, name: "Eula Genshin Impact", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://wimg.rule34.xxx//images/1177/99745673e25c63e0080cf6ddcf048f56.png?13214170", shopPrice: 1200 },
            { id: 78, name: "Noelle Genshin Thicc", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/1177/sample_07014603b1bc2a1ee520415c2ce8bd60.jpg?13214737", shopPrice: 1200 },
            { id: 79, name: "Gwen Spider Thicc", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/139/sample_c4fd8a7f5d51c72b9fc2b5136650e90c.jpg?15817313", shopPrice: 1200 },
            { id: 80, name: "Starfire Teen Titans", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/368/sample_8237312d0b56c4a8bcd6b0f4b287c6da3b16140a.jpg?15828521", shopPrice: 1200 },
            { id: 81, name: "Raven Teen Titans Slut", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/3787/sample_46e881b34ef3f92e8a012f9d2d351e28.jpg?15825868", shopPrice: 1200 },
            { id: 82, name: "Robin Teen Titans Thicc", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://rule34.xxx//samples/1227/sample_4af1e5c47506f9fbbe762fb71a2c3395.jpg?15824410", shopPrice: 1200 },
            { id: 83, name: "Big Tit Teen Fucking", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116478/big-tit-teen-fucking-scaled.webp", shopPrice: 3000 },
            { id: 84, name: "Sekis Thicc", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116488/sekis-scaled.webp", shopPrice: 3000 },
            { id: 85, name: "Hentai Ride Animated", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116444/hentai-scaled.webp", shopPrice: 3000 },
            { id: 86, name: "Big Tits Hentai Gif", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116430/big-tits-hentai-gif-scaled.webp", shopPrice: 3000 },
            { id: 87, name: "Babe Animated", rarity: "animated", baseAtk: 1600, baseDef: 1000, level: 1, img: "https://cdn2.hentaigifz.com/116376/babe-scaled.webp", shopPrice: 3000 },
            { id: 88, name: "Rosal√≠a Motomami", rarity: "idolos", baseAtk: 155, baseDef: 105, level: 1, img: "https://media.vogue.es/photos/6282929aebc8221f41f20a50/2:3/w_1920,c_limit/SHOT_02_090_FINAL.jpg", shopPrice: 3200 },
            { id: 89, name: "Mmm Animated", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114202/mmm-scaled.webp", shopPrice: 5500 },
            { id: 90, name: "Eighty-Five Animated", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114046/85-scaled.webp", shopPrice: 5500 },
            { id: 91, name: "Princess Peach Tit Bounce", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114432/princess-peach-bouncing-them-titties-scaled.webp", shopPrice: 5500 },
            { id: 92, name: "Demon Princess Meaty", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114680/demon-princess-fucking-a-meaty-cock-scaled.webp", shopPrice: 5500 },
            { id: 93, name: "Nice Ass Fuck Animated", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/114454/nice-ass-fuck-scaled.webp", shopPrice: 5500 },
            { id: 94, name: "Automatass Animated", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/115204/automatass-scaled.webp", shopPrice: 5500 },
            { id: 95, name: "2B Perfect Ass Doggy", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/112817/2b-perfect-ass-doggy-style-3d-hentai-scaled.webp", shopPrice: 5500 },
            { id: 96, name: "Green Slime Cum Clothes", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/112481/green-slime-turns-clothes-to-cum-scaled.webp", shopPrice: 5500 },
            { id: 97, name: "Ass Animated Thicc", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113095/ass-scaled.webp", shopPrice: 5500 },
            { id: 98, name: "Widowmaker Animated", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113718/widowmaker-scaled.webp", shopPrice: 5500 },
            { id: 99, name: "Futa Madmew Redapple2", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113534/futa-madmew-by-redapple2-scaled.webp", shopPrice: 5500 },
            { id: 100, name: "Tifa Blacked 3", rarity: "animated", baseAtk: 10000, baseDef: 5000, level: 1, img: "https://cdn2.hentaigifz.com/113370/tifa-blacked-3-scaled.webp", shopPrice: 5500 },
            { id: 101, name: "Milf Handjob Wet", rarity: "actricesporno", baseAtk: 12000, baseDef: 6000, level: 1, img: "https://s2.pictoa.com/media/galleries/269/410/269410603155505d89c/393371260315552a7156.gif", shopPrice: 7000 }
        ];
        const TOURNAMENTS = [
            { id: 1, name: "Torneo Navide√±o", cost: 1, trophies: 500, diamonds: 200, cards: [7, 11, 12, 13], description: "¬°Regalo navide√±o! Gana Francine Smith y cartas de torneo.", image: "https://wimg.rule34.xxx//images/1888/0334e8239c387a302348c01810815aef.jpeg?15738062", iaDeck: [0,1,2] },
            { id: 2, name: "Torneo Principiante", cost: 0, trophies: 100, diamonds: 50, cards: [3, 4], description: "Para nuevos jugadores.", image: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", iaDeck: [0,2,3] },
            { id: 3, name: "Torneo √âpico", cost: 3, trophies: 300, diamonds: 150, cards: [14, 16, 18], description: "Cartas √©picas exclusivas.", image: "https://rule34.xxx//samples/2288/sample_ce3c07d28a9fdd2475d6fc67df8ff4e4.jpg?15302020", iaDeck: [4,14,16] },
            { id: 4, name: "Torneo Legendario", cost: 5, trophies: 1000, diamonds: 300, cards: [5, 6], description: "Recompensas legendarias.", image: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", iaDeck: [5,6,7] },
            { id: 5, name: "Torneo Ex√≥tico", cost: 7, trophies: 1500, diamonds: 500, cards: [17], description: "Gana cartas ex√≥ticas.", image: "https://rule34.xxx//samples/714/sample_799c5e73f8d6f088e9a1930fe6d3f791.jpg?15175590", iaDeck: [17,18,19] },
            { id: 6, name: "Torneo Sabrina", cost: 5, trophies: 800, diamonds: 250, cards: [21], description: "¬°Gana a Sabrina!", image: "https://i.pinimg.com/736x/4d/c9/b3/4dc9b3acdf2ab04c3c783d3fb2730a0c.jpg", iaDeck: [20,21,0] },
            { id: 7, name: "Torneo de √çdolos: LolaLolita", cost: 10, trophies: 2000, diamonds: 800, cards: [34], description: "¬°Desaf√≠o extremo! Enfrenta a la IA m√°s fuerte por LolaLolita.", image: "https://s204.erome.com/2280/sMLLJHdM/kYJtDcuQ.jpeg?v=1709700685", iaDeck: [5,6,7,11,12], iaMultiplier: 8 },
            { id: 8, name: "Torneo de √çdolos: DemonMika", cost: 12, trophies: 2500, diamonds: 1000, cards: [35], description: "¬°Peligro m√°ximo! Solo los mejores ganar√°n a DemonMika.", image: "https://s206.erome.com/3439/knzX8RV6/qi2fnmtw.jpeg?v=1730822823", iaDeck: [6,7,11,12,13], iaMultiplier: 9 },
            { id: 9, name: "Torneo de √çdolos: Alejandra", cost: 15, trophies: 3000, diamonds: 1200, cards: [36], description: "¬°El desaf√≠o definitivo! Derrota a la IA invencible por Alejandra.", image: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", iaDeck: [7,11,12,13,5], iaMultiplier: 10 },
            { id: 10, name: "Torneo Animado", cost: 8, trophies: 1200, diamonds: 400, cards: [39,40,41], description: "¬°Enfrenta cartas animadas exclusivas!", image: "https://wimg.rule34.xxx/images/1620/752edf7523feb1cfac185fd1cf2a0785.gif", iaDeck: [42,43,44,45], iaMultiplier: 5 },
            { id: 11, name: "Torneo Thicc Legends", cost: 10, trophies: 1800, diamonds: 600, cards: [46,47,48], description: "¬°Batallas con legends thicc!", image: "https://cdn2.hentaigifz.com/116308/dm-scaled.webp", iaDeck: [46,47,48,49], iaMultiplier: 7 },
            { id: 12, name: "Torneo Exclusivo", cost: 15, trophies: 2500, diamonds: 1000, cards: [50,55,60], description: "¬°Evento especial por tiempo limitado!", image: "https://cdn2.hentaigifz.com/115480/busting-the-fuck-out-scaled.webp", iaDeck: [50,51,52,53,54,55], iaMultiplier: 10 }
        ];
        const ACHIEVEMENTS = [
            { id: 0, name: "Primera Victoria", description: "Gana tu primera batalla", icon: "üèÜ" },
            { id: 1, name: "Coleccionista", description: "Obt√©n 5 cartas diferentes", icon: "üìö" },
            { id: 2, name: "Mejorador", description: "Sube una carta al nivel 5", icon: "‚¨ÜÔ∏è" },
            { id: 3, name: "Torneo Iniciado", description: "Participa en tu primer torneo", icon: "üéØ" },
            { id: 4, name: "Campe√≥n de Torneo", description: "Gana un torneo", icon: "üëë" },
            { id: 5, name: "Gastador", description: "Gasta 500 gemas", icon: "üí∏" },
            { id: 6, name: "Invicto", description: "Consigue una racha de 10 victorias", icon: "üî•" },
            { id: 7, name: "Duelo de Skins", description: "Juega tu primera partida de Duelo de Skins", icon: "‚öîÔ∏è" },
            { id: 8, name: "Gran Gastador", description: "Gasta 5000 gemas", icon: "üí∞" },
            { id: 9, name: "Maestro de Mejoras", description: "Sube una carta al nivel 20", icon: "üîß" },
            { id: 10, name: "Cazador de Cofres", description: "Abre 20 cofres", icon: "üì¶" },
            { id: 11, name: "Maestro de Mejoras Extremo", description: "Sube una carta al nivel 50", icon: "‚ö°" },
            { id: 12, name: "Exclusivo", description: "Obt√©n la carta Busting The Fuck Out", icon: "üåü" },
            { id: 13, name: "Inversor", description: "Gasta 10000 gemas", icon: "üíé" },
            { id: 14, name: "Coleccionista Completo", description: "Obt√©n todas las cartas del juego", icon: "üé¥" },
            { id: 15, name: "Thicc Invicto", description: "Consigue una racha de 5 victorias con mazo thicc", icon: "üçë" },
            { id: 16, name: "Asesino", description: "Derrota a 50 enemigos", icon: "‚ö∞Ô∏è" },
            { id: 17, name: "Coleccionista de Packs", description: "Compra 2 packs especiales", icon: "üéÅ" },
            { id: 18, name: "Millonario", description: "Gasta 20000 gemas", icon: "ü§ë" },
            { id: 19, name: "Explorador", description: "Usa todas las cartas al menos una vez", icon: "üîç" },
            { id: 20, name: "Maestro Absoluto", description: "Completa todos los torneos y obt√©n todas las cartas", icon: "üë®‚Äçüéì" },
            { id: 21, name: "Domina el Duelo", description: "Gana 5 partidas de Duelo de Skins", icon: "üéÆ" },
            { id: 22, name: "Cazador de Jefes", description: "Derrota al jefe en Duelo de Skins sin perder vida", icon: "üëπ" },
            { id: 23, name: "Coliseo Novato", description: "Juega tu primera partida en el Coliseo de Oro", icon: "üèüÔ∏è" },
            { id: 24, name: "Campe√≥n del Coliseo", description: "Completa los 5 oponentes del Coliseo de Oro", icon: "ü•á" },
            { id: 25, name: "Afortunado", description: "Gana 500 gemas en una sola partida del Coliseo", icon: "üçÄ" },
            { id: 26, name: "Osado", description: "Llega al multiplicador x5 en el Coliseo de Oro", icon: "üí•" },
            { id: 27, name: "Cazador de Jefes Infiltrados", description: "Derrota a un jefe infiltrado en el Coliseo de Oro", icon: "üëë" },
            { id: 28, name: "Gladiador Novato", description: "Juega tu primera partida en el Modo Arena", icon: "‚öîÔ∏è" },
            { id: 29, name: "Ascendente", description: "Sube al Rango 3 en el Modo Arena", icon: "üìà" },
            { id: 30, name: "Campe√≥n de Arena", description: "Sube al Rango 5 en el Modo Arena", icon: "üèÜ" },
            { id: 31, name: "Leyenda de Arena", description: "Sube al Rango 10 en el Modo Arena", icon: "üëë" },
            { id: 32, name: "Invicto Arena", description: "Consigue 10 victorias seguidas en el Modo Arena", icon: "üî•" },
            { id: 33, name: "Cosechador de Gemas", description: "Recolecta 1000 gemas en el Modo Arena", icon: "üíé" }
        ];
        let gameState = {
            playerName: localStorage.getItem('playerName') || 'Jugador',
            trophies: parseInt(localStorage.getItem('trophies') || '0'),
            diamonds: parseInt(localStorage.getItem('diamonds') || '100'),
            cups: parseInt(localStorage.getItem('cups') || '0'),
            avatar: localStorage.getItem('playerAvatar') || 'https://rule34.xxx//samples/1888/sample_4387d777c732825ae6e377664c2ce885.jpg?15738037',
            ownedCardIds: JSON.parse(localStorage.getItem('ownedCardIds') || '[0,1,2]'),
            cardUpgrades: JSON.parse(localStorage.getItem('cardUpgrades') || '{}'),
            currentDeck: JSON.parse(localStorage.getItem('currentDeck') || '[0,1,2]'),
            completedTournaments: JSON.parse(localStorage.getItem('completedTournaments') || '[]'),
            achievements: JSON.parse(localStorage.getItem('achievements') || '[]'),
            spentDiamonds: parseInt(localStorage.getItem('spentDiamonds') || '0'),
            winStreak: parseInt(localStorage.getItem('winStreak') || '0'),
            totalChestsOpened: parseInt(localStorage.getItem('totalChestsOpened') || '0'),
            totalEnemyKills: parseInt(localStorage.getItem('totalEnemyKills') || '0'),
            packsBoughtCount: parseInt(localStorage.getItem('packsBoughtCount') || '0'),
            allCardsUsed: new Set(JSON.parse(localStorage.getItem('allCardsUsed') || '[]')),
            specialSpend: parseInt(localStorage.getItem('specialSpend') || '0'),
            winStreakThicc: parseInt(localStorage.getItem('winStreakThicc') || '0'),
            skinsDuelWins: parseInt(localStorage.getItem('skinsDuelWins') || '0'),
            skinsDuelPerfectWins: parseInt(localStorage.getItem('skinsDuelPerfectWins') || '0'),
            coliseumWins: parseInt(localStorage.getItem('coliseumWins') || '0'),
            coliseumBestMultiplier: parseInt(localStorage.getItem('coliseumBestMultiplier') || '1'),
            coliseumBossDefeated: JSON.parse(localStorage.getItem('coliseumBossDefeated') || '[]'),
            // Arena mode state
            arenaRank: parseInt(localStorage.getItem('arenaRank') || '0'),
            arenaProgress: parseInt(localStorage.getItem('arenaProgress') || '0'),
            arenaTotalWins: parseInt(localStorage.getItem('arenaTotalWins') || '0'),
            arenaTotalGems: parseInt(localStorage.getItem('arenaTotalGems') || '0'),
            arenaWinStreak: parseInt(localStorage.getItem('arenaWinStreak') || '0')
        };
        
        // Variables para el modo Duelo de Skins
        let skinsDuelState = {
            active: false,
            playerHealth: 100,
            bossHealth: 100,
            maxPlayerHealth: 100,
            maxBossHealth: 100,
            cards: [],
            selectedCard: null,
            matchedPairs: 0,
            bossAttackInterval: null,
            boardSize: 12
        };
        
        // Variables para el modo Coliseo de Oro
        let coliseumState = {
            active: false,
            playerHealth: 100,
            maxPlayerHealth: 100,
            opponentHealth: 100,
            maxOpponentHealth: 100,
            currentOpponent: 0,
            maxOpponents: 5,
            playerCards: [],
            opponentCards: [],
            multiplier: 1,
            baseReward: 50,
            battleInterval: null,
            eventInterval: null,
            isBossInfiltrated: false,
            spectatorMode: false,
            votes: { player: 0, opponent: 0 }
        };
        
        // Variables para el modo Arena
        let arenaState = {
            active: false,
            playerHealth: 100,
            maxPlayerHealth: 100,
            enemyHealth: 100,
            maxEnemyHealth: 100,
            playerCards: [],
            enemyCards: [],
            battleInterval: null,
            currentEnemy: null,
            rank: 0,
            progress: 0,
            winsInRank: 0,
            winsNeededForRankUp: 5
        };
        
        function applyCardUpgrades() {
            ALL_CARDS.forEach(card => {
                const level = gameState.cardUpgrades[card.id] || 1;
                card.level = level;
                card.atk = card.baseAtk + (level - 1) * 10;
                card.def = card.baseDef + (level - 1) * 8;
            });
        }
        applyCardUpgrades();
        function updateUI() {
            document.getElementById('playerName').textContent = gameState.playerName;
            document.getElementById('profileAvatar').src = gameState.avatar;
            document.getElementById('trophies').textContent = gameState.trophies;
            document.getElementById('diamonds').textContent = gameState.diamonds;
            document.getElementById('cups').textContent = gameState.cups;
            updateRanking();
            updateCollectionCounter();
        }
        function updateCollectionCounter() {
            const collected = gameState.ownedCardIds.length;
            const total = ALL_CARDS.length;
            document.getElementById('collectedCount').textContent = collected;
            const counter = document.getElementById('collectionCounter');
            if (collected === total) {
                counter.style.color = '#FFD700';
                counter.innerHTML += ' üéâ ¬°COMPLETADO!';
            }
        }
        function updateCountdowns() {
            const now = new Date();
            const gemsDiff = GEMS_OFFER_END - now;
            const exclusiveDiff = EXCLUSIVE_END - now;
            if (gemsDiff <= 0) {
                document.getElementById('offerBanner').style.display = 'none';
                document.getElementById('gemsOffer').style.display = 'none';
            } else {
                const h = Math.floor(gemsDiff / 3600000).toString().padStart(2,'0');
                const m = Math.floor((gemsDiff % 3600000) / 60000).toString().padStart(2,'0');
                const s = Math.floor((gemsDiff % 60000) / 1000).toString().padStart(2,'0');
                const timeStr = `${h}h ${m}m ${s}s`;
                document.querySelectorAll('#gemsCountdown, #shopGemsCountdown').forEach(el => el.textContent = timeStr);
            }
            if (exclusiveDiff <= 0) {
                document.getElementById('exclusiveBanner').style.display = 'none';
            } else {
                const h = Math.floor(exclusiveDiff / 3600000).toString().padStart(2,'0');
                const m = Math.floor((exclusiveDiff % 3600000) / 60000).toString().padStart(2,'0');
                const s = Math.floor((exclusiveDiff % 60000) / 1000).toString().padStart(2,'0');
                document.getElementById('exclusiveCountdown').textContent = `${h}h ${m}m ${s}s`;
            }
        }
        setInterval(updateCountdowns, 1000);
        updateCountdowns();
        function buyGemsPackage() {
            if (new Date() >= GEMS_OFFER_END) { alert("¬°La oferta ha terminado!"); return; }
            if (confirm("¬øComprar 1000 gemas por $4.99?")) {
                gameState.diamonds += 1000;
                saveGame();
                updateUI();
                alert("¬°Compra exitosa! Has recibido 1000 gemas üíé");
            }
        }
        function openChest(type) {
            let price = 0;
            let minCards = 0, maxCards = 0;
            let pool = [];
            if (type === 'rare') {
                price = 150;
                minCards = 3; maxCards = 5;
                pool = ALL_CARDS.filter(c => ['common', 'rare'].includes(c.rarity));
            } else if (type === 'epic') {
                price = 400;
                minCards = 4; maxCards = 6;
                pool = ALL_CARDS.filter(c => ['rare', 'epic'].includes(c.rarity));
            } else if (type === 'legendary') {
                price = 800;
                minCards = 5; maxCards = 8;
                pool = ALL_CARDS.filter(c => ['epic', 'legendary', 'idolos', 'tournament', 'paises', 'animated'].includes(c.rarity));
            }
            if (gameState.diamonds < price) {
                alert("¬°Gemas insuficientes para abrir este cofre!");
                return;
            }
            if (!confirm(`¬øAbrir Cofre ${type.charAt(0).toUpperCase() + type.slice(1)} por ${price} gemas?`)) return;
            gameState.diamonds -= price;
            gameState.totalChestsOpened++;
            const numCards = Math.floor(Math.random() * (maxCards - minCards + 1)) + minCards;
            const wonCards = [];
            for (let i = 0; i < numCards; i++) {
                const card = pool[Math.floor(Math.random() * pool.length)];
                if (!gameState.ownedCardIds.includes(card.id)) {
                    gameState.ownedCardIds.push(card.id);
                }
                wonCards.push(card);
            }
            saveGame();
            updateUI();
            renderDeck();
            renderShop();
            let message = `¬°Cofre ${type.charAt(0).toUpperCase() + type.slice(1)} abierto!\nHas obtenido:\n`;
            wonCards.forEach(c => message += `- ${c.name} (${c.rarity})\n`);
            alert(message);
            wonCards.forEach(card => showNewCard(card));
            checkAchievements();
        }
        function buyAnimatedPack() {
            if (gameState.diamonds < 3000) {
                alert("¬°Gemas insuficientes para el Pack GIFS ANIMADOS!");
                return;
            }
            if (confirm("¬øComprar Pack GIFS ANIMADOS por 3000 gemas? Obtendr√°s 3 cartas Pok√©mon folladas animadas exclusivas üî•üçÜ")) {
                gameState.diamonds -= 3000;
                gameState.spentDiamonds += 3000;
                gameState.packsBoughtCount++;
                gameState.specialSpend += 3000;
                [39,40,41].forEach(id => {
                    if (!gameState.ownedCardIds.includes(id)) gameState.ownedCardIds.push(id);
                });
                saveGame();
                updateUI();
                renderShop();
                renderDeck();
                alert("¬°Pack comprado! 3 Pok√©mon animados follados en tu colecci√≥n üçÜüí¶");
                [39,40,41].forEach(id => showNewCard(ALL_CARDS.find(c => c.id === id)));
                checkAchievements();
            }
        }
        function buyClassicPack() {
            if (gameState.diamonds < 3500) {
                alert("¬°Gemas insuficientes para el Classic Thicc Pack!");
                return;
            }
            if (confirm("¬øComprar Classic Thicc Pack por 3500 gemas? Obtendr√°s 3 chicas cl√°sicas thicc animadas üî•üçë")) {
                gameState.diamonds -= 3500;
                gameState.spentDiamonds += 3500;
                gameState.packsBoughtCount++;
                gameState.specialSpend += 3500;
                [43,44,45].forEach(id => {
                    if (!gameState.ownedCardIds.includes(id)) gameState.ownedCardIds.push(id);
                });
                saveGame();
                updateUI();
                renderShop();
                renderDeck();
                alert("¬°Classic Thicc Pack comprado! 3 chicas cl√°sicas thicc en tu colecci√≥n üí¶");
                [43,44,45].forEach(id => showNewCard(ALL_CARDS.find(c => c.id === id)));
                checkAchievements();
            }
        }
        function upgradeCard(cardId) {
            const card = ALL_CARDS.find(c => c.id === cardId);
            if (!card) return;
            const currentLevel = gameState.cardUpgrades[cardId] || 1;
            if (currentLevel >= MAX_LEVEL) { alert("¬°Nivel m√°ximo!"); return; }
            const cost = currentLevel * UPGRADE_COST_BASE;
            if (gameState.diamonds < cost) { alert("¬°Gemas insuficientes!"); return; }
            if (confirm(`¬øSubir ${card.name} al nivel ${currentLevel + 1} por ${cost} gemas?`)) {
                gameState.diamonds -= cost;
                gameState.spentDiamonds += cost;
                gameState.cardUpgrades[cardId] = currentLevel + 1;
                saveGame();
                applyCardUpgrades();
                updateUI();
                renderDeck();
                renderShop();
                renderBattleCards();
                checkAchievements();
                alert(`¬°${card.name} al nivel ${currentLevel + 1}!`);
            }
        }
        function addToDeck(cardId) {
            if (gameState.currentDeck.includes(cardId)) return;
            if (gameState.currentDeck.length >= DECK_MAX_SIZE) { alert(`Mazo lleno (m√°ximo ${DECK_MAX_SIZE})`); return; }
            gameState.currentDeck.push(cardId);
            saveGame();
            renderDeck();
        }
        function removeFromDeck(cardId) {
            gameState.currentDeck = gameState.currentDeck.filter(id => id !== cardId);
            saveGame();
            renderDeck();
        }
        function saveDeck() {
            alert("¬°Mazo guardado!");
            saveGame();
        }
        function showCardModal(card) {
            document.getElementById('cardModalImage').src = card.img;
            const rarityLabels = { common: "Com√∫n", rare: "Rara", epic: "√âpica", legendary: "Legendaria", idolos: "√çdolos", tournament: "Torneo", paises: "Pa√≠ses", animated: "Animados" };
            document.getElementById('cardModalRarity').textContent = rarityLabels[card.rarity] || card.rarity;
            document.getElementById('cardModalName').textContent = card.name;
            document.getElementById('cardModalLevel').textContent = `Nivel: ${card.level}`;
            document.getElementById('cardModalStats').textContent = `‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}`;
            document.getElementById('cardModal').style.display = 'flex';
        }
        function closeCardModal() {
            document.getElementById('cardModal').style.display = 'none';
        }
        function renderDeck() {
            const container = document.getElementById('deckCards');
            container.innerHTML = '';
            const filter = document.getElementById('rarityFilter').value;
            let cards = ALL_CARDS.filter(c => gameState.ownedCardIds.includes(c.id));
            if (filter !== 'all') cards = cards.filter(c => c.rarity === filter);
            cards.forEach(card => {
                const el = document.createElement('div');
                el.className = `card-container rarity-${card.rarity}`;
                const inDeck = gameState.currentDeck.includes(card.id);
                el.innerHTML = `
                    <div class="card-base">
                        <div class="card-glow"></div>
                        <div class="card-content">
                            <img src="${card.img}" onerror="this.src='https://via.placeholder.com/150/333/fff?text=${card.name}'" style="width:100%; height:190px; object-fit:cover; border-radius:8px;">
                            <div class="font-bold text-sm mt-2 truncate">${card.name}</div>
                            <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                            <div class="upgrade-badge">Nivel ${card.level}</div>
                            <button class="btn bg-${inDeck ? 'red' : 'green'}-600 text-sm mt-3" onclick="${inDeck ? `removeFromDeck(${card.id})` : `addToDeck(${card.id})`}">${inDeck ? 'Quitar' : 'A√±adir'} al Mazo</button>
                            <button class="btn bg-blue-600 text-sm mt-1" onclick="upgradeCard(${card.id})">Subir Nivel</button>
                        </div>
                    </div>
                `;
                el.querySelector('.card-base').onclick = (e) => { if (!e.target.closest('button')) showCardModal(card); };
                container.appendChild(el);
            });
            updateCollectionCounter();
        }
        function renderShop() {
            const container = document.getElementById('shopCards');
            container.innerHTML = '';
            const now = new Date();
            const buyable = ALL_CARDS.filter(c => c.shopPrice !== null && !gameState.ownedCardIds.includes(c.id) && (c.id !== 50 || now < EXCLUSIVE_END));
            buyable.forEach(card => {
                const el = document.createElement('div');
                el.className = `card-container rarity-${card.rarity}`;
                let extra = '';
                if (card.id === 22 && now < CARMELA_AVAILABLE) {
                    extra = `<div class="text-xs text-red-400 mt-1">Disponible en: <span id="carmelaCountdown">--h --m --s</span></div>`;
                    el.style.opacity = '0.7';
                }
                if (card.id === 38) {
                    extra = `<div class="text-xs text-yellow-300 mt-1 font-bold">¬°NUEVA COLABORACI√ìN SUPER MARIO BROS!</div><div class="text-xs text-white mt-1">Traeremos m√°s princesas</div>`;
                }
                if (card.id === 42) {
                    extra = `<div class="text-xs text-pink-300 mt-1 font-bold">¬°NUEVA OTAKU GIRL ANIMADA HA LLEGADO!</div>`;
                }
                if (card.id === 50) {
                    extra = `<div class="text-xs text-pink-300 mt-1 font-bold blink">¬°SOLO 24 HORAS!</div><div class="text-xs text-white">La carta m√°s poderosa del juego</div>`;
                }
                el.innerHTML = `
                    <div class="card-base">
                        <div class="card-glow"></div>
                        <div class="card-content">
                            <img src="${card.img}" onerror="this.src='https://via.placeholder.com/150/333/fff?text=${card.name}'" style="width:100%; height:190px; object-fit:cover; border-radius:8px;">
                            <div class="font-bold text-sm mt-2 truncate">${card.name}</div>
                            <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                            <div class="upgrade-badge">Nivel ${card.level}</div>
                            <div class="text-xs text-yellow-400 mt-1">üíé ${card.shopPrice}</div>
                            ${extra}
                        </div>
                    </div>
                `;
                el.onclick = () => buyCard(card.id);
                container.appendChild(el);
            });
            if (buyable.length === 0) container.innerHTML = '<p class="text-center text-2xl text-yellow-400 col-span-full">¬°Tienda vac√≠a! Has comprado todo üéâ</p>';
        }
        function buyCard(cardId) {
            const now = new Date();
            const card = ALL_CARDS.find(c => c.id === cardId);
            if (card.id === 22 && now < CARMELA_AVAILABLE) { alert("¬°No disponible a√∫n!"); return; }
            if (gameState.diamonds < card.shopPrice) { alert("¬°Gemas insuficientes!"); return; }
            if (confirm(`¬øComprar ${card.name} por ${card.shopPrice} gemas?`)) {
                gameState.diamonds -= card.shopPrice;
                gameState.spentDiamonds += card.shopPrice;
                if (!gameState.ownedCardIds.includes(cardId)) gameState.ownedCardIds.push(cardId);
                saveGame();
                updateUI();
                renderShop();
                renderDeck();
                checkAchievements();
                alert(`¬°${card.name} comprada!`);
            }
        }
        function saveGame() {
            localStorage.setItem('trophies', gameState.trophies);
            localStorage.setItem('diamonds', gameState.diamonds);
            localStorage.setItem('cups', gameState.cups);
            localStorage.setItem('ownedCardIds', JSON.stringify(gameState.ownedCardIds));
            localStorage.setItem('cardUpgrades', JSON.stringify(gameState.cardUpgrades));
            localStorage.setItem('currentDeck', JSON.stringify(gameState.currentDeck));
            localStorage.setItem('completedTournaments', JSON.stringify(gameState.completedTournaments));
            localStorage.setItem('achievements', JSON.stringify(gameState.achievements));
            localStorage.setItem('spentDiamonds', gameState.spentDiamonds);
            localStorage.setItem('winStreak', gameState.winStreak);
            localStorage.setItem('totalChestsOpened', gameState.totalChestsOpened);
            localStorage.setItem('totalEnemyKills', gameState.totalEnemyKills);
            localStorage.setItem('packsBoughtCount', gameState.packsBoughtCount);
            localStorage.setItem('allCardsUsed', JSON.stringify([...gameState.allCardsUsed]));
            localStorage.setItem('specialSpend', gameState.specialSpend);
            localStorage.setItem('winStreakThicc', gameState.winStreakThicc);
            localStorage.setItem('skinsDuelWins', gameState.skinsDuelWins);
            localStorage.setItem('skinsDuelPerfectWins', gameState.skinsDuelPerfectWins);
            localStorage.setItem('coliseumWins', gameState.coliseumWins);
            localStorage.setItem('coliseumBestMultiplier', gameState.coliseumBestMultiplier);
            localStorage.setItem('coliseumBossDefeated', JSON.stringify(gameState.coliseumBossDefeated));
            // Arena mode state
            localStorage.setItem('arenaRank', gameState.arenaRank);
            localStorage.setItem('arenaProgress', gameState.arenaProgress);
            localStorage.setItem('arenaTotalWins', gameState.arenaTotalWins);
            localStorage.setItem('arenaTotalGems', gameState.arenaTotalGems);
            localStorage.setItem('arenaWinStreak', gameState.arenaWinStreak);
            let rankings = JSON.parse(localStorage.getItem('rankings') || '[]');
            const index = rankings.findIndex(r => r.name === gameState.playerName);
            const data = { name: gameState.playerName, trophies: gameState.trophies, avatar: gameState.avatar };
            if (index >= 0) rankings[index] = data; else rankings.push(data);
            rankings.sort((a,b) => b.trophies - a.trophies);
            localStorage.setItem('rankings', JSON.stringify(rankings.slice(0,10)));
        }
        function updateRanking() {
            const rankings = JSON.parse(localStorage.getItem('rankings') || '[]');
            const container = document.getElementById('rankingList');
            container.innerHTML = '';
            rankings.forEach((p, i) => {
                const item = document.createElement('div');
                item.className = 'ranking-item';
                item.innerHTML = `
                    <div class="ranking-avatar" style="background-image:url('${p.avatar}')"></div>
                    <div class="ranking-info">
                        <div class="ranking-name">${p.name}</div>
                        <div class="ranking-trophies">ü™ô ${p.trophies} trofeos</div>
                    </div>
                    <div class="ranking-pos text-3xl font-bold">${i+1}</div>
                `;
                container.appendChild(item);
            });
        }
        function renderTournaments() {
            const container = document.getElementById('tournamentsList');
            container.innerHTML = '';
            const now = new Date();
            TOURNAMENTS.forEach(t => {
                if (gameState.completedTournaments.includes(t.id)) return;
                let button = `<button class="btn bg-gradient-to-r from-red-700 to-green-700 text-lg px-8 py-4" onclick="startSpecificTournament(${t.id})">üéÅ ENTRAR AL TORNEO</button>`;
                if (t.id === 6 && now < SABRINA_START) {
                    button = `<button class="btn bg-gray-600 text-lg px-8 py-4" disabled>Disponible en: <span id="sabrinaCountdown">--h --m --s</span></button>`;
                }
                const el = document.createElement('div');
                el.className = 'bg-gradient-to-r from-red-900/80 via-green-800/80 to-yellow-900/80 border-2 border-yellow-500 rounded-2xl p-6 mb-8 animate-pulse shadow-2xl';
                el.innerHTML = `
                    <div class="flex items-center justify-center gap-4 mb-4"><i class="fas fa-star text-yellow-300 text-2xl"></i><span class="text-2xl font-bold text-white">${t.name}</span><i class="fas fa-star text-yellow-300 text-2xl"></i></div>
                    <p class="text-center text-yellow-100 font-semibold text-lg">${t.description}</p>
                    <p class="text-center text-gray-200 mb-6">Necesitas <strong>${t.cost} copas</strong>. Recompensas: ${t.trophies} trofeos, ${t.diamonds} gemas y cartas exclusivas.</p>
                    <div class="text-center mb-6"><img src="${t.image}" class="inline-block w-32 h-32 rounded-xl border-4 border-yellow-400 shadow-xl"></div>
                    <div class="text-center">${button}</div>
                `;
                container.appendChild(el);
            });
        }
        function startSpecificTournament(id) {
            const t = TOURNAMENTS.find(x => x.id === id);
            if (gameState.cups < t.cost) { alert(`¬°Necesitas ${t.cost} copas!`); return; }
            gameState.cups -= t.cost;
            saveGame();
            updateUI();
            isTournament = true; isCupBattle = false; currentTournamentId = id;
            iaDeckIds = t.iaDeck;
            iaLevelMultiplier = t.iaMultiplier || 1;
            renderIaCards();
            renderBattleCards();
            resetBattle();
            showView('battle');
        }
        function startCupBattle() {
            isCupBattle = true; isTournament = false;
            iaDeckIds = [0,1,2]; iaLevelMultiplier = 1;
            renderIaCards();
            renderBattleCards();
            resetBattle();
            showView('battle');
        }
        function showView(view) {
            ['battle', 'deck', 'shop', 'tournament', 'cupMode', 'ranking', 'achievements', 'skinsDuel', 'coliseum', 'arena'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.classList.remove('active');
            });
            const target = document.getElementById(view);
            if (target) target.classList.add('active');
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.nav-btn[onclick="showView('${view}')"]`);
            if (activeBtn) activeBtn.classList.add('active');
            if (view === 'deck') renderDeck();
            if (view === 'shop') renderShop();
            if (view === 'tournament') renderTournaments();
            if (view === 'ranking') updateRanking();
            if (view === 'battle') { 
                // Inicializar las cartas de la IA si no hay un torneo o batalla de copas activo
                if (!isTournament && !isCupBattle) {
                    initDefaultIaCards();
                }
                renderIaCards(); 
                renderBattleCards(); 
            }
            if (view === 'achievements') renderAchievements();
            if (view === 'skinsDuel') initSkinsDuel();
            if (view === 'coliseum') initColiseum();
            if (view === 'arena') initArena();
        }
        let iaCards = [], playerCards = [], selectedPlayerCard = null, selectedTargetCard = null;
        let isTournament = false, isCupBattle = false, currentTournamentId = null, iaDeckIds = [], iaLevelMultiplier = 1;
        let battleEnded = false;
        
        // Funci√≥n para inicializar las cartas de la IA por defecto
        function initDefaultIaCards() {
            if (iaDeckIds.length === 0) {
                // Si no hay cartas de IA definidas, usar algunas por defecto
                iaDeckIds = [3, 4, 5]; // Usar cartas con diferentes niveles de dificultad
                iaLevelMultiplier = 1;
            }
        }
        
        function renderIaCards() {
            const container = document.getElementById('battleIaCards');
            container.innerHTML = '';
            iaCards = [];
            
            // Asegurarse de que haya cartas de IA para mostrar
            if (iaDeckIds.length === 0) {
                initDefaultIaCards();
            }
            
            iaDeckIds.forEach((id, i) => {
                let card = {...ALL_CARDS.find(c => c.id === id)};
                if (!card) return;
                card.atk = Math.round(card.atk * iaLevelMultiplier);
                card.def = Math.round(card.def * iaLevelMultiplier);
                const el = document.createElement('div');
                el.className = 'ia-card';
                el.innerHTML = `<img src="${card.img}"><div class="name">${card.name}</div><div class="stats"><span>‚öîÔ∏è ${card.atk}</span><span>üõ°Ô∏è ${card.def}</span></div><div class="hp-bar"><div class="hp-fill" style="width:100%"></div></div><div class="hp-text">HP: ${card.def}/${card.def}</div>`;
                el.onclick = () => {
                    if (iaCards[i].hp > 0) {
                        selectedTargetCard = iaCards[i];
                        document.querySelectorAll('.ia-card').forEach(e => e.classList.remove('selected'));
                        el.classList.add('selected');
                    }
                };
                container.appendChild(el);
                iaCards.push({name: card.name, atk: card.atk, def: card.def, hp: card.def, maxHp: card.def, element: el});
            });
        }
        function renderBattleCards() {
            const container = document.getElementById('battlePlayerCards');
            container.innerHTML = '';
            playerCards = [];
            gameState.currentDeck.forEach((id, i) => {
                const card = ALL_CARDS.find(c => c.id === id);
                if (!card) return;
                gameState.allCardsUsed.add(id);
                const el = document.createElement('div');
                el.className = 'player-card';
                el.innerHTML = `<img src="${card.img}"><div class="name">${card.name}</div><div class="stats"><span>‚öîÔ∏è ${card.atk}</span><span>üõ°Ô∏è ${card.def}</span></div><div class="upgrade-badge">Nivel ${card.level}</div><div class="hp-bar"><div class="hp-fill" style="width:100%"></div></div><div class="hp-text">HP: ${card.def}/${card.def}</div>`;
                el.onclick = () => {
                    if (playerCards[i].hp > 0) {
                        selectedPlayerCard = playerCards[i];
                        document.querySelectorAll('.player-card').forEach(e => e.classList.remove('selected'));
                        el.classList.add('selected');
                    }
                };
                container.appendChild(el);
                playerCards.push({name: card.name, atk: card.atk, def: card.def, hp: card.def, maxHp: card.def, element: el});
            });
            if (playerCards.length === 0) container.innerHTML = '<p class="text-center text-xl">¬°A√±ade cartas al mazo!</p>';
        }
        function resetBattle() {
            playerCards.forEach(c => { c.hp = c.maxHp; c.element.classList.remove('selected'); });
            iaCards.forEach(c => { c.hp = c.maxHp; c.element.classList.remove('selected'); });
            updateHpBars();
            selectedPlayerCard = selectedTargetCard = null;
            battleEnded = false;
        }
        function updateHpBars() {
            [...iaCards, ...playerCards].forEach(c => {
                const percent = Math.max(0, (c.hp / c.maxHp) * 100);
                c.element.querySelector('.hp-fill').style.width = `${percent}%`;
                c.element.querySelector('.hp-text').textContent = `HP: ${Math.round(c.hp)}/${Math.round(c.maxHp)}`;
            });
        }
        function playerAttack() {
            if (battleEnded) return;
            if (!selectedPlayerCard || !selectedTargetCard) {
                alert("¬°Selecciona tu carta y el objetivo enemigo!");
                return;
            }
            const effectiveDamage = Math.max(0, selectedPlayerCard.atk - Math.round(selectedTargetCard.def * 0.3));
            selectedTargetCard.hp -= effectiveDamage;
            animateAttack(selectedPlayerCard.element, selectedTargetCard.element);
            updateHpBars();
            checkBattleEnd();
            if (!battleEnded) {
                setTimeout(iaAttack, 1000);
            }
        }
        function iaAttack() {
            if (battleEnded) return;
            const aliveIa = iaCards.filter(c => c.hp > 0);
            const alivePlayer = playerCards.filter(c => c.hp > 0);
            if (aliveIa.length === 0 || alivePlayer.length === 0) {
                checkBattleEnd();
                return;
            }
            const attacker = aliveIa[Math.floor(Math.random() * aliveIa.length)];
            const target = alivePlayer[Math.floor(Math.random() * alivePlayer.length)];
            const effectiveDamage = Math.max(0, attacker.atk - Math.round(target.def * 0.3));
            target.hp -= effectiveDamage;
            animateAttack(attacker.element, target.element);
            updateHpBars();
            checkBattleEnd();
        }
        function playerDefend() {
            if (battleEnded) return;
            if (!selectedPlayerCard) {
                alert("¬°Selecciona tu carta para defender!");
                return;
            }
            const origDef = selectedPlayerCard.def;
            selectedPlayerCard.def *= 2;
            animateDefend(selectedPlayerCard.element);
            setTimeout(() => {
                if (!battleEnded) {
                    iaAttack();
                }
                selectedPlayerCard.def = origDef;
                updateHpBars();
                checkBattleEnd();
            }, 1000);
        }
        function checkBattleEnd() {
            if (battleEnded) return;
            if (iaCards.every(c => c.hp <= 0)) {
                battleEnded = true;
                gameState.totalEnemyKills += iaCards.length;
                gameState.winStreak++;
                const isThiccDeck = gameState.currentDeck.every(id => {
                    const r = ALL_CARDS.find(c => c.id === id)?.rarity;
                    return ['epic','legendary','animated','idolos'].includes(r);
                });
                if (isThiccDeck) gameState.winStreakThicc++;
                showBattleMessage("¬°FELICIDADES! HAS GANADO üéÑ");
                if (isTournament) {
                    const t = TOURNAMENTS.find(x => x.id === currentTournamentId);
                    t.cards.forEach(id => {
                        if (!gameState.ownedCardIds.includes(id)) {
                            gameState.ownedCardIds.push(id);
                            showNewCard(ALL_CARDS.find(c => c.id === id));
                        }
                    });
                    gameState.trophies += t.trophies;
                    gameState.diamonds += t.diamonds;
                    gameState.completedTournaments.push(t.id);
                    unlockAchievement(4);
                }
                if (isCupBattle) {
                    gameState.cups += 1;
                    updateUI();
                }
                unlockAchievement(1);
                saveGame();
                renderDeck();
                renderTournaments();
                checkAchievements();
            } else if (playerCards.every(c => c.hp <= 0)) {
                battleEnded = true;
                gameState.winStreak = 0;
                gameState.winStreakThicc = 0;
                showBattleMessage("HAS PERDIDO...");
                saveGame();
                checkAchievements();
            }
        }
        function showBattleMessage(msg) {
            document.getElementById('messageText').textContent = msg;
            document.getElementById('battleMessage').style.display = 'block';
        }
        function closeBattleMessage() {
            document.getElementById('battleMessage').style.display = 'none';
            battleEnded = false;
            isTournament = isCupBattle = false;
        }
        function rematch() {
            closeBattleMessage();
            resetBattle();
        }
        function showNewCard(card) {
            showCardModal(card);
            startFireworks();
        }
        function startFireworks() {
            for (let i = 0; i < 10; i++) {
                const fw = document.createElement('div');
                fw.className = 'firework';
                fw.style.left = Math.random() * 100 + '%';
                fw.style.top = Math.random() * 100 + '%';
                fw.style.background = `hsl(${Math.random()*360},100%,50%)`;
                fw.style.setProperty('--x', `${(Math.random() - 0.5) * 200}px`);
                fw.style.setProperty('--y', `${(Math.random() - 0.5) * 200}px`);
                document.body.appendChild(fw);
                setTimeout(() => fw.remove(), 1000);
            }
        }
        function createSnowflakes() {
            for (let i = 0; i < 30; i++) {
                const s = document.createElement('div');
                s.className = 'snowflake';
                s.style.left = Math.random() * 100 + 'vw';
                s.style.animationDelay = Math.random() * 10 + 's';
                s.style.animationDuration = Math.random() * 10 + 10 + 's';
                s.style.opacity = Math.random() * 0.5 + 0.5;
                const size = Math.random() * 5 + 5;
                s.style.width = s.style.height = size + 'px';
                document.body.appendChild(s);
            }
        }
        function animateAttack(att, tar) {
            tar.classList.add('attacked');
            setTimeout(() => tar.classList.remove('attacked'), 500);
        }
        function animateDefend(el) {
            el.classList.add('defended');
            setTimeout(() => el.classList.remove('defended'), 1000);
        }
        function unlockAchievement(id) {
            if (!gameState.achievements.includes(id)) {
                gameState.achievements.push(id);
                saveGame();
                const achievement = ACHIEVEMENTS.find(a => a.id === id);
                if (achievement) {
                    alert(`¬°Logro desbloqueado: ${achievement.name}! ${achievement.icon}`);
                }
            }
        }
        function checkAchievements() {
            if (gameState.ownedCardIds.length >= 5) unlockAchievement(1);
            if (Object.values(gameState.cardUpgrades).some(l => l >= 5)) unlockAchievement(2);
            if (gameState.spentDiamonds >= 500) unlockAchievement(5);
            if (gameState.winStreak >= 10) unlockAchievement(6);
            if (gameState.spentDiamonds >= 5000) unlockAchievement(8);
            if (Math.max(...Object.values(gameState.cardUpgrades), 0) >= 20) unlockAchievement(9);
            if (gameState.totalChestsOpened >= 20) unlockAchievement(10);
            if (Math.max(...Object.values(gameState.cardUpgrades), 0) >= 50) unlockAchievement(11);
            if (gameState.ownedCardIds.includes(50)) unlockAchievement(12);
            if (gameState.specialSpend >= 10000) unlockAchievement(13);
            if (gameState.ownedCardIds.length === ALL_CARDS.length) unlockAchievement(14);
            if (gameState.winStreakThicc >= 5) unlockAchievement(15);
            if (gameState.totalEnemyKills >= 50) unlockAchievement(16);
            if (gameState.packsBoughtCount >= 2) unlockAchievement(17);
            if (gameState.spentDiamonds >= 20000) unlockAchievement(18);
            if (gameState.allCardsUsed.size >= ALL_CARDS.length) unlockAchievement(19);
            if (gameState.ownedCardIds.length === ALL_CARDS.length && gameState.completedTournaments.length === TOURNAMENTS.length) unlockAchievement(20);
            if (gameState.skinsDuelWins >= 5) unlockAchievement(21);
            if (gameState.skinsDuelPerfectWins >= 1) unlockAchievement(22);
            if (gameState.coliseumWins >= 1) unlockAchievement(23);
            if (gameState.coliseumWins >= 5) unlockAchievement(24);
            if (coliseumState.baseReward * coliseumState.multiplier >= 500) unlockAchievement(25);
            if (coliseumState.multiplier >= 5) unlockAchievement(26);
            if (gameState.coliseumBossDefeated.length > 0) unlockAchievement(27);
            // Arena achievements
            if (gameState.arenaTotalWins >= 1) unlockAchievement(28);
            if (gameState.arenaRank >= 2) unlockAchievement(29);
            if (gameState.arenaRank >= 4) unlockAchievement(30);
            if (gameState.arenaRank >= 9) unlockAchievement(31);
            if (gameState.arenaWinStreak >= 10) unlockAchievement(32);
            if (gameState.arenaTotalGems >= 1000) unlockAchievement(33);
        }
        function renderAchievements() {
            const container = document.getElementById('achievementsList');
            container.innerHTML = '';
            ACHIEVEMENTS.forEach(a => {
                const unlocked = gameState.achievements.includes(a.id);
                const item = document.createElement('div');
                item.className = `ranking-item p-4 rounded-xl ${unlocked ? 'bg-gradient-to-r from-pink-600 to-purple-700 animate-pulse shadow-2xl' : 'bg-gray-800 opacity-70'}`;
                let progress = '';
                if (a.id === 6) progress = `Racha: ${gameState.winStreak}/10 üî•`;
                if (a.id === 10) progress = `Cofres: ${gameState.totalChestsOpened}/20 üì¶`;
                if (a.id === 15) progress = `Racha Thicc: ${gameState.winStreakThicc}/5 üçë`;
                if (a.id === 16) progress = `Muertes: ${gameState.totalEnemyKills}/50 üî®`;
                if (a.id === 21) progress = `Victorias: ${gameState.skinsDuelWins}/5 üéÆ`;
                if (a.id === 23) progress = `Victorias: ${gameState.coliseumWins}/1 üèüÔ∏è`;
                if (a.id === 24) progress = `Victorias: ${gameState.coliseumWins}/5 üèüÔ∏è`;
                if (a.id === 25) progress = `Mejor premio: ${coliseumState.baseReward * coliseumState.multiplier}/500 üíé`;
                if (a.id === 26) progress = `Multiplicador: ${coliseumState.multiplier}/5 x`;
                // Arena progress
                if (a.id === 28) progress = `Victorias: ${gameState.arenaTotalWins}/1 ‚öîÔ∏è`;
                if (a.id === 29) progress = `Rango: ${gameState.arenaRank + 1}/3 üìà`;
                if (a.id === 30) progress = `Rango: ${gameState.arenaRank + 1}/5 üèÜ`;
                if (a.id === 31) progress = `Rango: ${gameState.arenaRank + 1}/10 üëë`;
                if (a.id === 32) progress = `Racha: ${gameState.arenaWinStreak}/10 üî•`;
                if (a.id === 33) progress = `Gemas: ${gameState.arenaTotalGems}/1000 üíé`;
                item.innerHTML = `
                    <div class="text-4xl">${a.icon}</div>
                    <div class="flex-1">
                        <div class="text-xl font-bold">${a.name}</div>
                        <div class="text-sm opacity-90">${a.description}</div>
                        ${progress ? `<div class="text-xs text-pink-300 mt-1">${progress}</div>` : ''}
                        ${unlocked ? '<div class="text-sm text-yellow-300 mt-1">¬°DESBLOQUEADO! üéâüí¶</div>' : ''}
                    </div>
                `;
                container.appendChild(item);
            });
        }
        
        // Funciones para el modo Duelo de Skins
        function initSkinsDuel() {
            if (!skinsDuelState.active) {
                resetSkinsDuel();
            }
            renderSkinsBoard();
            updateHealthBars();
        }
        
        function startSkinsDuel() {
            if (skinsDuelState.active) {
                if (!confirm("¬øReiniciar el duelo actual?")) return;
            }
            
            resetSkinsDuel();
            skinsDuelState.active = true;
            
            // Iniciar ataques del jefe cada 5 segundos
            skinsDuelState.bossAttackInterval = setInterval(() => {
                if (skinsDuelState.active && skinsDuelState.playerHealth > 0) {
                    bossAttack();
                }
            }, 5000);
            
            document.getElementById('duelMessage').textContent = "¬°Encuentra parejas para atacar al jefe o defenderte!";
            renderSkinsBoard();
            updateHealthBars();
            unlockAchievement(7); // Logro por jugar la primera partida de Duelo de Skins
        }
        
        function resetSkinsDuel() {
            // Limpiar intervalo de ataque del jefe si existe
            if (skinsDuelState.bossAttackInterval) {
                clearInterval(skinsDuelState.bossAttackInterval);
                skinsDuelState.bossAttackInterval = null;
            }
            
            // Reiniciar estado del juego
            skinsDuelState = {
                active: false,
                playerHealth: 100,
                bossHealth: 100,
                maxPlayerHealth: 100,
                maxBossHealth: 100,
                cards: [],
                selectedCard: null,
                matchedPairs: 0,
                bossAttackInterval: null,
                boardSize: 12
            };
            
            document.getElementById('duelMessage').textContent = "¬°Encuentra parejas para comenzar el duelo!";
            renderSkinsBoard();
            updateHealthBars();
        }
        
        function renderSkinsBoard() {
            const board = document.getElementById('skinsBoard');
            board.innerHTML = '';
            
            // Si el juego no est√° activo, mostrar un mensaje
            if (!skinsDuelState.active) {
                board.innerHTML = '<div class="col-span-full text-center text-xl text-yellow-300">Presiona "INICIAR DUELO" para comenzar</div>';
                return;
            }
            
            // Generar cartas para el tablero si no existen
            if (skinsDuelState.cards.length === 0) {
                generateSkinsCards();
            }
            
            // Renderizar cada carta en el tablero
            skinsDuelState.cards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = `skin-card ${card.type}-type ${card.matched ? 'matched' : ''}`;
                cardElement.dataset.index = index;
                
                if (!card.matched) {
                    cardElement.onclick = () => selectCard(index);
                }
                
                cardElement.innerHTML = `
                    <img src="${card.img}" alt="${card.name}">
                    <div class="skin-card-name">${card.name}</div>
                    <div class="skin-card-type ${card.type === 'attack' ? 'attack-badge' : 'defense-badge'}">${card.type === 'attack' ? 'Ataque' : 'Escudo'}</div>
                    <div class="skin-card-value">${card.value}</div>
                `;
                
                board.appendChild(cardElement);
            });
        }
        
        function generateSkinsCards() {
            const cards = [];
            const availableCards = ALL_CARDS.filter(card => gameState.ownedCardIds.includes(card.id));
            
            // Mezclar las cartas disponibles
            const shuffled = [...availableCards].sort(() => 0.5 - Math.random());
            
            // Tomar la mitad del tama√±o del tablero para crear pares
            const pairCount = skinsDuelState.boardSize / 2;
            const selectedCards = shuffled.slice(0, pairCount);
            
            // Crear pares de cartas (ataque y defensa)
            selectedCards.forEach(card => {
                // Primera carta del par (ataque)
                cards.push({
                    id: card.id,
                    name: card.name,
                    img: card.img,
                    type: 'attack',
                    value: card.atk,
                    matched: false,
                    pairId: card.id
                });
                
                // Segunda carta del par (defensa)
                cards.push({
                    id: card.id,
                    name: card.name,
                    img: card.img,
                    type: 'defense',
                    value: card.def,
                    matched: false,
                    pairId: card.id
                });
            });
            
            // Mezclar las cartas del tablero
            skinsDuelState.cards = cards.sort(() => 0.5 - Math.random());
        }
        
        function selectCard(index) {
            // Si el juego no est√° activo o la carta ya est√° emparejada, no hacer nada
            if (!skinsDuelState.active || skinsDuelState.cards[index].matched) {
                return;
            }
            
            // Si no hay carta seleccionada, seleccionar esta
            if (skinsDuelState.selectedCard === null) {
                skinsDuelState.selectedCard = index;
                document.querySelectorAll('.skin-card')[index].style.transform = 'translateY(-10px)';
                return;
            }
            
            // Si se selecciona la misma carta, deseleccionarla
            if (skinsDuelState.selectedCard === index) {
                document.querySelectorAll('.skin-card')[index].style.transform = '';
                skinsDuelState.selectedCard = null;
                return;
            }
            
            // Obtener las cartas seleccionadas
            const card1 = skinsDuelState.cards[skinsDuelState.selectedCard];
            const card2 = skinsDuelState.cards[index];
            
            // Verificar si forman un par (mismo ID)
            if (card1.pairId === card2.pairId) {
                // Marcar como emparejadas
                card1.matched = true;
                card2.matched = true;
                skinsDuelState.matchedPairs++;
                
                // Aplicar efecto seg√∫n el tipo de par
                if (card1.type === 'attack' && card2.type === 'attack') {
                    // Par de ataque: da√±ar al jefe
                    const damage = card1.value + card2.value;
                    skinsDuelState.bossHealth = Math.max(0, skinsDuelState.bossHealth - damage);
                    document.getElementById('duelMessage').textContent = `¬°Par de ataque encontrado! Has causado ${damage} de da√±o al jefe.`;
                    
                    // Comprobar si el jefe ha sido derrotado
                    if (skinsDuelState.bossHealth <= 0) {
                        endSkinsDuel(true);
                    }
                } else if (card1.type === 'defense' && card2.type === 'defense') {
                    // Par de defensa: recuperar vida del jugador
                    const heal = card1.value + card2.value;
                    skinsDuelState.playerHealth = Math.min(skinsDuelState.maxPlayerHealth, skinsDuelState.playerHealth + heal);
                    document.getElementById('duelMessage').textContent = `¬°Par de escudos encontrado! Has recuperado ${heal} puntos de vida.`;
                }
                
                // Actualizar las barras de vida
                updateHealthBars();
                
                // Comprobar si se han encontrado todos los pares
                if (skinsDuelState.matchedPairs === skinsDuelState.boardSize / 2) {
                    endSkinsDuel(true);
                }
            } else {
                // No es un par v√°lido, mostrar mensaje
                document.getElementById('duelMessage').textContent = "¬°No es un par v√°lido! Sigue buscando.";
            }
            
            // Reiniciar la selecci√≥n
            document.querySelectorAll('.skin-card')[skinsDuelState.selectedCard].style.transform = '';
            skinsDuelState.selectedCard = null;
            
            // Actualizar el tablero
            renderSkinsBoard();
        }
        
        function bossAttack() {
            // El jefe ataca al jugador
            const damage = Math.floor(Math.random() * 15) + 10; // Da√±o entre 10 y 25
            skinsDuelState.playerHealth = Math.max(0, skinsDuelState.playerHealth - damage);
            
            // Mostrar animaci√≥n de ataque
            const bossImage = document.getElementById('bossImage');
            bossImage.classList.add('attacking');
            setTimeout(() => bossImage.classList.remove('attacking'), 800);
            
            // Actualizar mensaje y barras de vida
            document.getElementById('duelMessage').textContent = `¬°El jefe te ha atacado! Has recibido ${damage} de da√±o.`;
            updateHealthBars();
            
            // Comprobar si el jugador ha sido derrotado
            if (skinsDuelState.playerHealth <= 0) {
                endSkinsDuel(false);
            }
        }
        
        function updateHealthBars() {
            // Actualizar barra de vida del jefe
            const bossHealthPercent = (skinsDuelState.bossHealth / skinsDuelState.maxBossHealth) * 100;
            document.getElementById('bossHealthBar').style.width = `${bossHealthPercent}%`;
            document.getElementById('bossHealthText').textContent = `${Math.ceil(skinsDuelState.bossHealth)} / ${skinsDuelState.maxBossHealth}`;
            
            // Actualizar barra de vida del jugador
            const playerHealthPercent = (skinsDuelState.playerHealth / skinsDuelState.maxPlayerHealth) * 100;
            document.getElementById('playerHealthBar').style.width = `${playerHealthPercent}%`;
            document.getElementById('playerHealthText').textContent = `${Math.ceil(skinsDuelState.playerHealth)} / ${skinsDuelState.maxPlayerHealth}`;
        }
        
        function endSkinsDuel(playerWon) {
            // Detener los ataques del jefe
            if (skinsDuelState.bossAttackInterval) {
                clearInterval(skinsDuelState.bossAttackInterval);
                skinsDuelState.bossAttackInterval = null;
            }
            
            skinsDuelState.active = false;
            
            if (playerWon) {
                // Victoria del jugador
                gameState.skinsDuelWins++;
                
                // Comprobar si fue una victoria perfecta (sin perder vida)
                if (skinsDuelState.playerHealth === skinsDuelState.maxPlayerHealth) {
                    gameState.skinsDuelPerfectWins++;
                    document.getElementById('duelMessage').textContent = "¬°VICTORIA PERFECTA! Has derrotado al jefe sin perder vida.";
                    unlockAchievement(22); // Logro por victoria perfecta
                } else {
                    document.getElementById('duelMessage').textContent = "¬°FELICIDADES! Has derrotado al jefe.";
                }
                
                // Recompensas
                gameState.trophies += 50;
                gameState.diamonds += 25;
                
                // Comprobar logros
                if (gameState.skinsDuelWins >= 5) {
                    unlockAchievement(21); // Logro por ganar 5 partidas de Duelo de Skins
                }
                
                // Mostrar fuegos artificiales
                startFireworks();
            } else {
                // Derrota del jugador
                document.getElementById('duelMessage').textContent = "HAS SIDO DERROTADO... El jefe ha ganado el duelo.";
            }
            
            // Guardar el estado del juego
            saveGame();
            updateUI();
            checkAchievements();
            
            // Actualizar el tablero
            renderSkinsBoard();
        }
        
        // Funciones para el modo Coliseo de Oro
        function initColiseum() {
            if (!coliseumState.active) {
                resetColiseum();
            }
            renderColiseumCards();
            updateColiseumHealthBars();
        }
        
        function startColiseum() {
            if (gameState.diamonds < 100) {
                alert("¬°Necesitas 100 gemas para entrar al Coliseo de Oro!");
                return;
            }
            
            if (coliseumState.active) {
                if (!confirm("¬øReiniciar el Coliseo actual? Perder√°s tu progreso.")) return;
            }
            
            // Cobrar la entrada
            gameState.diamonds -= 100;
            gameState.spentDiamonds += 100;
            saveGame();
            updateUI();
            
            resetColiseum();
            coliseumState.active = true;
            
            // Seleccionar 3 cartas aleatorias del jugador
            const availableCards = ALL_CARDS.filter(card => gameState.ownedCardIds.includes(card.id));
            const selectedCards = [];
            
            for (let i = 0; i < 3; i++) {
                if (availableCards.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableCards.length);
                    const card = availableCards[randomIndex];
                    selectedCards.push({...card});
                    availableCards.splice(randomIndex, 1);
                }
            }
            
            coliseumState.playerCards = selectedCards;
            
            // Generar oponente inicial
            generateOpponent();
            
            // Iniciar batalla autom√°tica
            startAutoBattle();
            
            // Iniciar eventos aleatorios de arena
            startArenaEvents();
            
            // Actualizar UI
            document.getElementById('startColiseumBtn').style.display = 'none';
            document.getElementById('resetColiseumBtn').style.display = 'inline-block';
            document.getElementById('coliseumMessage').textContent = `¬°Comienza la batalla contra ${coliseumState.currentOpponent === 0 ? 'el primer oponente' : 'el oponente ' + (coliseumState.currentOpponent + 1)}!`;
            document.getElementById('chatContainer').style.display = 'block';
            
            // Desbloquear logro
            unlockAchievement(23);
        }
        
        function resetColiseum() {
            // Limpiar intervalos si existen
            if (coliseumState.battleInterval) {
                clearInterval(coliseumState.battleInterval);
                coliseumState.battleInterval = null;
            }
            
            if (coliseumState.eventInterval) {
                clearInterval(coliseumState.eventInterval);
                coliseumState.eventInterval = null;
            }
            
            // Reiniciar estado del juego
            coliseumState = {
                active: false,
                playerHealth: 100,
                maxPlayerHealth: 100,
                opponentHealth: 100,
                maxOpponentHealth: 100,
                currentOpponent: 0,
                maxOpponents: 5,
                playerCards: [],
                opponentCards: [],
                multiplier: 1,
                baseReward: 50,
                battleInterval: null,
                eventInterval: null,
                isBossInfiltrated: false,
                spectatorMode: false,
                votes: { player: 0, opponent: 0 }
            };
            
            // Actualizar UI
            document.getElementById('startColiseumBtn').style.display = 'inline-block';
            document.getElementById('resetColiseumBtn').style.display = 'none';
            document.getElementById('coliseumMessage').textContent = "Selecciona tus tres mejores cartas para comenzar";
            document.getElementById('riskMultiplier').style.display = 'none';
            document.getElementById('riskButtons').style.display = 'none';
            document.getElementById('coliseumReward').style.display = 'none';
            document.getElementById('chatContainer').style.display = 'none';
            
            renderColiseumCards();
            updateColiseumHealthBars();
        }
        
        function generateOpponent() {
            // Generar cartas para el oponente
            const opponentCards = [];
            const difficulty = 1 + (coliseumState.currentOpponent * 0.5); // Aumentar dificultad con cada oponente
            
            // Posibilidad de jefe infiltrado (20% de probabilidad)
            coliseumState.isBossInfiltrated = Math.random() < 0.2;
            
            if (coliseumState.isBossInfiltrated) {
                // Crear un jefe infiltrado con una carta dorada exclusiva
                const bossCard = {
                    id: 999,
                    name: "Jefe Infiltrado",
                    rarity: "legendary",
                    baseAtk: 150 * difficulty,
                    baseDef: 100 * difficulty,
                    level: 1,
                    img: "https://cdn2.hentaigifz.com/116566/hentai-milf-susan-long-american-dragon-jake-long-scaled.webp",
                    shopPrice: null
                };
                
                opponentCards.push(bossCard);
                
                // A√±adir 2 cartas normales adicionales
                for (let i = 0; i < 2; i++) {
                    const randomCard = {...ALL_CARDS[Math.floor(Math.random() * ALL_CARDS.length)]};
                    randomCard.atk = Math.round(randomCard.atk * difficulty);
                    randomCard.def = Math.round(randomCard.def * difficulty);
                    opponentCards.push(randomCard);
                }
                
                // Actualizar UI para mostrar que es un jefe infiltrado
                document.getElementById('coliseumOpponentImage').classList.add('boss-infiltrated');
                document.getElementById('coliseumOpponentName').textContent = "¬°JEFE INFILTRADO!";
            } else {
                // Crear 3 cartas normales para el oponente
                for (let i = 0; i < 3; i++) {
                    const randomCard = {...ALL_CARDS[Math.floor(Math.random() * ALL_CARDS.length)]};
                    randomCard.atk = Math.round(randomCard.atk * difficulty);
                    randomCard.def = Math.round(randomCard.def * difficulty);
                    opponentCards.push(randomCard);
                }
                
                // Actualizar UI para oponente normal
                document.getElementById('coliseumOpponentImage').classList.remove('boss-infiltrated');
                document.getElementById('coliseumOpponentName').textContent = `Oponente ${coliseumState.currentOpponent + 1}`;
            }
            
            coliseumState.opponentCards = opponentCards;
            coliseumState.opponentHealth = 100;
            coliseumState.maxOpponentHealth = 100;
            
            renderColiseumCards();
            updateColiseumHealthBars();
        }
        
        function renderColiseumCards() {
            const container = document.getElementById('coliseumCards');
            container.innerHTML = '';
            
            // Renderizar cartas del jugador
            coliseumState.playerCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'coliseum-card';
                cardElement.innerHTML = `
                    <img src="${card.img}" alt="${card.name}">
                    <div class="font-bold text-sm">${card.name}</div>
                    <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                `;
                container.appendChild(cardElement);
            });
            
            // Renderizar cartas del oponente
            coliseumState.opponentCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'coliseum-card';
                cardElement.innerHTML = `
                    <img src="${card.img}" alt="${card.name}">
                    <div class="font-bold text-sm">${card.name}</div>
                    <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                `;
                container.appendChild(cardElement);
            });
        }
        
        function updateColiseumHealthBars() {
            // Actualizar barra de vida del jugador
            const playerHealthPercent = (coliseumState.playerHealth / coliseumState.maxPlayerHealth) * 100;
            document.getElementById('coliseumPlayerHealthBar').style.width = `${playerHealthPercent}%`;
            document.getElementById('coliseumPlayerHealthText').textContent = `${Math.ceil(coliseumState.playerHealth)} / ${coliseumState.maxPlayerHealth}`;
            
            // Actualizar barra de vida del oponente
            const opponentHealthPercent = (coliseumState.opponentHealth / coliseumState.maxOpponentHealth) * 100;
            document.getElementById('coliseumOpponentHealthBar').style.width = `${opponentHealthPercent}%`;
            document.getElementById('coliseumOpponentHealthText').textContent = `${Math.ceil(coliseumState.opponentHealth)} / ${coliseumState.maxOpponentHealth}`;
        }
        
        function startAutoBattle() {
            // Iniciar batalla autom√°tica cada 2 segundos
            coliseumState.battleInterval = setInterval(() => {
                if (!coliseumState.active) return;
                
                // Turno del jugador
                playerAutoAttack();
                
                // Comprobar si el oponente ha sido derrotado
                if (coliseumState.opponentHealth <= 0) {
                    handleOpponentDefeated();
                    return;
                }
                
                // Turno del oponente despu√©s de un breve retraso
                setTimeout(() => {
                    if (!coliseumState.active) return;
                    
                    opponentAutoAttack();
                    
                    // Comprobar si el jugador ha sido derrotado
                    if (coliseumState.playerHealth <= 0) {
                        handlePlayerDefeated();
                    }
                }, 1000);
            }, 2000);
        }
        
        function playerAutoAttack() {
            // Seleccionar una carta aleatoria del jugador
            if (coliseumState.playerCards.length === 0) return;
            
            const attacker = coliseumState.playerCards[Math.floor(Math.random() * coliseumState.playerCards.length)];
            
            // Seleccionar una carta aleatoria del oponente
            if (coliseumState.opponentCards.length === 0) return;
            
            const target = coliseumState.opponentCards[Math.floor(Math.random() * coliseumState.opponentCards.length)];
            
            // Calcular da√±o
            const damage = Math.max(1, attacker.atk - Math.round(target.def * 0.3));
            coliseumState.opponentHealth -= damage;
            
            // Actualizar mensaje
            document.getElementById('coliseumMessage').textContent = `${attacker.name} ataca a ${target.name} y causa ${damage} de da√±o.`;
            
            // Efectos de c√°mara y sacudidas
            const opponentImage = document.getElementById('coliseumOpponentImage');
            opponentImage.classList.add('shaking');
            setTimeout(() => opponentImage.classList.remove('shaking'), 500);
            
            // Actualizar barras de vida
            updateColiseumHealthBars();
        }
        
        function opponentAutoAttack() {
            // Seleccionar una carta aleatoria del oponente
            if (coliseumState.opponentCards.length === 0) return;
            
            const attacker = coliseumState.opponentCards[Math.floor(Math.random() * coliseumState.opponentCards.length)];
            
            // Seleccionar una carta aleatoria del jugador
            if (coliseumState.playerCards.length === 0) return;
            
            const target = coliseumState.playerCards[Math.floor(Math.random() * coliseumState.playerCards.length)];
            
            // Calcular da√±o
            const damage = Math.max(1, attacker.atk - Math.round(target.def * 0.3));
            coliseumState.playerHealth -= damage;
            
            // Actualizar mensaje
            document.getElementById('coliseumMessage').textContent = `${attacker.name} ataca a ${target.name} y causa ${damage} de da√±o.`;
            
            // Efectos de c√°mara y sacudidas
            const coliseumCards = document.querySelectorAll('.coliseum-card');
            coliseumCards.forEach(card => {
                card.classList.add('shaking');
                setTimeout(() => card.classList.remove('shaking'), 500);
            });
            
            // Actualizar barras de vida
            updateColiseumHealthBars();
        }
        
        function handleOpponentDefeated() {
            // Detener la batalla actual
            clearInterval(coliseumState.battleInterval);
            
            // Incrementar el multiplicador
            coliseumState.multiplier++;
            
            // Actualizar el mejor multiplicador si es necesario
            if (coliseumState.multiplier > gameState.coliseumBestMultiplier) {
                gameState.coliseumBestMultiplier = coliseumState.multiplier;
            }
            
            // Comprobar si es un jefe infiltrado
            if (coliseumState.isBossInfiltrated) {
                // A√±adir la carta del jefe al mazo del jugador
                const bossCard = coliseumState.opponentCards[0];
                if (!gameState.ownedCardIds.includes(bossCard.id)) {
                    gameState.ownedCardIds.push(bossCard.id);
                    gameState.coliseumBossDefeated.push(bossCard.id);
                    
                    // Mostrar mensaje especial
                    document.getElementById('coliseumMessage').textContent = `¬°Has derrotado al Jefe Infiltrado! Has obtenido la carta exclusiva: ${bossCard.name}.`;
                    
                    // Desbloquear logro
                    unlockAchievement(27);
                }
            }
            
            // Comprobar si hay m√°s oponentes
            coliseumState.currentOpponent++;
            
            if (coliseumState.currentOpponent < coliseumState.maxOpponents) {
                // Mostrar opciones de riesgo
                document.getElementById('riskMultiplier').style.display = 'block';
                document.getElementById('multiplierValue').textContent = coliseumState.multiplier;
                document.getElementById('riskButtons').style.display = 'flex';
                
                // Calcular recompensa actual
                const currentReward = coliseumState.baseReward * coliseumState.multiplier;
                document.getElementById('coliseumMessage').textContent = `¬°Has derrotado al oponente! Recompensa actual: ${currentReward} gemas.`;
                
                // Comprobar logros
                if (currentReward >= 500) {
                    unlockAchievement(25);
                }
                if (coliseumState.multiplier >= 5) {
                    unlockAchievement(26);
                }
            } else {
                // El jugador ha derrotado a todos los oponentes
                endColiseum(true);
            }
        }
        
        function handlePlayerDefeated() {
            // El jugador ha sido derrotado
            endColiseum(false);
        }
        
        function collectWinnings() {
            // Recoger las ganancias actuales
            const winnings = coliseumState.baseReward * coliseumState.multiplier;
            gameState.diamonds += winnings;
            gameState.coliseumWins++;
            
            // Guardar estado del juego
            saveGame();
            updateUI();
            
            // Finalizar el coliseo
            endColiseum(true);
        }
        
        function continueBattle() {
            // Continuar con el siguiente oponente
            document.getElementById('riskMultiplier').style.display = 'none';
            document.getElementById('riskButtons').style.display = 'none';
            
            // Generar nuevo oponente
            generateOpponent();
            
            // Reanudar la batalla autom√°tica
            startAutoBattle();
            
            // Actualizar mensaje
            document.getElementById('coliseumMessage').textContent = `¬°Contin√∫a la batalla contra el oponente ${coliseumState.currentOpponent + 1}!`;
        }
        
        function endColiseum(playerWon) {
            // Detener todos los intervalos
            clearInterval(coliseumState.battleInterval);
            clearInterval(coliseumState.eventInterval);
            
            coliseumState.active = false;
            
            if (playerWon) {
                // El jugador ha ganado
                const totalReward = coliseumState.baseReward * coliseumState.multiplier;
                gameState.diamonds += totalReward;
                gameState.coliseumWins++;
                
                // Mostrar recompensa
                document.getElementById('coliseumReward').style.display = 'block';
                document.getElementById('coliseumReward').textContent = `¬°FELICIDADES! Has ganado ${totalReward} gemas.`;
                
                // Comprobar logros
                if (gameState.coliseumWins >= 5) {
                    unlockAchievement(24);
                }
                
                // Mostrar fuegos artificiales
                startFireworks();
            } else {
                // El jugador ha perdido
                document.getElementById('coliseumReward').style.display = 'block';
                document.getElementById('coliseumReward').textContent = "HAS SIDO DERROTADO... Has perdido todas tus gemas.";
            }
            
            // Actualizar UI
            document.getElementById('riskMultiplier').style.display = 'none';
            document.getElementById('riskButtons').style.display = 'none';
            document.getElementById('startColiseumBtn').style.display = 'inline-block';
            document.getElementById('resetColiseumBtn').style.display = 'none';
            
            // Guardar estado del juego
            saveGame();
            updateUI();
            checkAchievements();
        }
        
        function startArenaEvents() {
            // Iniciar eventos aleatorios cada 5-10 segundos
            coliseumState.eventInterval = setInterval(() => {
                if (!coliseumState.active) return;
                
                // 30% de probabilidad de que ocurra un evento
                if (Math.random() < 0.3) {
                    triggerRandomEvent();
                }
            }, Math.random() * 5000 + 5000);
        }
        
        function triggerRandomEvent() {
            const eventContainer = document.getElementById('arenaEvent');
            
            // Limpiar eventos anteriores
            eventContainer.innerHTML = '';
            
            // Elegir un evento aleatorio
            const eventType = Math.random();
            
            if (eventType < 0.5) {
                // Evento de rayo (50% de probabilidad)
                const lightning = document.createElement('div');
                lightning.className = 'lightning';
                lightning.style.left = Math.random() * 100 + '%';
                eventContainer.appendChild(lightning);
                
                // Efecto del rayo: quita vida a una carta al azar
                const targetPlayer = Math.random() < 0.5;
                const cards = targetPlayer ? coliseumState.playerCards : coliseumState.opponentCards;
                
                if (cards.length > 0) {
                    const targetCard = cards[Math.floor(Math.random() * cards.length)];
                    const damage = Math.floor(Math.random() * 20) + 10; // Da√±o entre 10 y 30
                    
                    if (targetPlayer) {
                        coliseumState.playerHealth -= damage;
                    } else {
                        coliseumState.opponentHealth -= damage;
                    }
                    
                    document.getElementById('coliseumMessage').textContent = `¬°Un rayo ha golpeado a ${targetCard.name} y le ha causado ${damage} de da√±o!`;
                    updateColiseumHealthBars();
                }
                
                // Eliminar el rayo despu√©s de la animaci√≥n
                setTimeout(() => {
                    if (eventContainer.contains(lightning)) {
                        eventContainer.removeChild(lightning);
                    }
                }, 500);
            } else {
                // Evento de regalo (50% de probabilidad)
                const gift = document.createElement('div');
                gift.className = 'gift';
                gift.style.left = Math.random() * 100 + '%';
                eventContainer.appendChild(gift);
                
                // Efecto del regalo: cura a todos
                const playerHeal = Math.floor(Math.random() * 20) + 10; // Curaci√≥n entre 10 y 30
                const opponentHeal = Math.floor(Math.random() * 20) + 10; // Curaci√≥n entre 10 y 30
                
                coliseumState.playerHealth = Math.min(coliseumState.maxPlayerHealth, coliseumState.playerHealth + playerHeal);
                coliseumState.opponentHealth = Math.min(coliseumState.maxOpponentHealth, coliseumState.opponentHealth + opponentHeal);
                
                document.getElementById('coliseumMessage').textContent = `¬°Un regalo ha ca√≠do del cielo! Todos han recuperado vida.`;
                updateColiseumHealthBars();
                
                // Eliminar el regalo despu√©s de la animaci√≥n
                setTimeout(() => {
                    if (eventContainer.contains(gift)) {
                        eventContainer.removeChild(gift);
                    }
                }, 2000);
            }
        }
        
        function spectatorVote(choice) {
            if (!coliseumState.active) return;
            
            coliseumState.votes[choice]++;
            
            // A√±adir mensaje al chat
            const chatMessages = document.getElementById('chatMessages');
            const message = document.createElement('div');
            message.className = 'chat-message';
            message.innerHTML = `<span class="chat-username">Espectador:</span> ¬°Voto por ${choice === 'player' ? 'el jugador' : 'el oponente'}!`;
            chatMessages.appendChild(message);
            
            // Mantener el scroll al final
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        // Funciones para el modo Arena
        function initArena() {
            if (!arenaState.active) {
                resetArena();
            }
            updateArenaUI();
            renderArenaCards();
            updateArenaHealthBars();
        }
        
        function startArena() {
            if (arenaState.active) {
                if (!confirm("¬øReiniciar la Arena actual? Perder√°s tu progreso.")) return;
            }
            
            resetArena();
            arenaState.active = true;
            
            // Cargar el estado del juego
            arenaState.rank = gameState.arenaRank;
            arenaState.progress = gameState.arenaProgress;
            arenaState.winsInRank = gameState.arenaProgress % 5;
            
            // Seleccionar 3 cartas aleatorias del jugador
            const availableCards = ALL_CARDS.filter(card => gameState.ownedCardIds.includes(card.id));
            const selectedCards = [];
            
            for (let i = 0; i < 3; i++) {
                if (availableCards.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableCards.length);
                    const card = availableCards[randomIndex];
                    selectedCards.push({...card});
                    availableCards.splice(randomIndex, 1);
                }
            }
            
            arenaState.playerCards = selectedCards;
            
            // Generar enemigo inicial basado en el rango actual
            generateArenaEnemy();
            
            // Iniciar batalla autom√°tica
            startArenaAutoBattle();
            
            // Actualizar UI
            document.getElementById('startArenaBtn').style.display = 'none';
            document.getElementById('resetArenaBtn').style.display = 'inline-block';
            document.getElementById('arenaMessage').textContent = `¬°Comienza la batalla contra ${ARENA_RANKS[arenaState.rank].enemyName}!`;
            
            // Desbloquear logro
            unlockAchievement(28);
        }
        
        function resetArena() {
            // Limpiar intervalos si existen
            if (arenaState.battleInterval) {
                clearInterval(arenaState.battleInterval);
                arenaState.battleInterval = null;
            }
            
            // Reiniciar estado del juego
            arenaState = {
                active: false,
                playerHealth: 100,
                maxPlayerHealth: 100,
                enemyHealth: 100,
                maxEnemyHealth: 100,
                playerCards: [],
                enemyCards: [],
                battleInterval: null,
                currentEnemy: null,
                rank: 0,
                progress: 0,
                winsInRank: 0,
                winsNeededForRankUp: 5
            };
            
            // Actualizar UI
            document.getElementById('startArenaBtn').style.display = 'inline-block';
            document.getElementById('resetArenaBtn').style.display = 'none';
            document.getElementById('arenaMessage').textContent = "Presiona 'INICIAR ARENA' para comenzar tu camino";
            
            renderArenaCards();
            updateArenaHealthBars();
            updateArenaUI();
        }
        
        function generateArenaEnemy() {
            // Obtener informaci√≥n del rango actual
            const currentRank = ARENA_RANKS[arenaState.rank];
            
            // Generar cartas para el enemigo basadas en el rango
            const enemyCards = [];
            const difficulty = currentRank.enemyMultiplier;
            
            // Crear 3 cartas para el enemigo con dificultad ajustada
            for (let i = 0; i < 3; i++) {
                const randomCard = {...ALL_CARDS[Math.floor(Math.random() * ALL_CARDS.length)]};
                randomCard.atk = Math.round(randomCard.atk * difficulty);
                randomCard.def = Math.round(randomCard.def * difficulty);
                enemyCards.push(randomCard);
            }
            
            arenaState.enemyCards = enemyCards;
            arenaState.enemyHealth = 100;
            arenaState.maxEnemyHealth = 100;
            arenaState.currentEnemy = currentRank;
            
            // Actualizar UI
            document.getElementById('arenaEnemyName').textContent = currentRank.enemyName;
            document.getElementById('arenaEnemyRank').textContent = currentRank.name;
            
            renderArenaCards();
            updateArenaHealthBars();
            updateArenaUI();
        }
        
        function renderArenaCards() {
            const container = document.getElementById('arenaCards');
            container.innerHTML = '';
            
            // Renderizar cartas del jugador
            arenaState.playerCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'arena-card';
                cardElement.innerHTML = `
                    <img src="${card.img}" alt="${card.name}">
                    <div class="font-bold text-sm">${card.name}</div>
                    <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                `;
                container.appendChild(cardElement);
            });
            
            // Renderizar cartas del enemigo
            arenaState.enemyCards.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'arena-card';
                cardElement.innerHTML = `
                    <img src="${card.img}" alt="${card.name}">
                    <div class="font-bold text-sm">${card.name}</div>
                    <div class="text-xs">‚öîÔ∏è ${card.atk} üõ°Ô∏è ${card.def}</div>
                `;
                container.appendChild(cardElement);
            });
        }
        
        function updateArenaHealthBars() {
            // Actualizar barra de vida del jugador
            const playerHealthPercent = (arenaState.playerHealth / arenaState.maxPlayerHealth) * 100;
            document.getElementById('arenaEnemyHealthBar').style.width = `${playerHealthPercent}%`;
            document.getElementById('arenaEnemyHealthText').textContent = `${Math.ceil(arenaState.playerHealth)} / ${arenaState.maxPlayerHealth}`;
            
            // Actualizar barra de vida del enemigo
            const enemyHealthPercent = (arenaState.enemyHealth / arenaState.maxEnemyHealth) * 100;
            document.getElementById('arenaEnemyHealthBar').style.width = `${enemyHealthPercent}%`;
            document.getElementById('arenaEnemyHealthText').textContent = `${Math.ceil(arenaState.enemyHealth)} / ${arenaState.maxEnemyHealth}`;
        }
        
        function updateArenaUI() {
            // Actualizar informaci√≥n del rango
            const currentRank = ARENA_RANKS[arenaState.rank];
            document.getElementById('arenaRank').textContent = currentRank.name;
            
            // Actualizar barra de progreso
            const progressPercent = (arenaState.winsInRank / arenaState.winsNeededForRankUp) * 100;
            document.getElementById('arenaProgressFill').style.width = `${progressPercent}%`;
            document.getElementById('arenaProgressText').textContent = `${arenaState.winsInRank} / ${arenaState.winsNeededForRankUp} victorias`;
            
            // Actualizar recompensas
            document.getElementById('gemsPerVictory').textContent = currentRank.gemsPerVictory;
            document.getElementById('rankReward').textContent = `${currentRank.rankReward} gemas`;
        }
        
        function startArenaAutoBattle() {
            // Iniciar batalla autom√°tica cada 2 segundos
            arenaState.battleInterval = setInterval(() => {
                if (!arenaState.active) return;
                
                // Turno del jugador
                arenaPlayerAutoAttack();
                
                // Comprobar si el enemigo ha sido derrotado
                if (arenaState.enemyHealth <= 0) {
                    handleArenaEnemyDefeated();
                    return;
                }
                
                // Turno del enemigo despu√©s de un breve retraso
                setTimeout(() => {
                    if (!arenaState.active) return;
                    
                    arenaEnemyAutoAttack();
                    
                    // Comprobar si el jugador ha sido derrotado
                    if (arenaState.playerHealth <= 0) {
                        handleArenaPlayerDefeated();
                    }
                }, 1000);
            }, 2000);
        }
        
        function arenaPlayerAutoAttack() {
            // Seleccionar una carta aleatoria del jugador
            if (arenaState.playerCards.length === 0) return;
            
            const attacker = arenaState.playerCards[Math.floor(Math.random() * arenaState.playerCards.length)];
            
            // Seleccionar una carta aleatoria del enemigo
            if (arenaState.enemyCards.length === 0) return;
            
            const target = arenaState.enemyCards[Math.floor(Math.random() * arenaState.enemyCards.length)];
            
            // Calcular da√±o
            const damage = Math.max(1, attacker.atk - Math.round(target.def * 0.3));
            arenaState.enemyHealth -= damage;
            
            // Actualizar mensaje
            document.getElementById('arenaMessage').textContent = `${attacker.name} ataca a ${target.name} y causa ${damage} de da√±o.`;
            
            // Efectos de c√°mara y sacudidas
            const enemyImage = document.getElementById('arenaEnemyImage');
            enemyImage.classList.add('shaking');
            setTimeout(() => enemyImage.classList.remove('shaking'), 500);
            
            // Actualizar barras de vida
            updateArenaHealthBars();
        }
        
        function arenaEnemyAutoAttack() {
            // Seleccionar una carta aleatoria del enemigo
            if (arenaState.enemyCards.length === 0) return;
            
            const attacker = arenaState.enemyCards[Math.floor(Math.random() * arenaState.enemyCards.length)];
            
            // Seleccionar una carta aleatoria del jugador
            if (arenaState.playerCards.length === 0) return;
            
            const target = arenaState.playerCards[Math.floor(Math.random() * arenaState.playerCards.length)];
            
            // Calcular da√±o
            const damage = Math.max(1, attacker.atk - Math.round(target.def * 0.3));
            arenaState.playerHealth -= damage;
            
            // Actualizar mensaje
            document.getElementById('arenaMessage').textContent = `${attacker.name} ataca a ${target.name} y causa ${damage} de da√±o.`;
            
            // Efectos de c√°mara y sacudidas
            const arenaCards = document.querySelectorAll('.arena-card');
            arenaCards.forEach(card => {
                card.classList.add('shaking');
                setTimeout(() => card.classList.remove('shaking'), 500);
            });
            
            // Actualizar barras de vida
            updateArenaHealthBars();
        }
        
        function handleArenaEnemyDefeated() {
            // Detener la batalla actual
            clearInterval(arenaState.battleInterval);
            
            // Incrementar victorias y progreso
            arenaState.winsInRank++;
            arenaState.progress++;
            gameState.arenaProgress = arenaState.progress;
            gameState.arenaTotalWins++;
            gameState.arenaWinStreak++;
            
            // Obtener recompensa por victoria
            const currentRank = ARENA_RANKS[arenaState.rank];
            const victoryReward = currentRank.gemsPerVictory;
            gameState.diamonds += victoryReward;
            gameState.arenaTotalGems += victoryReward;
            
            // Actualizar mensaje
            document.getElementById('arenaMessage').textContent = `¬°Has derrotado a ${currentRank.enemyName}! Has obtenido ${victoryReward} gemas.`;
            
            // Comprobar si es hora de subir de rango
            if (arenaState.winsInRank >= arenaState.winsNeededForRankUp) {
                // Subir de rango
                if (arenaState.rank < ARENA_RANKS.length - 1) {
                    arenaState.rank++;
                    gameState.arenaRank = arenaState.rank;
                    arenaState.winsInRank = 0;
                    
                    // Obtener recompensa de rango
                    const rankReward = currentRank.rankReward;
                    gameState.diamonds += rankReward;
                    gameState.arenaTotalGems += rankReward;
                    
                    // Mostrar ventana de subida de rango
                    showRankUp(arenaState.rank, rankReward);
                    
                    // Generar nuevo enemigo con mayor dificultad
                    setTimeout(() => {
                        generateArenaEnemy();
                        startArenaAutoBattle();
                        document.getElementById('arenaMessage').textContent = `¬°Nuevo desaf√≠o! Enfr√©ntate a ${ARENA_RANKS[arenaState.rank].enemyName}.`;
                    }, 3000);
                } else {
                    // El jugador ha alcanzado el rango m√°ximo
                    document.getElementById('arenaMessage').textContent = `¬°FELICIDADES! Has alcanzado el rango m√°ximo: ${ARENA_RANKS[arenaState.rank].name}.`;
                    endArena(true);
                }
            } else {
                // Generar nuevo enemigo del mismo rango
                setTimeout(() => {
                    generateArenaEnemy();
                    startArenaAutoBattle();
                    document.getElementById('arenaMessage').textContent = `¬°Sigue adelante! Enfr√©ntate a otro ${currentRank.enemyName}.`;
                }, 2000);
            }
            
            // Actualizar UI y guardar estado del juego
            updateArenaUI();
            saveGame();
            updateUI();
            checkAchievements();
        }
        
        function handleArenaPlayerDefeated() {
            // El jugador ha sido derrotado
            clearInterval(arenaState.battleInterval);
            gameState.arenaWinStreak = 0;
            
            document.getElementById('arenaMessage').textContent = "HAS SIDO DERROTADO... Tu racha de victorias ha terminado.";
            
            // Actualizar UI y guardar estado del juego
            updateArenaUI();
            saveGame();
            updateUI();
            checkAchievements();
            
            // No terminar el modo arena, permitir continuar
            setTimeout(() => {
                arenaState.playerHealth = arenaState.maxPlayerHealth;
                generateArenaEnemy();
                startArenaAutoBattle();
                document.getElementById('arenaMessage').textContent = "¬°Recup√©rate y vuelve a la batalla!";
                updateArenaHealthBars();
            }, 3000);
        }
        
        function showRankUp(rank, reward) {
            const rankName = ARENA_RANKS[rank - 1].name;
            document.getElementById('rankUpRank').textContent = rankName;
            document.getElementById('rankUpRewards').textContent = `Has obtenido ${reward} gemas por subir de rango.`;
            document.getElementById('arenaRankUp').style.display = 'block';
        }
        
        function closeRankUp() {
            document.getElementById('arenaRankUp').style.display = 'none';
        }
        
        function endArena(playerWon) {
            // Detener la batalla
            clearInterval(arenaState.battleInterval);
            arenaState.active = false;
            
            if (playerWon) {
                // El jugador ha completado todos los rangos
                document.getElementById('arenaMessage').textContent = `¬°FELICIDADES! Has completado todos los rangos del Modo Arena. Eres un verdadero campe√≥n.`;
                
                // Recompensa especial por completar todos los rangos
                const completionReward = 5000;
                gameState.diamonds += completionReward;
                gameState.arenaTotalGems += completionReward;
                
                // Mostrar fuegos artificiales
                startFireworks();
            }
            
            // Actualizar UI
            document.getElementById('startArenaBtn').style.display = 'inline-block';
            document.getElementById('resetArenaBtn').style.display = 'none';
            
            // Guardar estado del juego
            saveGame();
            updateUI();
            checkAchievements();
        }
        
        updateUI();
        showView('battle');
        createSnowflakes();
        checkAchievements();
        renderAchievements();
    </script>
</body>
</html>
