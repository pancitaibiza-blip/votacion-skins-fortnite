<!DOCTYPE html>
<html lang="es">
<head>
ย ย <meta charset="UTF-8" />
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
ย ย <title>๐ Fortnite Cartas - Evento Navideรฑo</title>
ย ย <script src="https://cdn.tailwindcss.com"></script>
ย ย <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
ย ย <style>
ย ย ย ย body {
ย ย ย ย ย ย background: linear-gradient(135deg, #b22222, #228b22, #ffd700, #ffffff);
ย ย ย ย ย ย background-size: 400% 400%;
ย ย ย ย ย ย animation: gradientBG 30s ease infinite;
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย min-height: 100vh;
ย ย ย ย ย ย margin: 0;
ย ย ย ย ย ย font-family: 'Segoe UI', sans-serif;
ย ย ย ย ย ย overflow-x: hidden;
ย ย ย ย ย ย position: relative;
ย ย ย ย }
ย ย ย ย body::before {
ย ย ย ย ย ย content: "๐";
ย ย ย ย ย ย position: absolute;
ย ย ย ย ย ย top: 10px;
ย ย ย ย ย ย left: 10px;
ย ย ย ย ย ย font-size: 24px;
ย ย ย ย ย ย opacity: 0.7;
ย ย ย ย ย ย z-index: 1;
ย ย ย ย }
ย ย ย ย body::after {
ย ย ย ย ย ย content: "โ๏ธ";
ย ย ย ย ย ย position: absolute;
ย ย ย ย ย ย bottom: 20px;
ย ย ย ย ย ย right: 20px;
ย ย ย ย ย ย font-size: 28px;
ย ย ย ย ย ย opacity: 0.6;
ย ย ย ย ย ย z-index: 1;
ย ย ย ย }
ย ย ย ย @keyframes gradientBG {
ย ย ย ย ย ย 0% { background-position: 0% 50%; }
ย ย ย ย ย ย 50% { background-position: 100% 50%; }
ย ย ย ย ย ย 100% { background-position: 0% 50%; }
ย ย ย ย }
ย ย ย ย .snowflake {
ย ย ย ย ย ย position: absolute;
ย ย ย ย ย ย background: white;
ย ย ย ย ย ย border-radius: 50%;
ย ย ย ย ย ย pointer-events: none;
ย ย ย ย ย ย animation: fall linear infinite;
ย ย ย ย ย ย z-index: 0;
ย ย ย ย }
ย ย ย ย @keyframes fall {
ย ย ย ย ย ย 0% { top: -10vh; transform: translateX(0) rotate(0deg); }
ย ย ย ย ย ย 100% { top: 110vh; transform: translateX(0) rotate(360deg); }
ย ย ย ย }
ย ย ย ย .btn {
ย ย ย ย ย ย background: linear-gradient(to right, #d42020, #ff4545);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย padding: 10px 20px;
ย ย ย ย ย ย margin: 4px;
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย transition: all 0.3s ease;
ย ย ย ย ย ย box-shadow: 0 4px 8px rgba(0,0,0,0.2);
ย ย ย ย }
ย ย ย ย .btn:hover {
ย ย ย ย ย ย transform: scale(1.05);
ย ย ย ย ย ย box-shadow: 0 6px 12px rgba(255, 200, 200, 0.8);
ย ย ย ย }
ย ย ย ย .card-container {
ย ย ย ย ย ย position: relative;
ย ย ย ย ย ย display: inline-block;
ย ย ย ย ย ย margin: 4px;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย transition: transform 0.3s ease;
ย ย ย ย ย ย will-change: transform;
ย ย ย ย }
ย ย ย ย .card-container:hover {
ย ย ย ย ย ย transform: translateY(-5px);
ย ย ย ย }
ย ย ย ย .card-base {
ย ย ย ย ย ย border-radius: 16px;
ย ย ย ย ย ย overflow: hidden;
ย ย ย ย ย ย position: relative;
ย ย ย ย ย ย width: 160px;
ย ย ย ย ย ย background: rgba(10, 15, 25, 0.95);
ย ย ย ย ย ย box-shadow: 0 4px 15px rgba(0,0,0,0.3);
ย ย ย ย ย ย transition: transform 0.5s ease;
ย ย ย ย }
ย ย ย ย .card-container:hover .card-base {
ย ย ย ย ย ย transform: scale(1.05);
ย ย ย ย }
ย ย ย ย .card-glow {
ย ย ย ย ย ย position: absolute;
ย ย ย ย ย ย top: -10px;
ย ย ย ย ย ย left: -10px;
ย ย ย ย ย ย right: -10px;
ย ย ย ย ย ย bottom: -10px;
ย ย ย ย ย ย border-radius: 24px;
ย ย ย ย ย ย z-index: -1;
ย ย ย ย ย ย opacity: 0.7;
ย ย ย ย ย ย filter: blur(12px);
ย ย ย ย ย ย transition: opacity 0.3s ease;
ย ย ย ย }
ย ย ย ย .card-container:hover .card-glow {
ย ย ย ย ย ย opacity: 1;
ย ย ย ย }
ย ย ย ย .rarity-common .card-glow { background: #9e9e9e; }
ย ย ย ย .rarity-rare .card-glow { background: #4caf50; }
ย ย ย ย .rarity-epic .card-glow { background: #9c27b0; }
ย ย ย ย .rarity-legendary .card-glow { background: #d4a017; }
        .rarity-collaboration .card-glow { background: linear-gradient(45deg, #00bfff, #ff4500, #ffff00); opacity: 0.9; filter: blur(15px); animation: collabGlow 3s infinite alternate; }
        .rarity-collaboration .card-base { border: 3px solid #00bfff; box-shadow: 0 0 25px #ff4500; }
        @keyframes collabGlow {
            0% { transform: scale(1); opacity: 0.7; }
            100% { transform: scale(1.05); opacity: 1; }
        }
ย ย ย ย .rarity-idolos .card-glow { background: linear-gradient(45deg, #ff9800, #ff4081, #ffc107); opacity: 0.8; filter: blur(15px); animation: glowPulse 2s infinite alternate; }
ย ย ย ย @keyframes glowPulse {
ย ย ย ย ย ย 0% { transform: scale(1); opacity: 0.6; }
ย ย ย ย ย ย 100% { transform: scale(1.1); opacity: 1; }
ย ย ย ย }
ย ย ย ย .rarity-idolos .card-base { box-shadow: 0 0 20px #ff9800, 0 0 30px #ff4081; }
ย ย ย ย .rarity-tournament .card-glow { background: #f44336; }
ย ย ย ย .rarity-paises .card-glow { background: linear-gradient(45deg, #ff0000, #ffffff, #0000ff); opacity: 0.8; filter: blur(15px); animation: glowPulse 2s infinite alternate; }
ย ย ย ย .rarity-paises .card-base { box-shadow: 0 0 20px #ff0000, 0 0 30px #0000ff; }
ย ย ย ย .card-content {
ย ย ย ย ย ย padding: 8px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย position: relative;
ย ย ย ย ย ย z-index: 2;
ย ย ย ย }
ย ย ย ย .card-content img {
ย ย ย ย ย ย transition: transform 0.5s ease;
ย ย ย ย }
ย ย ย ย .card-container:hover .card-content img {
ย ย ย ย ย ย transform: scale(1.05);
ย ย ย ย }
ย ย ย ย .upgrade-badge {
ย ย ย ย ย ย position: absolute;
ย ย ย ย ย ย top: 8px;
ย ย ย ย ย ย right: 8px;
ย ย ย ย ย ย background: linear-gradient(to bottom, #ffd700, #d4af37);
ย ย ย ย ย ย color: #333;
ย ย ย ย ย ย font-size: 12px;
ย ย ย ย ย ย padding: 2px 6px;
ย ย ย ย ย ย border-radius: 6px;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย box-shadow: 0 1px 3px rgba(0,0,0,0.2);
ย ย ย ย }
ย ย ย ย .stats-bar {
ย ย ย ย ย ย background: rgba(10, 20, 10, 0.9);
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย padding: 16px;
ย ย ย ย ย ย margin: 24px 0;
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย gap: 24px;
ย ย ย ย ย ย border: 1px solid rgba(212, 32, 32, 0.5);
ย ย ย ย ย ย box-shadow: 0 4px 15px rgba(0,0,0,0.3);
ย ย ย ย }
ย ย ย ย .stat { font-weight: bold; font-size: 20px; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
ย ย ย ย .trophy { color: #FFD700; }
ย ย ย ย .gem { color: #4FC3F7; }
ย ย ย ย .crown { color: #FFAA00; }
ย ย ย ย #offerBanner {
ย ย ย ย ย ย background: linear-gradient(to right, #ff416c, #ff4b2b);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย padding: 12px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย font-size: 20px;
ย ย ย ย ย ย position: fixed;
ย ย ย ย ย ย top: 0;
ย ย ย ย ย ย left: 0;
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย z-index: 1000;
ย ย ย ย ย ย box-shadow: 0 4px 12px rgba(0,0,0,0.4);
ย ย ย ย }
        #collaborationBanner {
            background: linear-gradient(to right, #ffeb3b, #ff9800);
            color: #333;
            padding: 12px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            position: fixed;
            top: 50px;
            left: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.4);
        }
ย ย ย ย #gemsCountdown {
ย ย ย ย ย ย display: inline-block;
ย ย ย ย ย ย background: rgba(0,0,0,0.8);
ย ย ย ย ย ย color: gold;
ย ย ย ย ย ย padding: 4px 10px;
ย ย ย ย ย ย border-radius: 8px;
ย ย ย ย ย ย margin-left: 10px;
ย ย ย ย }
ย ย ย ย #deck, #shop, #tournament, #cupMode, #ranking, #achievements { display: none; }
ย ย ย ย #deck.active, #shop.active, #tournament.active, #cupMode.active, #ranking.active, #achievements.active { display: block; }
ย ย ย ย .card-grid {
ย ย ย ย ย ย display: grid;
ย ย ย ย ย ย grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
ย ย ย ย ย ย gap: 16px;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย margin-top: 20px;
ย ย ย ย }
ย ย ย ย .filter-bar { text-align: center; margin-bottom: 20px; }
ย ย ย ย .filter-bar select {
ย ย ย ย ย ย background: rgba(51,51,51,0.9);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย padding: 8px 16px;
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย border: 1px solid rgba(85,85,85,0.5);
ย ย ย ย ย ย box-shadow: 0 2px 6px rgba(0,0,0,0.2);
ย ย ย ย }
ย ย ย ย #cardModal {
ย ย ย ย ย ย position: fixed;
ย ย ย ย ย ย top: 0;
ย ย ย ย ย ย left: 0;
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย height: 100%;
ย ย ย ย ย ย background: rgba(0,0,0,0.85);
ย ย ย ย ย ย display: none;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย z-index: 3000;
ย ย ย ย ย ย backdrop-filter: blur(5px);
ย ย ย ย }
ย ย ย ย #cardModalContent {
ย ย ย ย ย ย background: rgba(20, 20, 40, 0.98);
ย ย ย ย ย ย border-radius: 24px;
ย ย ย ย ย ย padding: 40px;
ย ย ย ย ย ย max-width: 450px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย border: 4px solid rgba(255,215,0,0.5);
ย ย ย ย ย ย box-shadow: 0 0 50px rgba(255,215,0,0.3);
ย ย ย ย ย ย perspective: 1000px;
ย ย ย ย }
ย ย ย ย #cardModalImage {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย max-height: 350px;
ย ย ย ย ย ย object-fit: cover;
ย ย ย ย ย ย border-radius: 16px;
ย ย ย ย ย ย margin-bottom: 24px;
ย ย ย ย ย ย box-shadow: 0 4px 15px rgba(0,0,0,0.4);
ย ย ย ย ย ย transition: transform 0.5s ease;
ย ย ย ย }
ย ย ย ย .ranking-item {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย align-items: center;
ย ย ย ย ย ย gap: 16px;
ย ย ย ย ย ย padding: 16px;
ย ย ย ย ย ย background: rgba(30, 30, 50, 0.8);
ย ย ย ย ย ย border-radius: 16px;
ย ย ย ย ย ย margin-bottom: 12px;
ย ย ย ย ย ย box-shadow: 0 2px 8px rgba(0,0,0,0.2);
ย ย ย ย }
ย ย ย ย .ranking-avatar {
ย ย ย ย ย ย width: 50px;
ย ย ย ย ย ย height: 50px;
ย ย ย ย ย ย border-radius: 50%;
ย ย ย ย ย ย border: 3px solid gold;
ย ย ย ย ย ย box-shadow: 0 0 10px rgba(255,215,0,0.3);
ย ย ย ย ย ย background-size: cover;
ย ย ย ย ย ย background-position: center;
ย ย ย ย }
ย ย ย ย #battle {
ย ย ย ย ย ย display: none;
ย ย ย ย ย ย padding: 24px;
ย ย ย ย ย ย padding-bottom: 150px;
ย ย ย ย ย ย background: rgba(0, 0, 0, 0.4);
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย margin-top: 24px;
ย ย ย ย ย ย box-shadow: 0 4px 20px rgba(0,0,0,0.3);
ย ย ย ย }
ย ย ย ย #battle.active { display: block; }
ย ย ย ย .battle-ia-cards, .battle-player-cards {
ย ย ย ย ย ย display: flex;
ย ย ย ย ย ย justify-content: center;
ย ย ย ย ย ย gap: 24px;
ย ย ย ย ย ย flex-wrap: wrap;
ย ย ย ย ย ย perspective: 1000px;
ย ย ย ย }
ย ย ย ย .ia-card, .player-card {
ย ย ย ย ย ย background: rgba(0, 0, 0, 0.6);
ย ย ย ย ย ย border: 3px solid #d42020;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย padding: 20px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย width: 180px;
ย ย ย ย ย ย box-shadow: 0 0 25px rgba(212, 32, 32, 0.6);
ย ย ย ย ย ย transition: transform 0.5s ease, border-color 0.3s ease;
ย ย ย ย ย ย transform-style: preserve-3d;
ย ย ย ย }
ย ย ย ย .player-card { border: 3px solid #00bcd4; box-shadow: 0 0 25px rgba(0, 188, 212, 0.6); }
ย ย ย ย .ia-card.selected, .player-card.selected { border-color: yellow; }
ย ย ย ย .ia-card:hover, .player-card:hover { transform: rotateY(10deg) rotateX(5deg); }
ย ย ย ย .ia-card img, .player-card img {
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย height: 160px;
ย ย ย ย ย ย object-fit: cover;
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย margin-bottom: 12px;
ย ย ย ย }
ย ย ย ย .name { font-weight: bold; margin: 12px 0; font-size: 18px; }
ย ย ย ย .stats { display: flex; justify-content: center; gap: 12px; font-size: 16px; margin: 12px 0; }
ย ย ย ย .hp-bar { height: 10px; background: #333; border-radius: 5px; overflow: hidden; margin: 12px 0; }
ย ย ย ย .hp-fill { height: 100%; background: linear-gradient(to right, #d42020, #ff4545); transition: width 0.5s ease; }
ย ย ย ย .hp-text { font-size: 14px; text-align: center; margin-top: 6px; }
ย ย ย ย .attack-button, .defend-button {
ย ย ย ย ย ย background: linear-gradient(to right, #d42020, #ff4545);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย border: none;
ย ย ย ย ย ย padding: 14px 28px;
ย ย ย ย ย ย border-radius: 14px;
ย ย ย ย ย ย cursor: pointer;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย transition: all 0.3s ease;
ย ย ย ย ย ย box-shadow: 0 4px 12px rgba(212, 32, 32, 0.6);
ย ย ย ย ย ย margin: 0 12px;
ย ย ย ย }
ย ย ย ย .defend-button { background: linear-gradient(to right, #00bcd4, #00e5ff); box-shadow: 0 4px 12px rgba(0, 188, 212, 0.6); }
ย ย ย ย .attack-button:hover, .defend-button:hover { transform: scale(1.05); }
ย ย ย ย .section-container {
ย ย ย ย ย ย background: rgba(255, 255, 255, 0.1);
ย ย ย ย ย ย backdrop-filter: blur(10px);
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย padding: 24px;
ย ย ย ย ย ย box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
ย ย ย ย ย ย border: 1px solid rgba(255, 255, 255, 0.18);
ย ย ย ย }
ย ย ย ย #battleMessage {
ย ย ย ย ย ย display: none;
ย ย ย ย ย ย position: fixed;
ย ย ย ย ย ย top: 50%;
ย ย ย ย ย ย left: 50%;
ย ย ย ย ย ย transform: translate(-50%, -50%);
ย ย ย ย ย ย background: rgba(0, 0, 0, 0.8);
ย ย ย ย ย ย padding: 40px;
ย ย ย ย ย ย border-radius: 20px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย z-index: 2000;
ย ย ย ย ย ย box-shadow: 0 0 50px rgba(255, 255, 255, 0.5);
ย ย ย ย }
ย ย ย ย #announcementBanner {
ย ย ย ย ย ย background: linear-gradient(to right, #ffd700, #ff8c00);
ย ย ย ย ย ย color: #333;
ย ย ย ย ย ย padding: 12px;
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย font-size: 18px;
ย ย ย ย ย ย position: fixed;
ย ย ย ย ย ย top: 100px; /* Ajustado para dejar espacio al banner de colaboraciรณn */
ย ย ย ย ย ย left: 0;
ย ย ย ย ย ย width: 100%;
ย ย ย ย ย ย z-index: 1000;
ย ย ย ย ย ย box-shadow: 0 4px 12px rgba(0,0,0,0.4);
ย ย ย ย }
ย ย ย ย .nav-btn {
ย ย ย ย ย ย background: rgba(100, 100, 100, 0.7);
ย ย ย ย ย ย color: white;
ย ย ย ย ย ย border: 2px solid #555;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย transition: all 0.3s ease;
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย padding: 10px 20px;
ย ย ย ย ย ย margin: 4px;
ย ย ย ย }
ย ย ย ย .nav-btn:hover {
ย ย ย ย ย ย background: rgba(200, 200, 200, 0.9);
ย ย ย ย ย ย color: black;
ย ย ย ย ย ย border-color: #fff;
ย ย ย ย ย ย transform: scale(1.05);
ย ย ย ย }
ย ย ย ย #collectionCounter {
ย ย ย ย ย ย text-align: center;
ย ย ย ย ย ย font-size: 22px;
ย ย ย ย ย ย font-weight: bold;
ย ย ย ย ย ย margin: 15px 0;
ย ย ย ย ย ย padding: 12px;
ย ย ย ย ย ย background: rgba(0, 0, 0, 0.5);
ย ย ย ย ย ย border-radius: 12px;
ย ย ย ย ย ย text-shadow: 0 1px 3px rgba(0,0,0,0.8);
ย ย ย ย }
        .chest-container {
            background: linear-gradient(to bottom right, #5d4037, #9e9e9e);
            border: 5px solid gold;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            cursor: pointer;
            transition: transform 0.3s;
        }
        .chest-container:hover {
            transform: scale(1.05);
        }
        .locked-card {
            filter: grayscale(100%) blur(3px);
            opacity: 0.8;
            position: relative;
            cursor: default;
        }
        .locked-card .lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10;
            pointer-events: none;
            border-radius: 16px;
        }
        .locked-card .lock-overlay i {
            font-size: 40px;
            color: yellow;
            margin-bottom: 10px;
        }
        .locked-card .lock-overlay p {
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 0 5px black;
        }
ย ย </style>
</head>
<body>
ย ย <div id="offerBanner">
ย ย ย ย ๐ ยกOFERTA POR TIEMPO LIMITADO! ๐ ยก1000 GEMAS POR SOLO HOY!
ย ย ย ย <span id="gemsCountdown">--h --m --s</span>
ย ย </div>
    <div id="collaborationBanner">
        ๐ ยกPRรXIMAMENTE! CARTA DE COLABORACIรN: LOS SIMPSONS. Lanzamiento en: <span id="simpsonsCountdown">--d --h --m --s</span>
    </div>
    ย ย <div id="announcementBanner">
ย ย ย ย LA PROXIMA ACTUALIZACION SERA EL DIA 15 DE NOVIEMBRE DE 2025 ALAS 11:00 DE LA MAรANA AGREGAREMOS LOS COFRES.
ย ย </div>
ย ย <div class="container mx-auto px-4 py-6 pt-24">
ย ย ย ย <div class="text-center mb-6">
ย ย ย ย ย ย <img id="profileAvatar" src="https://rule34.xxx//samples/1888/sample_4387d777c732825ae6e377664c2ce885.jpg?15738062" alt="Avatar" class="w-20 h-20 rounded-full mx-auto border-4 border-red-500 shadow-lg">
ย ย ย ย ย ย <h2 class="text-2xl font-bold mt-3" id="playerName">Jugador</h2>
ย ย ย ย </div>
ย ย ย ย <div class="stats-bar">
ย ย ย ย ย ย <div class="stat"><i class="fas fa-trophy trophy"></i> <span id="trophies">0</span></div>
ย ย ย ย ย ย <div class="stat"><i class="fas fa-gem gem"></i> <span id="diamonds">100</span></div>
ย ย ย ย ย ย <div class="stat"><i class="fas fa-crown crown"></i> <span id="cups">0</span></div>
ย ย ย ย </div>
ย ย ย ย <h1 class="text-4xl font-bold text-center mb-8 text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-green-500">๐ FORTNITE: BATALLA NAVIDEรA</h1>

ย ย ย ย <div id="battle" class="active section-container">
ย ย ย ย ย ย <div class="battle-header">
ย ย ย ย ย ย ย ย <h2 class="text-3xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-red-400 to-red-600">โ๏ธ BATALLA</h2>
ย ย ย ย ย ย ย ย <p class="text-lg">ยกElige una carta y ataca con estilo navideรฑo!</p>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <div class="battle-ia-cards" id="battleIaCards"></div>
ย ย ย ย ย ย <div class="battle-player-cards" id="battlePlayerCards"></div>
ย ย ย ย ย ย <div class="text-center mt-4">
ย ย ย ย ย ย ย ย <button class="attack-button" onclick="playerAttack()">๐ฅ ATACAR</button>
ย ย ย ย ย ย ย ย <button class="defend-button" onclick="playerDefend()">๐ก๏ธ DEFENDER</button>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย <div id="deck" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-purple-600">๐ด TU MAZO</h2>
ย ย ย ย ย ย <div id="collectionCounter">Cartas coleccionadas: <span id="collectedCount">0</span> / <span id="totalCards">34</span></div>
ย ย ย ย ย ย <p id="deckCounter" class="text-center text-xl font-semibold mb-4 text-yellow-300">Cartas en el mazo: 0 / 3</p>
ย ย ย ย ย ย <div class="filter-bar">
ย ย ย ย ย ย ย ย <select id="rarityFilter" onchange="renderDeck()">
ย ย ย ย ย ย ย ย ย ย <option value="all">Todas las rarezas</option>
ย ย ย ย ย ย ย ย ย ย <option value="common">Comรบn</option>
ย ย ย ย ย ย ย ย ย ย <option value="rare">Rara</option>
ย ย ย ย ย ย ย ย ย ย <option value="epic">รpica</option>
ย ย ย ย ย ย ย ย ย ย <option value="legendary">Legendaria</option>
ย ย ย ย ย ย ย ย ย ย <option value="idolos">รdolos</option>
                        <option value="collaboration">Colaboraciรณn</option>
ย ย ย ย ย ย ย ย ย ย <option value="tournament">Torneo</option>
ย ย ย ย ย ย ย ย ย ย <option value="paises">Paรญses</option>
ย ย ย ย ย ย ย ย </select>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <div class="card-grid" id="deckCards"></div>
ย ย ย ย ย ย <div class="text-center mt-6">
ย ย ย ย ย ย ย ย <button class="btn bg-purple-700" onclick="saveDeck()">๐พ Guardar Mazo</button>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย <div id="shop" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500">๐ TIENDA NAVIDEรA</h2>
ย ย ย ย ย ย <div id="gemsOffer" class="bg-gradient-to-r from-blue-600 to-purple-600 p-6 rounded-2xl text-center mb-8 mx-auto max-w-3xl animate-pulse shadow-xl">
ย ย ย ย ย ย ย ย <h3 class="text-2xl font-bold text-yellow-300">๐ฅ ยกOFERTA รNICA! ๐ฅ</h3>
ย ย ย ย ย ย ย ย <p class="text-xl">ยก1000 GEMAS por tiempo limitado!</p>
ย ย ย ย ย ย ย ย <p class="text-md text-yellow-200">Oferta termina en: <span id="shopGemsCountdown">--h --m --s</span></p>
ย ย ย ย ย ย ย ย <button class="btn bg-yellow-500 text-black mt-4" onclick="buyGemsPackage()">Comprar por $4.99</button>
ย ย ย ย ย ย </div>
            <h3 class="text-3xl font-bold text-center mb-6 text-yellow-500">๐ฆ COFRES</h3>
            <div class="flex justify-center gap-6 mb-8 flex-wrap">
                <div class="chest-container" onclick="buyAndOpenChest('classic')">
                    <i class="fas fa-box-open text-6xl text-brown-700 mb-2"></i>
                    <h4 class="text-xl font-bold">Cofre Clรกsico</h4>
                    <p class="text-sm">Contiene 1 carta aleatoria.</p>
                    <button class="btn bg-red-600 mt-3 px-8">ABRIR por ๐ 50</button>
                </div>
                <div class="chest-container" onclick="buyAndOpenChest('epic')">
                    <i class="fas fa-gift text-6xl text-purple-500 mb-2"></i>
                    <h4 class="text-xl font-bold">Cofre รpico</h4>
                    <p class="text-sm">Contiene 2 cartas (รpica o mejor garantizada).</p>
                    <button class="btn bg-purple-600 mt-3 px-8">ABRIR por ๐ 300</button>
                </div>
            </div>

ย ย ย ย ย ย <div class="bg-gradient-to-r from-red-600 to-blue-600 p-6 rounded-2xl text-center mb-8 mx-auto max-w-3xl shadow-xl">
ย ย ย ย ย ย ย ย <h3 class="text-2xl font-bold text-white">๐ ยกNUEVA RAREZA: PAรSES! ๐</h3>
ย ย ย ย ย ย ย ย <p class="text-lg text-white">La nueva rareza "Paรญses" representa mujeres icรณnicas de cada paรญs.</p>
ย ย ย ย ย ย </div>
ย ย ย ย ย ย <div class="card-grid" id="shopCards"></div>
ย ย ย ย ย ย <div class="text-center mt-6">
ย ย ย ย ย ย ย ย <p class="text-lg text-yellow-200">La tienda se actualiza automรกticamente a las 1:00 AM: <span id="shopUpdateCountdown">--h --m --s</span></p>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย <div id="tournament" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6 text-yellow-400">๐ TORNEOS DISPONIBLES</h2>
ย ย ย ย ย ย <div id="tournamentsList" class="flex flex-col gap-8 mx-auto max-w-3xl"></div>
ย ย ย ย </div>

ย ย ย ย <div id="ranking" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6">๐ RANKING GLOBAL</h2>
ย ย ย ย ย ย <div id="rankingList" class="max-h-96 overflow-y-auto"></div>
ย ย ย ย ย ย <div id="rankingList" class="max-h-96 overflow-y-auto"></div>
ย ย ย ย </div>

ย ย ย ย <div id="cupMode" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6 text-yellow-500">๐ CONSEGUIR COPAS</h2>
ย ย ย ย ย ย <p class="text-center text-lg mb-6">ยกGana batallas fรกciles para obtener copas y desbloquear torneos!</p>
ย ย ย ย ย ย <div class="text-center">
ย ย ย ย ย ย ย ย <button class="btn bg-yellow-600 text-lg px-8 py-4" onclick="startCupBattle()">Iniciar Batalla por Copas</button>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย <div id="achievements" class="section-container">
ย ย ย ย ย ย <h2 class="text-3xl font-bold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-600">๐ LOGROS</h2>
ย ย ย ย ย ย <div id="achievementsList" class="max-h-96 overflow-y-auto"></div>
ย ย ย ย </div>
ย ย </div>

ย ย <div id="cardModal" onclick="closeCardModal()">
ย ย ย ย <div id="cardModalContent" onclick="event.stopPropagation()">
ย ย ย ย ย ย <img id="cardModalImage" src="" alt="Carta" />
ย ย ย ย ย ย <h2 id="cardModalName" class="text-3xl font-bold"></h2>
ย ย ย ย ย ย <div id="cardModalRarity" class="font-bold text-xl"></div>
ย ย ย ย ย ย <div id="cardModalLevel" class="font-bold text-lg mt-2"></div>
ย ย ย ย ย ย <div id="cardModalStats" class="text-xl mt-4"></div>
ย ย ย ย ย ย <button class="btn bg-gray-700 mt-6" onclick="closeCardModal()">Cerrar</button>
ย ย ย ย </div>
ย ย </div>

ย ย <div id="battleMessage">
ย ย ย ย <h2 id="messageText"></h2>
ย ย ย ย <button class="btn bg-green-600" onclick="rematch()">REVANCHA</button>
ย ย ย ย <button class="btn bg-blue-600" onclick="closeBattleMessage()">Cerrar</button>
ย ย </div>

ย ย <div class="fixed bottom-0 left-0 right-0 flex justify-center gap-3 z-10 flex-wrap px-4 py-4 bg-black/50 backdrop-blur-md rounded-t-2xl shadow-lg">
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('battle')">Batalla</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('deck')">Mazo</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('shop')">Tienda</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('ranking')">Ranking</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('cupMode')">COPAS</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('tournament')">Torneo</button>
ย ย ย ย <button class="nav-btn text-sm px-6 py-3" onclick="showView('achievements')">Logros</button>
ย ย </div>

ย ย <script>
        // --- FECHAS Y CONSTANTES GLOBALES ---
ย ย ย ย function getGemsOfferEndTime() {
ย ย ย ย ย ย const now = new Date();
ย ย ย ย ย ย const endTime = new Date(now);
ย ย ย ย ย ย endTime.setHours(1, 0, 0, 0);
ย ย ย ย ย ย if (endTime <= now) endTime.setDate(endTime.getDate() + 1);
ย ย ย ย ย ย return endTime;
ย ย ย ย }
ย ย ย ย const GEMS_OFFER_END = getGemsOfferEndTime();
ย ย ย ย const SHOP_UPDATE_END = getGemsOfferEndTime();
ย ย ย ย const SABRINA_START = new Date('2025-12-14T15:00:00');
ย ย ย ย const CARMELA_AVAILABLE = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate() + 1, 1, 0, 0);
        const SIMPSONS_COLLABORATION_START = new Date('2025-12-18T10:00:00'); // NUEVO: 18 de Dic. 10:00 AM
ย ย ย ย const DECK_MAX_SIZE = 3;
ย ย ย ย const MAX_LEVEL = 100;
ย ย ย ย const UPGRADE_COST_BASE = 50;
        
ย ย ย ย const CHESTS = {
ย ย ย ย ย ย classic: {
ย ย ย ย ย ย ย ย cost: 50,
ย ย ย ย ย ย ย ย cards: 1,
ย ย ย ย ย ย ย ย weights: { common: 50, rare: 30, epic: 20, legendary: 0, idolos: 0, tournament: 0, paises: 0, collaboration: 0 }
ย ย ย ย ย ย },
ย ย ย ย ย ย epic: {
ย ย ย ย ย ย ย ย cost: 300,
ย ย ย ย ย ย ย ย cards: 2,
ย ย ย ย ย ย ย ย weights: { common: 0, rare: 0, epic: 50, legendary: 30, idolos: 10, tournament: 5, paises: 5, collaboration: 0 }
ย ย ย ย ย ย }
ย ย ย ย };

        // --- DEFINICIรN DE TODAS LAS CARTAS (Incluyendo la de Los Simpsons) ---
ย ย ย ย const ALL_CARDS = [
ย ย ย ย ย ย { id: 0, name: "Ramรญrez", rarity: "common", baseAtk: 60, baseDef: 50, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/Y8DPmT76.jpeg?v=1764825894", shopPrice: null },
ย ย ย ย ย ย { id: 1, name: "Fortaleza", rarity: "rare", baseAtk: 60, baseDef: 70, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/1FvcJ5u7.png?v=1764809177", shopPrice: null },
ย ย ย ย ย ย { id: 2, name: "Escudera", rarity: "common", baseAtk: 55, baseDef: 65, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/9RweIpam.jpeg?v=1764813677", shopPrice: null },
ย ย ย ย ย ย { id: 3, name: "Azulita", rarity: "rare", baseAtk: 70, baseDef: 55, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", shopPrice: 80 },
ย ย ย ย ย ย { id: 4, name: "Tormenta", rarity: "epic", baseAtk: 80, baseDef: 45, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/7GmdJa3U.jpeg?v=1764802552", shopPrice: 120 },
ย ย ย ย ย ย { id: 5, name: "Furia", rarity: "legendary", baseAtk: 90, baseDef: 40, level: 1, img: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", shopPrice: 200 },
ย ย ย ย ย ย { id: 6, name: "Asesina", rarity: "legendary", baseAtk: 95, baseDef: 30, level: 1, img: "https://s206.erome.com/4699/lpRzYjBO/Z5Tc5k2v.jpeg?v=1745795818", shopPrice: 250 },
ย ย ย ย ย ย { id: 7, name: "Francine Smith", rarity: "legendary", baseAtk: 110, baseDef: 70, level: 1, img: "https://wimg.rule34.xxx//images/1888/0334e8239c387a302348c01810815aef.jpeg?15738062", shopPrice: null },
ย ย ย ย ย ย { id: 11, name: "Campeรณn Sombra", rarity: "tournament", baseAtk: 140, baseDef: 100, level: 1, img: "https://s100.erome.com/2418/B2TgruwR/61zc8Veb.png?v=1712563892", shopPrice: null },
ย ย ย ย ย ย { id: 12, name: "Maestro del Fuego", rarity: "tournament", baseAtk: 150, baseDef: 90, level: 1, img: "https://s326.erome.com/5139/YBnb1NTO/pN2evqNZ.jpeg?v=1750357395", shopPrice: null },
ย ย ย ย ย ย { id: 13, name: "Rey del Hielo", rarity: "tournament", baseAtk: 135, baseDef: 110, level: 1, img: "https://s10.erome.com/6694/EUAdAxk1/1zdVPLQh.jpeg?v=1764732026", shopPrice: null },
ย ย ย ย ย ย { id: 14, name: "Felina", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2288/sample_ce3c07d28a9fdd2475d6fc67df8ff4e4.jpg?15302020", shopPrice: 300 },
ย ย ย ย ย ย { id: 16, name: "Serenade", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/3001/sample_59915a49be3c0b2a86030615f562d3c1.jpg?15147757", shopPrice: 700 },
ย ย ย ย ย ย { id: 17, name: "Cammy and Chun-Li", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/714/sample_799c5e73f8d6f088e9a1930fe6d3f791.jpg?15175590", shopPrice: 700 },
ย ย ย ย ย ย { id: 18, name: "Briar", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2510/sample_ea2393689e00c9127748cc78a08ef6b5.jpg?15205865", shopPrice: 700 },
ย ย ย ย ย ย { id: 19, name: "Torrenta", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/1506/sample_b060c3279b1a9b0a7da0e19bb15fa2d5.jpg?15273482", shopPrice: 700 },
ย ย ย ย ย ย { id: 20, name: "Siren", rarity: "epic", baseAtk: 85, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/1766/sample_0e848cee467407d1da3fd407bbf6e484.jpg?15276598", shopPrice: 700 },
ย ย ย ย ย ย { id: 21, name: "Sabrina Carpente La Diva", rarity: "idolos", baseAtk: 120, baseDef: 80, level: 1, img: "https://i.pinimg.com/736x/4d/c9/b3/4dc9b3acdf2ab04c3c783d3fb2730a0c.jpg", shopPrice: null },
ย ย ย ย ย ย { id: 22, name: "Carmela", rarity: "paises", baseAtk: 100, baseDef: 60, level: 1, img: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", shopPrice: 500 },
ย ย ย ย ย ย { id: 23, name: "Amy Wong Thicc", rarity: "epic", baseAtk: 88, baseDef: 55, level: 1, img: "https://rule34.xxx//samples/2701/sample_eae1882d43a188cdcbb129ca7ad3e12e.jpg?14901475", shopPrice: 400 },
ย ย ย ย ย ย { id: 24, name: "Neon Strike", rarity: "epic", baseAtk: 90, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/902/sample_2e1d3d88982219e96d1bb68453e57b27.jpg?14884672", shopPrice: 450 },
ย ย ย ย ย ย { id: 25, name: "Beach Rebel", rarity: "epic", baseAtk: 85, baseDef: 60, level: 1, img: "https://rule34.xxx//samples/2019/sample_fd1e4fb4f37cab745ed074ee637ee911.jpg?14877326", shopPrice: 500 },
ย ย ย ย ย ย { id: 26, name: "Panda Girl", rarity: "epic", baseAtk: 82, baseDef: 58, level: 1, img: "https://rule34.xxx//samples/1674/sample_9c2a1dc61194fef31518afef6288438d.jpg?14876583", shopPrice: 550 },
ย ย ย ย ย ย { id: 27, name: "Beach Blonde", rarity: "epic", baseAtk: 92, baseDef: 48, level: 1, img: "https://rule34.xxx//samples/890/sample_ce7401fb27ce9a94e218feb294e9d107.jpg?14851213", shopPrice: 600 },
ย ย ย ย ย ย { id: 28, name: "Wonder Slut", rarity: "epic", baseAtk: 95, baseDef: 45, level: 1, img: "https://rule34.xxx//samples/890/sample_5007ec807529d5075eebb9fc67df9f09.jpg?14851228", shopPrice: 650 },
ย ย ย ย ย ย { id: 29, name: "Samurai Blue", rarity: "epic", baseAtk: 87, baseDef: 62, level: 1, img: "https://wimg.rule34.xxx//images/2149/86cb609ba898ff4285cfe105c5237f1a.png?14777959", shopPrice: 700 },
ย ย ย ย ย ย { id: 30, name: "Pink Facesit", rarity: "epic", baseAtk: 80, baseDef: 65, level: 1, img: "https://rule34.xxx//samples/1545/sample_6ebdf1e38f29cb2e1d1cda76622fea1c.jpg?14763252", shopPrice: 750 },
ย ย ย ย ย ย { id: 31, name: "D.Va & Uraraka", rarity: "epic", baseAtk: 93, baseDef: 52, level: 1, img: "https://rule34.xxx//samples/2122/sample_cadb0b375ac7de3414d0db39d552e7d4.jpg?14666699", shopPrice: 800 },
ย ย ย ย ย ย { id: 32, name: "Laguna", rarity: "epic", baseAtk: 89, baseDef: 55, level: 1, img: "https://rule34.xxx//samples/842/sample_727d3f80cc43d197f3977fb5c9dfdc22.jpg?14662037", shopPrice: 850 },
ย ย ย ย ย ย { id: 33, name: "Facesit Dominatrix", rarity: "epic", baseAtk: 94, baseDef: 50, level: 1, img: "https://rule34.xxx//samples/2314/sample_6bdcff4bfa032aed2751a5370a24cf05.jpg?14637455", shopPrice: 900 },
ย ย ย ย ย ย { id: 34, name: "LolaLolita", rarity: "idolos", baseAtk: 140, baseDef: 90, level: 1, img: "https://s204.erome.com/2280/sMLLJHdM/kYJtDcuQ.jpeg?v=1709700685", shopPrice: null },
ย ย ย ย ย ย { id: 35, name: "DemonMika", rarity: "idolos", baseAtk: 145, baseDef: 85, level: 1, img: "https://s206.erome.com/3439/knzX8RV6/qi2fnmtw.jpeg?v=1730822823", shopPrice: null },
ย ย ย ย ย ย { id: 36, name: "Alejandra", rarity: "idolos", baseAtk: 150, baseDef: 100, level: 1, img: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", shopPrice: null },
            // NUEVA CARTA DE COLABORACIรN (ID 37)
            { id: 37, name: "Homero Simpson (Duffman)", rarity: "collaboration", baseAtk: 130, baseDef: 110, level: 1, img: "https://upload.wikimedia.org/wikipedia/en/thumb/8/8c/Duffman.png/250px-Duffman.png", shopPrice: 1500, unlockDate: SIMPSONS_COLLABORATION_START }
ย ย ย ย ];

ย ย ย ย const TOURNAMENTS = [
ย ย ย ย ย ย { id: 1, name: "Torneo Navideรฑo", cost: 1, trophies: 500, diamonds: 200, cards: [7, 11, 12, 13], description: "ยกRegalo navideรฑo! Gana Francine Smith y cartas de torneo.", image: "https://wimg.rule34.xxx//images/1888/0334e8239c387a302348c01810815aef.jpeg?15738062", iaDeck: [0,1,2] },
ย ย ย ย ย ย { id: 2, name: "Torneo Principiante", cost: 0, trophies: 100, diamonds: 50, cards: [3, 4], description: "Para nuevos jugadores.", image: "https://s93.erome.com/5472/K3IRZbxx/0B8OzReu.jpeg?v=1764815871", iaDeck: [0,2,3] },
ย ย ย ย ย ย { id: 3, name: "Torneo รpico", cost: 3, trophies: 300, diamonds: 150, cards: [14, 16, 18], description: "Cartas รฉpicas exclusivas.", image: "https://rule34.xxx//samples/2288/sample_ce3c07d28a9fdd2475d6fc67df8ff4e4.jpg?15302020", iaDeck: [4,14,16] },
ย ย ย ย ย ย { id: 4, name: "Torneo Legendario", cost: 5, trophies: 1000, diamonds: 300, cards: [5, 6], description: "Recompensas legendarias.", image: "https://s93.erome.com/5472/K3IRZbxx/LsMURibY.jpeg?v=1764812622", iaDeck: [5,6,7] },
ย ย ย ย ย ย { id: 5, name: "Torneo Exรณtico", cost: 7, trophies: 1500, diamonds: 500, cards: [17], description: "Gana cartas exรณticas.", image: "https://rule34.xxx//samples/714/sample_799c5e73f8d6f088e9a1930fe6d3f791.jpg?15175590", iaDeck: [17,18,19] },
ย ย ย ย ย ย { id: 6, name: "Torneo Sabrina", cost: 5, trophies: 800, diamonds: 250, cards: [21], description: "ยกGana a Sabrina!", image: "https://i.pinimg.com/736x/4d/c9/b3/4dc9b3acdf2ab04c3c783d3fb2730a0c.jpg", iaDeck: [20,21,0] },
ย ย ย ย ย ย { id: 7, name: "Torneo de รdolos: LolaLolita", cost: 10, trophies: 2000, diamonds: 800, cards: [34], description: "ยกDesafรญo extremo! Enfrenta a la IA mรกs fuerte por LolaLolita.", image: "https://s204.erome.com/2280/sMLLJHdM/kYJtDcuQ.jpeg?v=1709700685", iaDeck: [5,6,7,11,12], iaMultiplier: 8 },
ย ย ย ย ย ย { id: 8, name: "Torneo de รdolos: DemonMika", cost: 12, trophies: 2500, diamonds: 1000, cards: [35], description: "ยกPeligro mรกximo! Solo los mejores ganarรกn a DemonMika.", image: "https://s206.erome.com/3439/knzX8RV6/qi2fnmtw.jpeg?v=1730822823", iaDeck: [6,7,11,12,13], iaMultiplier: 9 },
ย ย ย ย ย ย { id: 9, name: "Torneo de รdolos: Alejandra", cost: 15, trophies: 3000, diamonds: 1200, cards: [36], description: "ยกEl desafรญo definitivo! Derrota a la IA invencible por Alejandra.", image: "https://i.pinimg.com/736x/e1/e6/d2/e1e6d2425088933b0ee2751dd578a3c2.jpg", iaDeck: [7,11,12,13,5], iaMultiplier: 10 }
ย ย ย ย ];

ย ย ย ย const ACHIEVEMENTS = [
ย ย ย ย ย ย { id: 1, name: "Primera Victoria", description: "Gana tu primera batalla", icon: "๐" },
ย ย ย ย ย ย { id: 2, name: "Coleccionista Principiante", description: "Colecciona 5 cartas", icon: "๐" },
ย ย ย ย ย ย { id: 3, name: "Mejorador", description: "Sube una carta al nivel 5", icon: "โฌ๏ธ" },
ย ย ย ย ย ย { id: 4, name: "Campeรณn de Torneo", description: "Gana un torneo", icon: "๐" },
ย ย ย ย ย ย { id: 5, name: "Maestro de Gemas", description: "Gasta 500 gemas", icon: "๐" }
ย ย ย ย ];

        // --- ESTADO INICIAL COMPENSATORIO ---
        // Se inicializa con valores altos para compensar la pรฉrdida de progreso.
ย ย ย ย let gameState = {
ย ย ย ย ย ย playerName: localStorage.getItem('playerName') || 'Jugador',
ย ย ย ย ย ย trophies: parseInt(localStorage.getItem('trophies') || '500'), // ยก500 Trofeos iniciales!
ย ย ย ย ย ย diamonds: parseInt(localStorage.getItem('diamonds') || '2500'), // ยก2500 Gemas iniciales!
ย ย ย ย ย ย cups: parseInt(localStorage.getItem('cups') || '10'), // ยก10 Copas iniciales!
ย ย ย ย ย ย avatar: localStorage.getItem('playerAvatar') || 'https://rule34.xxx//samples/1888/sample_4387d777c732825ae6e377664c2ce885.jpg?15738062',
            // Desbloqueamos 10 cartas para empezar fuerte
ย ย ย ย ย ย ownedCardIds: JSON.parse(localStorage.getItem('ownedCardIds') || '[0, 1, 2, 3, 4, 5, 6, 7, 14, 16]'),
            // Subimos las cartas iniciales a Nivel 5 (solo si no hay guardado previo)
            cardUpgrades: JSON.parse(localStorage.getItem('cardUpgrades') || '{"0":5, "1":5, "2":5, "3":5, "4":5, "5":5, "6":5, "7":5, "14":5, "16":5}'),
ย ย ย ย ย ย currentDeck: JSON.parse(localStorage.getItem('currentDeck') || '[5, 6, 7]'), // Usamos 3 cartas de alto nivel para el mazo inicial
ย ย ย ย ย ย completedTournaments: JSON.parse(localStorage.getItem('completedTournaments') || '[]'),
ย ย ย ย ย ย achievements: JSON.parse(localStorage.getItem('achievements') || '[]'),
ย ย ย ย ย ย spentDiamonds: parseInt(localStorage.getItem('spentDiamonds') || '0')
ย ย ย ย };
        // --- FIN ESTADO INICIAL COMPENSATORIO ---

ย ย ย ย function applyCardUpgrades() {
ย ย ย ย ย ย ALL_CARDS.forEach(card => {
ย ย ย ย ย ย ย ย const level = gameState.cardUpgrades[card.id] || 1;
ย ย ย ย ย ย ย ย card.level = level;
                // Guardamos el ATK y DEF final en el objeto principal para usarlos en batalla y mazo
ย ย ย ย ย ย ย ย card.atk = card.baseAtk + (level - 1) * 10;
ย ย ย ย ย ย ย ย card.def = card.baseDef + (level - 1) * 8;
ย ย ย ย ย ย });
ย ย ย ย }
ย ย ย ย applyCardUpgrades();

ย ย ย ย function updateUI() {
ย ย ย ย ย ย document.getElementById('playerName').textContent = gameState.playerName;
ย ย ย ย ย ย document.getElementById('profileAvatar').src = gameState.avatar;
ย ย ย ย ย ย document.getElementById('trophies').textContent = gameState.trophies;
ย ย ย ย ย ย document.getElementById('diamonds').textContent = gameState.diamonds;
ย ย ย ย ย ย document.getElementById('cups').textContent = gameState.cups;
ย ย ย ย ย ย updateRanking();
ย ย ย ย ย ย updateCollectionCounter();
ย ย ย ย }

ย ย ย ย function updateCollectionCounter() {
ย ย ย ย ย ย const collected = gameState.ownedCardIds.length;
ย ย ย ย ย ย const total = ALL_CARDS.length;
ย ย ย ย ย ย document.getElementById('collectedCount').textContent = collected;
ย ย ย ย ย ย document.getElementById('totalCards').textContent = total;
            
ย ย ย ย ย ย const deckCounter = document.getElementById('deckCounter');
ย ย ย ย ย ย if (deckCounter) {
ย ย ย ย ย ย ย ย deckCounter.textContent = `Cartas en el mazo: ${gameState.currentDeck.length} / ${DECK_MAX_SIZE}`;
ย ย ย ย ย ย }

ย ย ย ย ย ย const counter = document.getElementById('collectionCounter');
ย ย ย ย ย ย if (collected === total) {
ย ย ย ย ย ย ย ย counter.style.color = '#FFD700';
ย ย ย ย ย ย ย ย counter.innerHTML = `Cartas coleccionadas: ${collected} / ${total} ๐ ยกCOMPLETADO!`;
ย ย ย ย ย ย } else {
                counter.style.color = 'white';
                counter.innerHTML = `Cartas coleccionadas: ${collected} / ${total}`;
            }
ย ย ย ย }

ย ย ย ย function updateCountdowns() {
ย ย ย ย ย ย const now = new Date();
ย ย ย ย ย ย const gemsDiff = GEMS_OFFER_END - now;
ย ย ย ย ย ย 
            // 1. Contador de la Oferta de Gemas
ย ย ย ย ย ย if (gemsDiff <= 0) {
ย ย ย ย ย ย ย ย document.getElementById('offerBanner').style.display = 'none';
ย ย ย ย ย ย ย ย document.getElementById('gemsOffer').style.display = 'none';
ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย const h = Math.floor(gemsDiff / 3600000).toString().padStart(2,'0');
ย ย ย ย ย ย ย ย const m = Math.floor((gemsDiff % 3600000) / 60000).toString().padStart(2,'0');
ย ย ย ย ย ย ย ย const s = Math.floor((gemsDiff % 60000) / 1000).toString().padStart(2,'0');
ย ย ย ย ย ย ย ย const timeStr = `${h}h ${m}m ${s}s`;
ย ย ย ย ย ย ย ย document.querySelectorAll('#gemsCountdown, #shopGemsCountdown').forEach(el => el.textContent = timeStr);
ย ย ย ย ย ย }
            
            // 2. Contador de Colaboraciรณn de Los Simpsons (NUEVO)
            const simpsonsDiff = SIMPSONS_COLLABORATION_START - now;
            const collabBanner = document.getElementById('collaborationBanner');
            
            if (simpsonsDiff <= 0) {
                if (collabBanner) collabBanner.style.display = 'none';
                // Si el evento ya pasรณ, aseguramos que la carta se pueda comprar
                const simpsonsCard = ALL_CARDS.find(c => c.id === 37);
                if (simpsonsCard) simpsonsCard.unlockDate = new Date(0); // Desbloqueado
            } else {
                const d = Math.floor(simpsonsDiff / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                const h = Math.floor((simpsonsDiff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                const m = Math.floor((simpsonsDiff % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                const s = Math.floor((simpsonsDiff % (1000 * 60)) / 1000).toString().padStart(2, '0');
                const timeStr = `${d}d ${h}h ${m}m ${s}s`;
                document.getElementById('simpsonsCountdown').textContent = timeStr;
            }
ย ย ย ย }
ย ย ย ย setInterval(updateCountdowns, 1000);
ย ย ย ย updateCountdowns();

ย ย ย ย function buyGemsPackage() {
ย ย ย ย ย ย if (new Date() >= GEMS_OFFER_END) { alert("ยกLa oferta ha terminado!"); return; }
ย ย ย ย ย ย if (confirm("ยฟComprar 1000 gemas por $4.99?")) {
ย ย ย ย ย ย ย ย gameState.diamonds += 1000;
ย ย ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย ย ย alert("ยกCompra exitosa! Has recibido 1000 gemas ๐");
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function upgradeCard(cardId) {
ย ย ย ย ย ย const card = ALL_CARDS.find(c => c.id === cardId);
ย ย ย ย ย ย if (!card) return;
ย ย ย ย ย ย const currentLevel = gameState.cardUpgrades[cardId] || 1;
ย ย ย ย ย ย if (currentLevel >= MAX_LEVEL) { alert("ยกNivel mรกximo!"); return; }
ย ย ย ย ย ย const cost = currentLevel * UPGRADE_COST_BASE;
ย ย ย ย ย ย if (gameState.diamonds < cost) { alert("ยกGemas insuficientes!"); return; }
ย ย ย ย ย ย if (confirm(`ยฟSubir ${card.name} al nivel ${currentLevel + 1} por ${cost} gemas?`)) {
ย ย ย ย ย ย ย ย gameState.diamonds -= cost;
ย ย ย ย ย ย ย ย gameState.spentDiamonds += cost;
ย ย ย ย ย ย ย ย gameState.cardUpgrades[cardId] = currentLevel + 1;
ย ย ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย ย ย applyCardUpgrades();
ย ย ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย ย ย renderDeck();
ย ย ย ย ย ย ย ย renderShop();
ย ย ย ย ย ย ย ย renderBattleCards();
ย ย ย ย ย ย ย ย checkAchievements();
ย ย ย ย ย ย ย ย alert(`ยก${card.name} al nivel ${currentLevel + 1}!`);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function addToDeck(cardId) {
ย ย ย ย ย ย if (gameState.currentDeck.includes(cardId)) return;
ย ย ย ย ย ย if (gameState.currentDeck.length >= DECK_MAX_SIZE) { alert(`Mazo lleno (mรกximo ${DECK_MAX_SIZE})`); return; }
ย ย ย ย ย ย gameState.currentDeck.push(cardId);
ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย renderDeck();
ย ย ย ย }

ย ย ย ย function removeFromDeck(cardId) {
ย ย ย ย ย ย gameState.currentDeck = gameState.currentDeck.filter(id => id !== cardId);
ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย renderDeck();
ย ย ย ย }

ย ย ย ย function saveDeck() {
ย ย ย ย ย ย alert("ยกMazo guardado!");
ย ย ย ย ย ย saveGame();
ย ย ย ย }

ย ย ย ย function showCardModal(card) {
ย ย ย ย ย ย document.getElementById('cardModalImage').src = card.img;
ย ย ย ย ย ย document.getElementById('cardModalName').textContent = card.name;
ย ย ย ย ย ย const rarityLabels = { common: "Comรบn", rare: "Rara", epic: "รpica", legendary: "Legendaria", idolos: "รdolos", tournament: "Torneo", paises: "Paรญses", collaboration: "Colaboraciรณn" };
ย ย ย ย ย ย document.getElementById('cardModalRarity').textContent = rarityLabels[card.rarity] || card.rarity;
ย ย ย ย ย ย document.getElementById('cardModalLevel').textContent = `Nivel: ${card.level}`;
ย ย ย ย ย ย document.getElementById('cardModalStats').textContent = `โ๏ธ ${card.atk} ๐ก๏ธ ${card.def}`;
ย ย ย ย ย ย document.getElementById('cardModal').style.display = 'flex';
ย ย ย ย }

ย ย ย ย function closeCardModal() {
ย ย ย ย ย ย document.getElementById('cardModal').style.display = 'none';
ย ย ย ย }

ย ย ย ย function renderDeck() {
ย ย ย ย ย ย const container = document.getElementById('deckCards');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย const filter = document.getElementById('rarityFilter').value;
ย ย ย ย ย ย let cards = ALL_CARDS.filter(c => gameState.ownedCardIds.includes(c.id));
ย ย ย ย ย ย if (filter !== 'all') cards = cards.filter(c => c.rarity === filter);
ย ย ย ย ย ย cards.forEach(card => {
ย ย ย ย ย ย ย ย const el = document.createElement('div');
ย ย ย ย ย ย ย ย el.className = `card-container rarity-${card.rarity}`;
ย ย ย ย ย ย ย ย const inDeck = gameState.currentDeck.includes(card.id);
ย ย ย ย ย ย ย ย const buttonDisabled = !inDeck && gameState.currentDeck.length >= DECK_MAX_SIZE ? 'disabled' : '';
ย ย ย ย ย ย ย ย el.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="card-base">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="card-glow"></div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="card-content">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <img src="${card.img}" onerror="this.src='https://via.placeholder.com/150/333/fff?text=${card.name}'" style="width:100%; height:190px; object-fit:cover; border-radius:8px;">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="font-bold text-sm mt-2 truncate">${card.name}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="text-xs">โ๏ธ ${card.atk} ๐ก๏ธ ${card.def}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="upgrade-badge">Nivel ${card.level}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn bg-${inDeck ? 'red' : 'green'}-600 text-sm mt-3" onclick="${inDeck ? `removeFromDeck(${card.id})` : `addToDeck(${card.id})`}" ${buttonDisabled}>${inDeck ? 'Quitar' : 'Aรฑadir'} al Mazo</button>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button class="btn bg-blue-600 text-sm mt-1" onclick="upgradeCard(${card.id})">Subir Nivel</button>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย el.querySelector('.card-base').onclick = (e) => { if (!e.target.closest('button')) showCardModal(card); };
ย ย ย ย ย ย ย ย container.appendChild(el);
ย ย ย ย ย ย });
ย ย ย ย ย ย updateCollectionCounter();
ย ย ย ย }

ย ย ย ย function renderShop() {
ย ย ย ย ย ย const container = document.getElementById('shopCards');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย const now = new Date();
ย ย ย ย ย ย 
            // 1. Mostrar cartas comprables y la carta de colaboraciรณn
ย ย ย ย ย ย const buyable = ALL_CARDS.filter(c => c.shopPrice !== null && !gameState.ownedCardIds.includes(c.id));
ย ย ย ย ย ย buyable.forEach(card => {
                
                let isLocked = card.unlockDate && now < card.unlockDate;

ย ย ย ย ย ย ย ย const el = document.createElement('div');
ย ย ย ย ย ย ย ย el.className = `card-container rarity-${card.rarity} ${isLocked ? 'locked-card' : ''}`;
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย let extra = '';
ย ย ย ย ย ย ย ย if (card.id === 22 && now < CARMELA_AVAILABLE) {
ย ย ย ย ย ย ย ย ย ย extra = `<div class="text-xs text-red-400 mt-1">Disponible en: <span id="carmelaCountdown">--h --m --s</span></div>`;
ย ย ย ย ย ย ย ย }
                
                let lockOverlay = '';
                if (isLocked) {
                    lockOverlay = `<div class="lock-overlay"><i class="fas fa-lock"></i><p>Disponible en:</p><p id="simpsonsShopCountdown">--d --h --m --s</p></div>`;
                    
                    // Necesitamos actualizar este contador en el bucle principal si es visible
                    const updateSimpsonsShopCountdown = () => {
                        const diff = card.unlockDate - new Date();
                        if (diff > 0) {
                            const d = Math.floor(diff / (1000 * 60 * 60 * 24)).toString().padStart(2, '0');
                            const h = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)).toString().padStart(2, '0');
                            const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)).toString().padStart(2, '0');
                            const s = Math.floor((diff % (1000 * 60)) / 1000).toString().padStart(2, '0');
                            el.querySelector('#simpsonsShopCountdown').textContent = `${d}d ${h}h ${m}m ${s}s`;
                        } else {
                            renderShop(); // Recargar la tienda para desbloquear
                        }
                    };
                    setInterval(updateSimpsonsShopCountdown, 1000);
                }

ย ย ย ย ย ย ย ย el.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="card-base">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="card-glow"></div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="card-content">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <img src="${card.img}" onerror="this.src='https://via.placeholder.com/150/333/fff?text=${card.name}'" style="width:100%; height:190px; object-fit:cover; border-radius:8px;">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="font-bold text-sm mt-2 truncate">${card.name}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="text-xs">โ๏ธ ${card.atk} ๐ก๏ธ ${card.def}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="upgrade-badge">Nivel ${card.level}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <div class="text-xs text-yellow-400 mt-1">๐ ${card.shopPrice}</div>
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ${extra}
                                ${lockOverlay}
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย 
                if (!isLocked) {
                    el.onclick = () => buyCard(card.id);
                } else {
                    el.onclick = () => alert(`ยก${card.name} no estรก disponible aรบn! Faltan ${document.getElementById('simpsonsCountdown').textContent}`);
                }
                
ย ย ย ย ย ย ย ย container.appendChild(el);
ย ย ย ย ย ย });
ย ย ย ย ย ย if (buyable.length === 0) container.innerHTML = '<p class="text-center text-2xl text-yellow-400 col-span-full">ยกTienda vacรญa! Has comprado todo ๐</p>';
ย ย ย ย }

ย ย ย ย function buyCard(cardId) {
ย ย ย ย ย ย const card = ALL_CARDS.find(c => c.id === cardId);
            const now = new Date();

ย ย ย ย ย ย if (card.id === 22 && now < CARMELA_AVAILABLE) { alert("ยกNo disponible aรบn!"); return; }
            if (card.id === 37 && card.unlockDate && now < card.unlockDate) { alert("ยกLa carta de colaboraciรณn no estรก disponible aรบn!"); return; }

ย ย ย ย ย ย if (gameState.diamonds < card.shopPrice) { alert("ยกGemas insuficientes!"); return; }
ย ย ย ย ย ย if (confirm(`ยฟComprar ${card.name} por ${card.shopPrice} gemas?`)) {
ย ย ย ย ย ย ย ย gameState.diamonds -= card.shopPrice;
ย ย ย ย ย ย ย ย gameState.spentDiamonds += card.shopPrice;
ย ย ย ย ย ย ย ย if (!gameState.ownedCardIds.includes(cardId)) gameState.ownedCardIds.push(cardId);
ย ย ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย ย ย renderShop();
ย ย ย ย ย ย ย ย renderDeck();
ย ย ย ย ย ย ย ย checkAchievements();
ย ย ย ย ย ย ย ย alert(`ยก${card.name} comprada!`);
ย ย ย ย ย ย }
ย ย ย ย }
        
ย ย ย ย function getRarityFromWeights(weights) {
ย ย ย ย ย ย const totalWeight = Object.values(weights).reduce((sum, weight) => sum + weight, 0);
ย ย ย ย ย ย let randomNum = Math.random() * totalWeight;
ย ย ย ย ย ย 
ย ย ย ย ย ย for (const rarity in weights) {
ย ย ย ย ย ย ย ย randomNum -= weights[rarity];
ย ย ย ย ย ย ย ย if (randomNum <= 0) {
ย ย ย ย ย ย ย ย ย ย return rarity;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }
ย ย ย ย ย ย return 'common';
ย ย ย ย }

ย ย ย ย function getRandomCardByRarity(rarity) {
ย ย ย ย ย ย const unownedCardsOfRarity = ALL_CARDS.filter(
ย ย ย ย ย ย ย ย card => card.rarity === rarity && !gameState.ownedCardIds.includes(card.id)
ย ย ย ย ย ย );

ย ย ย ย ย ย if (unownedCardsOfRarity.length > 0) {
ย ย ย ย ย ย ย ย return unownedCardsOfRarity[Math.floor(Math.random() * unownedCardsOfRarity.length)];
ย ย ย ย ย ย }
ย ย ย ย ย ย 
ย ย ย ย ย ย const allUnownedCards = ALL_CARDS.filter(
ย ย ย ย ย ย ย ย card => !gameState.ownedCardIds.includes(card.id)
ย ย ย ย ย ย );
ย ย ย ย ย ย if (allUnownedCards.length > 0) {
ย ย ย ย ย ย ย ย return allUnownedCards[Math.floor(Math.random() * allUnownedCards.length)];
ย ย ย ย ย ย }
ย ย ย ย ย ย 
ย ย ย ย ย ย return null; 
ย ย ย ย }

ย ย ย ย function buyAndOpenChest(chestType) {
ย ย ย ย ย ย const chest = CHESTS[chestType];
ย ย ย ย ย ย if (!chest) return alert("Cofre no vรกlido.");
ย ย ย ย ย ย 
ย ย ย ย ย ย if (gameState.diamonds < chest.cost) {
ย ย ย ย ย ย ย ย alert(`ยกGemas insuficientes! Necesitas ๐ ${chest.cost}.`);
ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย }
ย ย ย ย ย ย 
ย ย ย ย ย ย if (!confirm(`ยฟDeseas abrir el Cofre ${chestType} por ๐ ${chest.cost}?`)) return;

ย ย ย ย ย ย gameState.diamonds -= chest.cost;
ย ย ย ย ย ย gameState.spentDiamonds += chest.cost;
ย ย ย ย ย ย let newCardsCount = 0;
ย ย ย ย ย ย let results = [];
            
ย ย ย ย ย ย for (let i = 0; i < chest.cards; i++) {
ย ย ย ย ย ย ย ย const awardedRarity = getRarityFromWeights(chest.weights);
ย ย ย ย ย ย ย ย const card = getRandomCardByRarity(awardedRarity);

ย ย ย ย ย ย ย ย if (card && !gameState.ownedCardIds.includes(card.id)) {
ย ย ย ย ย ย ย ย ย ย gameState.ownedCardIds.push(card.id);
ย ย ย ย ย ย ย ย ย ย newCardsCount++;
ย ย ย ย ย ย ย ย ย ย results.push(`๐ ยกNUEVA CARTA! ${card.name} (${card.rarity})`);
ย ย ย ย ย ย ย ย } else if (card) {
ย ย ย ย ย ย ย ย ย ย gameState.diamonds += 10;
ย ย ย ย ย ย ย ย ย ย results.push(`โ Ya tenรญas ${card.name}. Recibes ๐ 10 de compensaciรณn.`);
ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย results.push("Ya tienes todas las cartas.");
ย ย ย ย ย ย ย ย ย ย break; 
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }
            
ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย renderShop();
ย ย ย ย ย ย renderDeck();
ย ย ย ย ย ย checkAchievements();

ย ย ย ย ย ย alert(`ยกCofre abierto!\n${results.join('\n')}\n\n${newCardsCount > 0 ? 'ยกMira tu colecciรณn!' : 'Sigue probando suerte.'}`);
            
ย ย ย ย ย ย if (newCardsCount > 0) {
ย ย ย ย ย ย ย ย startFireworks();
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function saveGame() {
ย ย ย ย ย ย localStorage.setItem('trophies', gameState.trophies);
ย ย ย ย ย ย localStorage.setItem('diamonds', gameState.diamonds);
ย ย ย ย ย ย localStorage.setItem('cups', gameState.cups);
ย ย ย ย ย ย localStorage.setItem('ownedCardIds', JSON.stringify(gameState.ownedCardIds));
ย ย ย ย ย ย localStorage.setItem('cardUpgrades', JSON.stringify(gameState.cardUpgrades));
ย ย ย ย ย ย localStorage.setItem('currentDeck', JSON.stringify(gameState.currentDeck));
ย ย ย ย ย ย localStorage.setItem('completedTournaments', JSON.stringify(gameState.completedTournaments));
ย ย ย ย ย ย localStorage.setItem('achievements', JSON.stringify(gameState.achievements));
ย ย ย ย ย ย localStorage.setItem('spentDiamonds', gameState.spentDiamonds);
ย ย ย ย ย ย let rankings = JSON.parse(localStorage.getItem('rankings') || '[]');
ย ย ย ย ย ย const index = rankings.findIndex(r => r.name === gameState.playerName);
ย ย ย ย ย ย const data = { name: gameState.playerName, trophies: gameState.trophies, avatar: gameState.avatar };
ย ย ย ย ย ย if (index >= 0) rankings[index] = data; else rankings.push(data);
ย ย ย ย ย ย rankings.sort((a,b) => b.trophies - a.trophies);
ย ย ย ย ย ย localStorage.setItem('rankings', JSON.stringify(rankings.slice(0,10)));
ย ย ย ย }

ย ย ย ย function updateRanking() {
ย ย ย ย ย ย const rankings = JSON.parse(localStorage.getItem('rankings') || '[]');
ย ย ย ย ย ย const container = document.getElementById('rankingList');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย rankings.forEach((p, i) => {
ย ย ย ย ย ย ย ย const item = document.createElement('div');
ย ย ย ย ย ย ย ย item.className = 'ranking-item';
ย ย ย ย ย ย ย ย item.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="ranking-avatar" style="background-image:url('${p.avatar}')"></div>
ย ย ย ย ย ย ย ย ย ย <div class="ranking-info">
ย ย ย ย ย ย ย ย ย ย ย ย <div class="ranking-name">${p.name}</div>
ย ย ย ย ย ย ย ย ย ย ย ย <div class="ranking-trophies">๐ช ${p.trophies} trofeos</div>
ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย <div class="ranking-pos text-3xl font-bold">${i+1}</div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย container.appendChild(item);
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย function renderTournaments() {
ย ย ย ย ย ย const container = document.getElementById('tournamentsList');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย const now = new Date();
ย ย ย ย ย ย TOURNAMENTS.forEach(t => {
ย ย ย ย ย ย ย ย if (gameState.completedTournaments.includes(t.id)) return;
ย ย ย ย ย ย ย ย let button = `<button class="btn bg-gradient-to-r from-red-700 to-green-700 text-lg px-8 py-4" onclick="startSpecificTournament(${t.id})">๐ ENTRAR AL TORNEO</button>`;
ย ย ย ย ย ย ย ย if (t.id === 6 && now < SABRINA_START) {
ย ย ย ย ย ย ย ย ย ย button = `<button class="btn bg-gray-600 text-lg px-8 py-4" disabled>Disponible en: <span id="sabrinaCountdown">--h --m --s</span></button>`;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย const el = document.createElement('div');
ย ย ย ย ย ย ย ย el.className = 'bg-gradient-to-r from-red-900/80 via-green-800/80 to-yellow-900/80 border-2 border-yellow-500 rounded-2xl p-6 mb-8 animate-pulse shadow-2xl';
ย ย ย ย ย ย ย ย el.innerHTML = `
ย ย ย ย ย ย ย ย ย ย <div class="flex items-center justify-center gap-4 mb-4"><i class="fas fa-star text-yellow-300 text-2xl"></i><span class="text-2xl font-bold text-white">${t.name}</span><i class="fas fa-star text-yellow-300 text-2xl"></i></div>
ย ย ย ย ย ย ย ย ย ย <p class="text-center text-yellow-100 font-semibold text-lg">${t.description}</p>
ย ย ย ย ย ย ย ย ย ย <p class="text-center text-gray-200 mb-6">Necesitas <strong>${t.cost} copas</strong>. Recompensas: ${t.trophies} trofeos, ${t.diamonds} gemas y cartas exclusivas.</p>
ย ย ย ย ย ย ย ย ย ย <div class="text-center mb-6"><img src="${t.image}" class="inline-block w-32 h-32 rounded-xl border-4 border-yellow-400 shadow-xl"></div>
ย ย ย ย ย ย ย ย ย ย <div class="text-center">${button}</div>
ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย container.appendChild(el);
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย function startSpecificTournament(id) {
ย ย ย ย ย ย const t = TOURNAMENTS.find(x => x.id === id);
ย ย ย ย ย ย if (gameState.cups < t.cost) { alert(`ยกNecesitas ${t.cost} copas!`); return; }
ย ย ย ย ย ย gameState.cups -= t.cost;
ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย isTournament = true; isCupBattle = false; currentTournamentId = id;
ย ย ย ย ย ย iaDeckIds = t.iaDeck;
ย ย ย ย ย ย iaLevelMultiplier = t.iaMultiplier || id;
ย ย ย ย ย ย renderIaCards();
ย ย ย ย ย ย renderBattleCards();
ย ย ย ย ย ย resetBattle();
ย ย ย ย ย ย showView('battle');
ย ย ย ย }

ย ย ย ย function startCupBattle() {
ย ย ย ย ย ย isCupBattle = true; isTournament = false;
ย ย ย ย ย ย iaDeckIds = [0,1,2]; iaLevelMultiplier = 1;
ย ย ย ย ย ย renderIaCards();
ย ย ย ย ย ย renderBattleCards();
ย ย ย ย ย ย resetBattle();
ย ย ย ย ย ย showView('battle');
ย ย ย ย }

ย ย ย ย function showView(view) {
ย ย ย ย ย ย ['battle','deck','shop','tournament','cupMode','ranking','achievements'].forEach(id => document.getElementById(id).classList.remove('active'));
ย ย ย ย ย ย document.getElementById(view).classList.add('active');
ย ย ย ย ย ย document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
ย ย ย ย ย ย const viewButton = document.querySelector(`.nav-btn[onclick*="${view}"]`);
ย ย ย ย ย ย if (viewButton) viewButton.classList.add('active');
ย ย ย ย ย ย if (view === 'deck') renderDeck();
ย ย ย ย ย ย if (view === 'shop') renderShop();
ย ย ย ย ย ย if (view === 'tournament') renderTournaments();
ย ย ย ย ย ย if (view === 'ranking') updateRanking();
ย ย ย ย ย ย if (view === 'battle') { renderIaCards(); renderBattleCards(); }
ย ย ย ย ย ย if (view === 'achievements') renderAchievements();
ย ย ย ย }

ย ย ย ย let iaCards = [], playerCards = [], selectedPlayerCard = null, selectedTargetCard = null;
ย ย ย ย let isTournament = false, isCupBattle = false, currentTournamentId = null, iaDeckIds = [], iaLevelMultiplier = 1;
ย ย ย ย let battleEnded = false;


ย ย ย ย function renderIaCards() {
ย ย ย ย ย ย const container = document.getElementById('battleIaCards');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย iaCards = [];
ย ย ย ย ย ย iaDeckIds.forEach((id, i) => {
ย ย ย ย ย ย ย ย let cardBase = ALL_CARDS.find(c => c.id === id); 
ย ย ย ย ย ย ย ย if (!cardBase) return;
                
ย ย ย ย ย ย ย ย // Calcular estadรญsticas multiplicadas
                const atk = Math.round(cardBase.atk * iaLevelMultiplier);
                const def = Math.round(cardBase.def * iaLevelMultiplier);
                
ย ย ย ย ย ย ย ย const el = document.createElement('div');
ย ย ย ย ย ย ย ย el.className = 'ia-card';
ย ย ย ย ย ย ย ย el.innerHTML = `<img src="${cardBase.img}"><div class="name">${cardBase.name}</div><div class="stats"><span>โ๏ธ ${atk}</span><span>๐ก๏ธ ${def}</span></div><div class="hp-bar"><div class="hp-fill" style="width:100%"></div></div><div class="hp-text">HP: ${def}/${def}</div>`;
ย ย ย ย ย ย ย ย el.onclick = () => {
ย ย ย ย ย ย ย ย ย ย if (!battleEnded && iaCards[i].hp > 0) {
ย ย ย ย ย ย ย ย ย ย ย ย selectedTargetCard = iaCards[i];
ย ย ย ย ย ย ย ย ย ย ย ย document.querySelectorAll('.ia-card').forEach(e => e.classList.remove('selected'));
ย ย ย ย ย ย ย ย ย ย ย ย el.classList.add('selected');
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย };
ย ย ย ย ย ย ย ย container.appendChild(el);
ย ย ย ย ย ย ย ย iaCards.push({
                    name: cardBase.name, 
                    atk: atk, 
                    def: def, 
                    hp: def, 
                    maxHp: def, 
                    element: el
                });
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย function renderBattleCards() {
ย ย ย ย ย ย const container = document.getElementById('battlePlayerCards');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย playerCards = [];
ย ย ย ย ย ย gameState.currentDeck.forEach((id, i) => {
ย ย ย ย ย ย ย ย let cardBase = ALL_CARDS.find(c => c.id === id);
ย ย ย ย ย ย ย ย if (!cardBase) return;
                
                const atk = cardBase.atk;
                const def = cardBase.def;

ย ย ย ย ย ย ย ย const el = document.createElement('div');
ย ย ย ย ย ย ย ย el.className = 'player-card';
ย ย ย ย ย ย ย ย el.innerHTML = `<img src="${cardBase.img}"><div class="name">${cardBase.name}</div><div class="stats"><span>โ๏ธ ${atk}</span><span>๐ก๏ธ ${def}</span></div><div class="upgrade-badge">Nivel ${cardBase.level}</div><div class="hp-bar"><div class="hp-fill" style="width:100%"></div></div><div class="hp-text">HP: ${def}/${def}</div>`;
ย ย ย ย ย ย ย ย el.onclick = () => {
ย ย ย ย ย ย ย ย ย ย if (!battleEnded && playerCards[i].hp > 0) {
ย ย ย ย ย ย ย ย ย ย ย ย selectedPlayerCard = playerCards[i];
ย ย ย ย ย ย ย ย ย ย ย ย document.querySelectorAll('.player-card').forEach(e => e.classList.remove('selected'));
ย ย ย ย ย ย ย ย ย ย ย ย el.classList.add('selected');
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย };
ย ย ย ย ย ย ย ย container.appendChild(el);
ย ย ย ย ย ย ย ย playerCards.push({
                    name: cardBase.name, 
                    atk: atk, 
                    def: def, 
                    hp: def, 
                    maxHp: def, 
                    element: el,
                    baseDef: def // Guardamos la defensa original para la acciรณn de defensa
                });
ย ย ย ย ย ย });
ย ย ย ย ย ย if (playerCards.length === 0) container.innerHTML = '<p class="text-center text-xl">ยกAรฑade cartas al mazo!</p>';
ย ย ย ย }

ย ย ย ย function resetBattle() {
ย ย ย ย ย ย playerCards.forEach(c => { 
                c.hp = c.maxHp; 
                c.def = c.baseDef; 
                c.element.classList.remove('selected'); 
            });
ย ย ย ย ย ย iaCards.forEach(c => { 
                c.hp = c.maxHp; 
                c.element.classList.remove('selected'); 
            });
ย ย ย ย ย ย updateHpBars();
ย ย ย ย ย ย selectedPlayerCard = selectedTargetCard = null;
ย ย ย ย }

ย ย ย ย function updateHpBars() {
ย ย ย ย ย ย [...iaCards, ...playerCards].forEach(c => {
ย ย ย ย ย ย ย ย const hpPercentage = (c.hp / c.maxHp) * 100;
ย ย ย ย ย ย ย ย c.element.querySelector('.hp-fill').style.width = `${hpPercentage}%`;
                // Si la vida es 0 o menos, la carta estรก fuera de combate
                if (hpPercentage <= 0) {
                    c.element.style.opacity = '0.3';
                    c.element.style.pointerEvents = 'none';
                    c.element.querySelector('.hp-text').textContent = `HP: 0/${Math.round(c.maxHp)}`;
                } else {
                    c.element.style.opacity = '1';
                    c.element.style.pointerEvents = 'auto';
                    c.element.querySelector('.hp-text').textContent = `HP: ${Math.round(Math.max(0, c.hp))}/${Math.round(c.maxHp)}`;
                }
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย function playerAttack() {
ย ย ย ย ย ย if (battleEnded) return;
ย ย ย ย ย ย if (!selectedPlayerCard || selectedPlayerCard.hp <= 0) { alert("ยกSelecciona una carta activa para atacar!"); return; }
ย ย ย ย ย ย if (!selectedTargetCard || selectedTargetCard.hp <= 0) { alert("ยกSelecciona un objetivo enemigo activo!"); return; }
            
            // Calculo de daรฑo corregido
ย ย ย ย ย ย const rawDamage = selectedPlayerCard.atk - selectedTargetCard.def * 0.3;
ย ย ย ย ย ย const damage = Math.round(Math.max(rawDamage, 1)); 

ย ย ย ย ย ย selectedTargetCard.hp -= damage;
ย ย ย ย ย ย 
ย ย ย ย ย ย animateAttack(selectedPlayerCard.element, selectedTargetCard.element);
ย ย ย ย ย ย updateHpBars();
ย ย ย ย ย ย checkBattleEnd();
ย ย ย ย ย ย if (!battleEnded) setTimeout(iaAttack, 1000);
ย ย ย ย }

ย ย ย ย function iaAttack() {
ย ย ย ย ย ย if (battleEnded) return;
ย ย ย ย ย ย const aliveIa = iaCards.filter(c => c.hp > 0);
ย ย ย ย ย ย const alivePlayer = playerCards.filter(c => c.hp > 0);
ย ย ย ย ย ย if (aliveIa.length === 0 || alivePlayer.length === 0) return;
ย ย ย ย ย ย 
ย ย ย ย ย ย const attacker = aliveIa[Math.floor(Math.random() * aliveIa.length)];
ย ย ย ย ย ย const target = alivePlayer[Math.floor(Math.random() * alivePlayer.length)];

            // Calculo de daรฑo corregido
ย ย ย ย ย ย const rawDamage = attacker.atk - target.def * 0.3;
ย ย ย ย ย ย const damage = Math.round(Math.max(rawDamage, 1)); 
            
ย ย ย ย ย ย target.hp -= damage;
ย ย ย ย ย ย 
ย ย ย ย ย ย animateAttack(attacker.element, target.element);
ย ย ย ย ย ย updateHpBars();
ย ย ย ย ย ย checkBattleEnd();
ย ย ย ย }

ย ย ย ย function playerDefend() {
ย ย ย ย ย ย if (battleEnded) return;
ย ย ย ย ย ย if (!selectedPlayerCard || selectedPlayerCard.hp <= 0) {
ย ย ย ย ย ย ย ย alert("ยกSelecciona una carta activa para defender!");
ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย }
            
            // Duplicamos la defensa usando baseDef (corregido)
ย ย ย ย ย ย selectedPlayerCard.def = selectedPlayerCard.baseDef * 2; 
ย ย ย ย ย ย animateDefend(selectedPlayerCard.element);
ย ย ย ย ย ย 
ย ย ย ย ย ย setTimeout(() => {
ย ย ย ย ย ย ย ย iaAttack();
ย ย ย ย ย ย ย ย selectedPlayerCard.def = selectedPlayerCard.baseDef; // Vuelve a la defensa normal despuรฉs del ataque IA
ย ย ย ย ย ย ย ย updateHpBars();
ย ย ย ย ย ย ย ย checkBattleEnd();
ย ย ย ย ย ย }, 1000);
ย ย ย ย }

ย ย ย ย function checkBattleEnd() {
ย ย ย ย ย ย if (iaCards.every(c => c.hp <= 0)) {
ย ย ย ย ย ย ย ย battleEnded = true;
ย ย ย ย ย ย ย ย showBattleMessage("ยกFELICIDADES! HAS GANADO ๐");
ย ย ย ย ย ย ย ย if (isTournament) {
ย ย ย ย ย ย ย ย ย ย const t = TOURNAMENTS.find(x => x.id === currentTournamentId);
ย ย ย ย ย ย ย ย ย ย t.cards.forEach(id => {
ย ย ย ย ย ย ย ย ย ย ย ย if (!gameState.ownedCardIds.includes(id)) {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย gameState.ownedCardIds.push(id);
ย ย ย ย ย ย ย ย ย ย ย ย ย ย showNewCard(ALL_CARDS.find(c => c.id === id));
ย ย ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย ย ย gameState.trophies += t.trophies;
ย ย ย ย ย ย ย ย ย ย gameState.diamonds += t.diamonds;
ย ย ย ย ย ย ย ย ย ย gameState.completedTournaments.push(t.id);
ย ย ย ย ย ย ย ย ย ย unlockAchievement(4);
ย ย ย ย ย ย ย ย } else if (isCupBattle) gameState.cups += 1;
ย ย ย ย ย ย ย ย unlockAchievement(1);
ย ย ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย ย ย updateUI();
ย ย ย ย ย ย ย ย renderDeck();
ย ย ย ย ย ย ย ย renderTournaments();
ย ย ย ย ย ย } else if (playerCards.every(c => c.hp <= 0)) {
ย ย ย ย ย ย ย ย battleEnded = true;
ย ย ย ย ย ย ย ย showBattleMessage("HAS PERDIDO...");
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function showBattleMessage(msg) {
ย ย ย ย ย ย document.getElementById('messageText').textContent = msg;
ย ย ย ย ย ย document.getElementById('battleMessage').style.display = 'block';
ย ย ย ย }

ย ย ย ย function closeBattleMessage() {
ย ย ย ย ย ย document.getElementById('battleMessage').style.display = 'none';
ย ย ย ย ย ย battleEnded = false;
ย ย ย ย ย ย isTournament = isCupBattle = false;
ย ย ย ย ย ย showView('battle');
ย ย ย ย }

ย ย ย ย function rematch() {
ย ย ย ย ย ย closeBattleMessage();
ย ย ย ย ย ย renderIaCards(); 
ย ย ย ย ย ย renderBattleCards(); 
ย ย ย ย ย ย resetBattle();
ย ย ย ย }

ย ย ย ย function showNewCard(card) {
ย ย ย ย ย ย showCardModal(card);
ย ย ย ย ย ย startFireworks();
ย ย ย ย }

ย ย ย ย function startFireworks() {
ย ย ย ย ย ย for (let i = 0; i < 10; i++) {
ย ย ย ย ย ย ย ย const fw = document.createElement('div');
ย ย ย ย ย ย ย ย fw.className = 'firework';
ย ย ย ย ย ย ย ย fw.style.left = Math.random() * 100 + '%';
ย ย ย ย ย ย ย ย fw.style.top = Math.random() * 100 + '%';
ย ย ย ย ย ย ย ย fw.style.background = `hsl(${Math.random()*360},100%,50%)`;
ย ย ย ย ย ย ย ย document.body.appendChild(fw);
ย ย ย ย ย ย ย ย setTimeout(() => fw.remove(), 1000);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function createSnowflakes() {
ย ย ย ย ย ย for (let i = 0; i < 30; i++) {
ย ย ย ย ย ย ย ย const s = document.createElement('div');
ย ย ย ย ย ย ย ย s.className = 'snowflake';
ย ย ย ย ย ย ย ย s.style.left = Math.random() * 100 + 'vw';
ย ย ย ย ย ย ย ย s.style.animationDelay = Math.random() * 10 + 's';
ย ย ย ย ย ย ย ย s.style.animationDuration = Math.random() * 10 + 10 + 's';
ย ย ย ย ย ย ย ย s.style.opacity = Math.random() * 0.5 + 0.5;
ย ย ย ย ย ย ย ย const size = Math.random() * 5 + 5;
ย ย ย ย ย ย ย ย s.style.width = s.style.height = size + 'px';
ย ย ย ย ย ย ย ย document.body.appendChild(s);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function animateAttack(att, tar) {
ย ย ย ย ย ย tar.classList.add('attacked');
ย ย ย ย ย ย setTimeout(() => tar.classList.remove('attacked'), 500);
ย ย ย ย ย ย for (let i = 0; i < 3; i++) {
ย ย ย ย ย ย ย ย const p = document.createElement('div');
ย ย ย ย ย ย ย ย p.className = 'attack-particle';
ย ย ย ย ย ย ย ย p.style.left = Math.random() * 100 + '%';
ย ย ย ย ย ย ย ย p.style.top = Math.random() * 100 + '%';
ย ย ย ย ย ย ย ย tar.appendChild(p);
ย ย ย ย ย ย ย ย setTimeout(() => p.remove(), 800);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function animateDefend(el) {
ย ย ย ย ย ย el.classList.add('defended');
ย ย ย ย ย ย setTimeout(() => el.classList.remove('defended'), 1000);
ย ย ย ย }

ย ย ย ย function unlockAchievement(id) {
ย ย ย ย ย ย if (!gameState.achievements.includes(id)) {
ย ย ย ย ย ย ย ย gameState.achievements.push(id);
ย ย ย ย ย ย ย ย saveGame();
ย ย ย ย ย ย ย ย alert(`ยกLogro desbloqueado: ${ACHIEVEMENTS.find(a => a.id === id).name}!`);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย function checkAchievements() {
ย ย ย ย ย ย if (gameState.ownedCardIds.length >= 5) unlockAchievement(2);
ย ย ย ย ย ย if (Object.values(gameState.cardUpgrades).some(l => l >= 5)) unlockAchievement(3);
ย ย ย ย ย ย if (gameState.spentDiamonds >= 500) unlockAchievement(5);
ย ย ย ย }

ย ย ย ย function renderAchievements() {
ย ย ย ย ย ย const container = document.getElementById('achievementsList');
ย ย ย ย ย ย container.innerHTML = '';
ย ย ย ย ย ย ACHIEVEMENTS.forEach(a => {
ย ย ย ย ย ย ย ย const unlocked = gameState.achievements.includes(a.id);
ย ย ย ย ย ย ย ย const item = document.createElement('div');
ย ย ย ย ย ย ย ย item.className = `achievement-item ${unlocked ? 'achievement-unlocked' : 'achievement-locked'}`;
ย ย ย ย ย ย ย ย item.innerHTML = `<div class="achievement-icon">${a.icon}</div><div class="achievement-info"><div class="achievement-name">${a.name}</div><div class="achievement-description">${a.description}</div></div>`;
ย ย ย ย ย ย ย ย container.appendChild(item);
ย ย ย ย ย ย });
ย ย ย ย }

ย ย ย ย updateUI();
ย ย ย ย showView('battle');
ย ย ย ย createSnowflakes();
ย ย ย ย checkAchievements();
ย ย </script>
</body>
</html>
